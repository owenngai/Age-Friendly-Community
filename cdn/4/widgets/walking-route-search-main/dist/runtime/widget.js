System.register(["jimu-core/react","jimu-arcgis","esri/Graphic"],(function(e,t){var o={},n={},r={};return{setters:[function(e){o.default=e.default,o.useEffect=e.useEffect,o.useState=e.useState},function(e){n.JimuMapViewComponent=e.JimuMapViewComponent},function(e){r.default=e.default}],execute:function(){e((()=>{var e={470:e=>{"use strict";e.exports=r},686:e=>{"use strict";e.exports=n},972:e=>{"use strict";e.exports=o}},t={};function l(o){var n=t[o];if(void 0!==n)return n.exports;var r=t[o]={exports:{}};return e[o](r,r.exports,l),r.exports}l.d=(e,t)=>{for(var o in t)l.o(t,o)&&!l.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},l.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),l.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.p="";var u={};return l.p=window.jimuConfig.baseUrl,(()=>{"use strict";l.r(u),l.d(u,{__set_webpack_public_path__:()=>i,default:()=>r});var e=l(972),t=l(686),o=l(470),n=function(e,t,o,n){return new(o||(o=Promise))((function(r,l){function u(e){try{s(n.next(e))}catch(e){l(e)}}function i(e){try{s(n.throw(e))}catch(e){l(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(u,i)}s((n=n.apply(e,t||[])).next())}))};function r(r){var l;const[u,i]=(0,e.useState)(null),[s,a]=(0,e.useState)(null),[c,d]=(0,e.useState)(null),[f,p]=(0,e.useState)(null),g=e.default.useRef(0),v="AAPTxy8BH1VEsoebNVZXo8HurEE5qod6fdFwn9Z7joZ1eU80Mpc1ZKKX4XFEXSZaqSdDcuX8887vxtDuaaH8KlFJ9A_NozBe01ZqM_KHeQyl6Ol7LaPaHAx5_g-NxaYoLvfo8FDiX3D2UQ_VGPMBYYlxd-NJu71ajh9hhTV9iedP2hyvYZb5oq1PdFEYJwfzN_zWXj_-XawgqAf-eWPEt_8dnR1WNKoQMfp8M06F1MGLX4s.AT1_Fa9PuOBU";(0,e.useEffect)((()=>{u&&!f&&(console.log("set up graphics layer..."),console.log(u),p(u.view.graphics))}),[u,f]),(0,e.useEffect)((()=>{f&&u.view.on("click",m)}),[f]);const m=e=>{const{mapPoint:t}=e;!function(e){if(0===g.current){a(null),d(null),console.log("Start point selected:",e);const t=new o.default({geometry:{type:"point",longitude:e.longitude,latitude:e.latitude},symbol:{type:"simple-marker",color:[226,119,40],size:"30px"}});console.log(f),null==f||f.add(t),a(e),g.current=1}else if(1===g.current){console.log("End point selected:",e);const t=new o.default({geometry:{type:"point",longitude:e.longitude,latitude:e.latitude},symbol:{type:"simple-marker",color:[226,119,40],size:"30px"}});null==f||f.add(t),d(e),g.current=0}}(t)};(0,e.useEffect)((()=>{s&&c&&(console.log("Routing from",s,"to",c),y(s,c))}),[s,c]);const y=(e,t)=>n(this,void 0,void 0,(function*(){(function(e,t){return n(this,void 0,void 0,(function*(){console.log("Fetching route from Esri API...");const o=yield function(){return n(this,void 0,void 0,(function*(){console.log("call Retrieve Travel Modes...");const e="https://route.arcgis.com/arcgis/rest/services/World/Route/NAServer/Route_World/retrieveTravelModes",t=new URLSearchParams({f:"json",token:v});try{const o=yield fetch(`${e}?${t}`),n=yield o.json();if(n)return n;console.error("No route found:",n.messages)}catch(e){console.error("Error travel modes:",e)}}))}(),{supportedTravelModes:r}=o,l=r.find((({name:e})=>"Walking Distance"===e));console.log(o.supportedTravelModes),console.log(l),console.log(e,t);const u="https://route-api.arcgis.com/arcgis/rest/services/World/Route/NAServer/Route_World/solve",i=new URLSearchParams({f:"json",token:v,stops:`${e.longitude},${e.latitude};${t.longitude},${t.latitude}`,returnDirections:"true",travelMode:l});try{const e=yield fetch(`${u}?${i}`),t=yield e.json();if(t.routes)return t;console.error("No route found:",t.messages)}catch(e){console.error("Error fetching route:",e)}}))})(e,t).then((e=>{e&&(console.log("Route geometry:",e),function(e,t){if(e&&e.routes.features[0].geometry.paths.length>0){console.log("looping through route features",e.routes.features[0].geometry.paths),console.log("route",JSON.stringify(e.routes.features[0].geometry.paths[0]));const t=new o.default({geometry:{type:"polyline",paths:e.routes.features[0].geometry.paths[0]},symbol:{type:"simple-line",color:[255,255,0,1],width:3}});f.add(t)}else console.error("No route features available to display.")}(e,u.view))}))}));return e.default.createElement("div",{className:"walking-route-widget"},e.default.createElement("h5",null,"Walking Route Finder"),e.default.createElement("p",null,"Click on the map to select a start and end point.",e.default.createElement("br",null),"start point: ",null==s?void 0:s.longitude.toFixed(5),", ",null==s?void 0:s.latitude.toFixed(5)," end point: ",null==c?void 0:c.longitude.toFixed(5),", ",null==c?void 0:c.latitude.toFixed(5)),e.default.createElement("button",{onClick:()=>{var e,t;a(null),d(null),null===(t=null===(e=null==u?void 0:u.view)||void 0===e?void 0:e.graphics)||void 0===t||t.removeAll(),g.current=0}},"Reset Points"),e.default.createElement(t.JimuMapViewComponent,{useMapWidgetId:null===(l=r.useMapWidgetIds)||void 0===l?void 0:l[0],onActiveViewChange:e=>{i(e)}}))}function i(e){l.p=e}})(),u})())}}}));