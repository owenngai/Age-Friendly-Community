System.register(["jimu-core/react","jimu-arcgis","esri/Graphic","esri/geometry"],(function(e,t){var o={},r={},n={},a={};return{setters:[function(e){o.default=e.default,o.useEffect=e.useEffect,o.useRef=e.useRef,o.useState=e.useState},function(e){r.JimuMapViewComponent=e.JimuMapViewComponent},function(e){n.default=e.default},function(e){a.Polygon=e.Polygon}],execute:function(){e((()=>{var e={2089:e=>{"use strict";e.exports=n},6435:e=>{"use strict";e.exports=a},2686:e=>{"use strict";e.exports=r},8972:e=>{"use strict";e.exports=o}},t={};function i(o){var r=t[o];if(void 0!==r)return r.exports;var n=t[o]={exports:{}};return e[o](n,n.exports,i),n.exports}i.d=(e,t)=>{for(var o in t)i.o(t,o)&&!i.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.p="";var l={};return i.p=window.jimuConfig.baseUrl,(()=>{"use strict";i.r(l),i.d(l,{__set_webpack_public_path__:()=>s,default:()=>a});var e=i(8972),t=i(2686),o=i(2089),r=i(6435),n=function(e,t,o,r){return new(o||(o=Promise))((function(n,a){function i(e){try{s(r.next(e))}catch(e){a(e)}}function l(e){try{s(r.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,l)}s((r=r.apply(e,t||[])).next())}))};function a(a){var i;const[l,s]=(0,e.useState)(null),[u,c]=(0,e.useState)(null),[d,f]=(0,e.useState)(null),p=(0,e.useRef)("0.5,1,2"),v=(0,e.useRef)(0),g="AAPTxy8BH1VEsoebNVZXo8HurEE5qod6fdFwn9Z7joZ1eU80Mpc1ZKKX4XFEXSZaqSdDcuX8887vxtDuaaH8KlFJ9A_NozBe01ZqM_KHeQyl6Ol7LaPaHAx5_g-NxaYoLvfo8FDiX3D2UQ_VGPMBYYlxd-NJu71ajh9hhTV9iedP2hyvYZb5oq1PdFEYJwfzN_zWXj_-XawgqAf-eWPEt_8dnR1WNKoQMfp8M06F1MGLX4s.AT1_Fa9PuOBU";(0,e.useEffect)((()=>{l&&(console.log("Map view is available"),l.view.on("click",m))}),[d]),(0,e.useEffect)((()=>{l&&!d&&(console.log("set up graphics layer..."),f(l.view.graphics))}),[l,d]);const m=e=>{const{mapPoint:t}=e;console.log("facility location selected:",t);const r=new o.default({geometry:{type:"point",longitude:t.longitude,latitude:t.latitude},symbol:{type:"simple-marker",color:[0,255,255,1],size:"5px"}});c(t),d.add(r),y(t),v.current=1},y=e=>n(this,void 0,void 0,(function*(){(function(e){return n(this,void 0,void 0,(function*(){console.log("Fetching route from Esri API..."),console.log("DefaultBreak=",p.current);const t=yield function(){return n(this,void 0,void 0,(function*(){console.log("call Retrieve Travel Modes...");const e="https://route.arcgis.com/arcgis/rest/services/World/Route/NAServer/Route_World/retrieveTravelModes",t=new URLSearchParams({f:"json",token:g});try{const o=yield fetch(`${e}?${t}`),r=yield o.json();if(r)return r;console.error("travel mode not found:",r.messages)}catch(e){console.error("Error travel modes:",e)}}))}(),{supportedTravelModes:o}=t;console.log(o);const r=o.find((({name:e})=>"Walking Time"===e)),a="https://route.arcgis.com/arcgis/rest/services/World/ServiceAreas/NAServer/ServiceArea_World/solveServiceArea",i=new URLSearchParams({f:"json",token:g,facilities:`${e.longitude},${e.latitude}`,defaultBreaks:p.current,travelMode:r});try{const e=yield fetch(`${a}?${i}`),t=yield e.json();if(t)return t;console.error("Service area not found:",null==t?void 0:t.messages)}catch(e){console.error("Error fetching service Area:",e)}}))})(e).then((e=>{var t;e&&(t=e,l.view,t?(console.log("Service Area Geometry:",t),console.log("Clear the graphic layer..."),d.removeAll(),t.saPolygons.features.map(((e,t)=>{console.log("s",e);const n=new r.Polygon({rings:e.geometry.rings[0],spatialReference:{wkid:4326}}),a=new o.default({geometry:n,symbol:{type:"simple-fill",color:[255,255,180/(t+1),.2*t],outline:{color:[255,255,255],width:1}}}),i=l.view,s=i.map.findLayerById("190f3ea6612-layer-91");let u;s.visible=!0;const c=s.createQuery();c.geometry=n,c.spatialRelationship="intersects",c.returnGeometry=!1,i.whenLayerView(s).then((function(e){s.queryFeatures(c).then((t=>{u&&u.remove(),u=e.highlight(t.features)}))})),d.add(a)}))):console.error("No polygon features available to display."))}))}));return e.default.createElement("div",{className:"serviceArea"},e.default.createElement("h5",null,"Find Walk Time Area"),e.default.createElement("p",null,"Click on the map to select a point.",e.default.createElement("br",null),"location ",null==u?void 0:u.longitude.toFixed(5),","," ",null==u?void 0:u.latitude.toFixed(5)),e.default.createElement("input",{id:"myDefaultBreak",name:"myDefaultBreak",type:"text",defaultValue:p.current,onChange:e=>{p.current=e.target.value}}),e.default.createElement(t.JimuMapViewComponent,{useMapWidgetId:null===(i=a.useMapWidgetIds)||void 0===i?void 0:i[0],onActiveViewChange:e=>{s(e)}}))}function s(e){i.p=e}})(),l})())}}}));