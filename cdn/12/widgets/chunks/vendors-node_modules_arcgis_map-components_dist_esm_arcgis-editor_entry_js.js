"use strict";
(self["webpackChunkexb_client"] = self["webpackChunkexb_client"] || []).push([["vendors-node_modules_arcgis_map-components_dist_esm_arcgis-editor_entry_js"],{

/***/ "./node_modules/@arcgis/map-components/dist/esm/arcgis-editor.entry.js":
/*!*****************************************************************************!*\
  !*** ./node_modules/@arcgis/map-components/dist/esm/arcgis-editor.entry.js ***!
  \*****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   arcgis_editor: () => (/* binding */ ArcgisEditor)
/* harmony export */ });
/* harmony import */ var _index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-6e172aac.js */ "./node_modules/@arcgis/map-components/dist/esm/index-6e172aac.js");
/* harmony import */ var _index_0bc55ca5_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./index-0bc55ca5.js */ "./node_modules/@arcgis/map-components/dist/esm/index-0bc55ca5.js");
/* harmony import */ var _component_utils_23194f7c_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./component-utils-23194f7c.js */ "./node_modules/@arcgis/map-components/dist/esm/component-utils-23194f7c.js");
/* harmony import */ var _disconnected_6cf1c100_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./disconnected-6cf1c100.js */ "./node_modules/@arcgis/map-components/dist/esm/disconnected-6cf1c100.js");
/*!
 * All material copyright Esri, All Rights Reserved, unless otherwise specified.
 * See https://js.arcgis.com/4.30/esri/copyright.txt for details.
 * v4.30.0-next.37
 */





const editorCss = "";

const ArcgisEditor = class {
    constructor(hostRef) {
        (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);
        this.arcgisEditorReady = (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "arcgisEditorReady", 7);
        this.arcgisPropertyChange = (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "arcgisPropertyChange", 7);
        this._watchHandles = [];
        this.referenceElement = undefined;
        this.activeWorkflow = undefined;
        this.allowedWorkflows = undefined;
        this.icon = undefined;
        this.labelOptions = undefined;
        this.layerInfos = undefined;
        this.snappingOptions = undefined;
        this.supportingWidgetDefaults = undefined;
        this.tooltipOptions = undefined;
        this.visibleElementsCreateFeaturesSection = true;
        this.visibleElementsEditFeaturesSection = true;
        this.visibleElementsLabelsToggle = true;
        this.visibleElementsTooltipsToggle = true;
        this.visibleElementsSnappingControls = true;
        this.visibleElementsSnappingControlsHeader = true;
        this.visibleElementsSnappingControlsEnabledToggle = true;
        this.visibleElementsSnappingControlsSelfEnabledToggle = true;
        this.visibleElementsSnappingControlsFeatureEnabledToggle = true;
        this.visibleElementsSnappingControlsLayerList = true;
        this.position = "bottom-left";
        this.view = undefined;
        this.widget = undefined;
    }
    referenceElementWatcher(value) {
        void (0,_component_utils_23194f7c_js__WEBPACK_IMPORTED_MODULE_2__.r)(this, value);
    }
    allowedWorkflowsWatcher(value) {
        if (this.widget) {
            this.widget.allowedWorkflows = value;
        }
    }
    iconWatcher(value) {
        if (this.widget) {
            this.widget.icon = value;
        }
    }
    labelOptionsWatcher(value) {
        if (this.widget) {
            this.widget.labelOptions = value;
        }
    }
    layerInfosWatcher(value) {
        if (this.widget) {
            this.widget.layerInfos = value;
        }
    }
    snappingOptionsWatcher(value) {
        if (this.widget) {
            this.widget.snappingOptions = value;
        }
    }
    supportingWidgetDefaultsWatcher(value) {
        if (this.widget) {
            this.widget.supportingWidgetDefaults = value;
        }
    }
    tooltipOptionsWatcher(value) {
        if (this.widget) {
            this.widget.tooltipOptions = value;
        }
    }
    visibleElementsCreateFeaturesSectionWatcher(value) {
        if (this.widget) {
            this.widget.visibleElements = {
                ...this.widget.visibleElements,
                createFeaturesSection: value,
            };
        }
    }
    visibleElementsEditFeaturesSectionWatcher(value) {
        if (this.widget) {
            this.widget.visibleElements = {
                ...this.widget.visibleElements,
                editFeaturesSection: value,
            };
        }
    }
    visibleElementsLabelsToggleWatcher(value) {
        if (this.widget) {
            this.widget.visibleElements = {
                ...this.widget.visibleElements,
                labelsToggle: value,
            };
        }
    }
    visibleElementsTooltipsToggleWatcher(value) {
        if (this.widget) {
            this.widget.visibleElements = {
                ...this.widget.visibleElements,
                tooltipsToggle: value,
            };
        }
    }
    visibleElementsSnappingControlsWatcher(value) {
        if (this.widget) {
            this.widget.visibleElements = {
                ...this.widget.visibleElements,
                snappingControls: value,
            };
        }
    }
    visibleElementsSnappingControlsHeaderWatcher(value) {
        if (this.widget) {
            this.widget.visibleElements = {
                ...this.widget.visibleElements,
                snappingControlsElements: {
                    ...this.widget.visibleElements.snappingControlsElements,
                    header: value,
                },
            };
        }
    }
    visibleElementsSnappingControlsEnabledToggleWatcher(value) {
        if (this.widget) {
            this.widget.visibleElements = {
                ...this.widget.visibleElements,
                snappingControlsElements: {
                    ...this.widget.visibleElements.snappingControlsElements,
                    enabledToggle: value,
                },
            };
        }
    }
    visibleElementsSnappingControlsSelfEnabledToggleWatcher(value) {
        if (this.widget) {
            this.widget.visibleElements = {
                ...this.widget.visibleElements,
                snappingControlsElements: {
                    ...this.widget.visibleElements.snappingControlsElements,
                    selfEnabledToggle: value,
                },
            };
        }
    }
    visibleElementsSnappingControlsFeatureEnabledToggleWatcher(value) {
        if (this.widget) {
            this.widget.visibleElements = {
                ...this.widget.visibleElements,
                snappingControlsElements: {
                    ...this.widget.visibleElements.snappingControlsElements,
                    featureEnabledToggle: value,
                },
            };
        }
    }
    visibleElementsSnappingControlsLayerListWatcher(value) {
        if (this.widget) {
            this.widget.visibleElements = {
                ...this.widget.visibleElements,
                snappingControlsElements: {
                    ...this.widget.visibleElements.snappingControlsElements,
                    layerList: value,
                },
            };
        }
    }
    positionWatcher(value) {
        if (value !== undefined && this.widget) {
            this.view.ui.move(this.childElem, value);
        }
    }
    viewWatcher(value) {
        if (value !== undefined && this.widget) {
            this.widget.view = value;
        }
    }
    //--------------------------------------------------------------------------
    //
    //  Methods
    //
    //--------------------------------------------------------------------------
    async cancelWorkflow() {
        await this.widget?.cancelWorkflow();
    }
    async deleteFeatureFromWorkflow() {
        await this.widget?.deleteFeatureFromWorkflow();
    }
    async startCreateFeaturesWorkflowAtFeatureCreation(info) {
        await this.widget?.startCreateFeaturesWorkflowAtFeatureCreation(info);
    }
    async startCreateFeaturesWorkflowAtFeatureTypeSelection() {
        await this.widget?.startCreateFeaturesWorkflowAtFeatureTypeSelection();
    }
    async startUpdateWorkflowAtFeatureEdit(feature) {
        await this.widget?.startUpdateWorkflowAtFeatureEdit(feature);
    }
    async startUpdateWorkflowAtFeatureSelection() {
        await this.widget?.startUpdateWorkflowAtFeatureSelection();
    }
    async startUpdateWorkflowAtMultipleFeatureSelection(candidates) {
        await this.widget?.startUpdateWorkflowAtMultipleFeatureSelection(candidates);
    }
    //--------------------------------------------------------------------------
    //
    //  Lifecycle
    //
    //--------------------------------------------------------------------------
    async componentDidLoad() {
        const params = this._createParams();
        const widget = await (0,_index_0bc55ca5_js__WEBPACK_IMPORTED_MODULE_1__.v)(params);
        this.widget = widget;
        await this._addWatchers();
        this._addContainer();
        this.arcgisEditorReady.emit();
        (0,_component_utils_23194f7c_js__WEBPACK_IMPORTED_MODULE_2__.c)(this);
    }
    disconnectedCallback() {
        (0,_disconnected_6cf1c100_js__WEBPACK_IMPORTED_MODULE_3__.o)(this);
    }
    render() {
        return (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { ref: (el) => (this.childElem = el) });
    }
    //--------------------------------------------------------------------------
    //
    //  Private Methods
    //
    //--------------------------------------------------------------------------
    _addContainer() {
        this.widget.container = this.childElem;
    }
    async _addWatchers() {
        const { watch } = await (0,_index_0bc55ca5_js__WEBPACK_IMPORTED_MODULE_1__.i)();
        (0,_component_utils_23194f7c_js__WEBPACK_IMPORTED_MODULE_2__.a)(this, watch(() => this.widget.activeWorkflow, (value) => {
            this.activeWorkflow = value;
            this.arcgisPropertyChange.emit({ name: "activeWorkflow" });
        }, {
            initial: true,
        }));
    }
    _createParams() {
        const params = {};
        params.visibleElements = {
            createFeaturesSection: this.visibleElementsCreateFeaturesSection,
            editFeaturesSection: this.visibleElementsEditFeaturesSection,
            labelsToggle: this.visibleElementsLabelsToggle,
            tooltipsToggle: this.visibleElementsTooltipsToggle,
            snappingControls: this.visibleElementsSnappingControls,
            snappingControlsElements: {
                header: this.visibleElementsSnappingControlsHeader,
                enabledToggle: this.visibleElementsSnappingControlsEnabledToggle,
                selfEnabledToggle: this.visibleElementsSnappingControlsSelfEnabledToggle,
                featureEnabledToggle: this.visibleElementsSnappingControlsFeatureEnabledToggle,
                layerList: this.visibleElementsSnappingControlsLayerList,
            },
        };
        if (this.allowedWorkflows) {
            params.allowedWorkflows = this.allowedWorkflows;
        }
        if (this.icon) {
            params.icon = this.icon;
        }
        if (this.labelOptions) {
            params.labelOptions = this.labelOptions;
        }
        if (this.layerInfos) {
            params.layerInfos = this.layerInfos;
        }
        if (this.snappingOptions) {
            params.snappingOptions = this.snappingOptions;
        }
        if (this.supportingWidgetDefaults) {
            params.supportingWidgetDefaults = this.supportingWidgetDefaults;
        }
        if (this.tooltipOptions) {
            params.tooltipOptions = this.tooltipOptions;
        }
        if (this.view) {
            params.view = this.view;
        }
        return params;
    }
    get el() { return (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.g)(this); }
    static get watchers() { return {
        "referenceElement": ["referenceElementWatcher"],
        "allowedWorkflows": ["allowedWorkflowsWatcher"],
        "icon": ["iconWatcher"],
        "labelOptions": ["labelOptionsWatcher"],
        "layerInfos": ["layerInfosWatcher"],
        "snappingOptions": ["snappingOptionsWatcher"],
        "supportingWidgetDefaults": ["supportingWidgetDefaultsWatcher"],
        "tooltipOptions": ["tooltipOptionsWatcher"],
        "visibleElementsCreateFeaturesSection": ["visibleElementsCreateFeaturesSectionWatcher"],
        "visibleElementsEditFeaturesSection": ["visibleElementsEditFeaturesSectionWatcher"],
        "visibleElementsLabelsToggle": ["visibleElementsLabelsToggleWatcher"],
        "visibleElementsTooltipsToggle": ["visibleElementsTooltipsToggleWatcher"],
        "visibleElementsSnappingControls": ["visibleElementsSnappingControlsWatcher"],
        "visibleElementsSnappingControlsHeader": ["visibleElementsSnappingControlsHeaderWatcher"],
        "visibleElementsSnappingControlsEnabledToggle": ["visibleElementsSnappingControlsEnabledToggleWatcher"],
        "visibleElementsSnappingControlsSelfEnabledToggle": ["visibleElementsSnappingControlsSelfEnabledToggleWatcher"],
        "visibleElementsSnappingControlsFeatureEnabledToggle": ["visibleElementsSnappingControlsFeatureEnabledToggleWatcher"],
        "visibleElementsSnappingControlsLayerList": ["visibleElementsSnappingControlsLayerListWatcher"],
        "position": ["positionWatcher"],
        "view": ["viewWatcher"]
    }; }
};
ArcgisEditor.style = editorCss;




/***/ }),

/***/ "./node_modules/@arcgis/map-components/dist/esm/component-utils-23194f7c.js":
/*!**********************************************************************************!*\
  !*** ./node_modules/@arcgis/map-components/dist/esm/component-utils-23194f7c.js ***!
  \**********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   a: () => (/* binding */ addHandles),
/* harmony export */   b: () => (/* binding */ isNotSameViewpoint),
/* harmony export */   c: () => (/* binding */ checkForView),
/* harmony export */   d: () => (/* binding */ checkForExpand),
/* harmony export */   e: () => (/* binding */ isNotSameCamera),
/* harmony export */   f: () => (/* binding */ isNotSameEnvironment),
/* harmony export */   g: () => (/* binding */ isValidInteger),
/* harmony export */   i: () => (/* binding */ isNullOrEmptyString),
/* harmony export */   r: () => (/* binding */ referenceElementHelper)
/* harmony export */ });
/*!
 * All material copyright Esri, All Rights Reserved, unless otherwise specified.
 * See https://js.arcgis.com/4.30/esri/copyright.txt for details.
 * v4.30.0-next.37
 */
function checkForExpand(element) {
    const expandRef = element.el.closest("arcgis-expand") ?? element.expandElem;
    if (expandRef?.widget) {
        element.view = expandRef.view;
        expandRef.widget.content = element.childElem ?? element.el;
        // TODO: Update to be expandIcon = widget.icon, not ready yet in 4.27next
        if (!expandRef.expandIcon) {
            expandRef.widget.expandIcon = element.widget ? element.widget.icon : element?.icon;
        }
        return true;
    }
    if (expandRef) {
        const widgetHandler = () => {
            expandRef.removeEventListener("arcgisExpandReady", widgetHandler, false);
            element.view = expandRef.view;
            expandRef.widget.content = element.childElem ?? element.el;
            if (!expandRef.expandIcon) {
                expandRef.widget.expandIcon = element.widget ? element.widget.icon : element?.icon;
            }
        };
        expandRef.addEventListener("arcgisExpandReady", widgetHandler, false);
        return true;
    }
    return false;
}

//--------------------------------------------------------------------------
//
//  Public Methods
//
//--------------------------------------------------------------------------
function addHandles(element, handle) {
    if (Array.isArray(handle)) {
        element._watchHandles = [...element._watchHandles, ...handle];
    }
    else {
        element._watchHandles.push(handle);
    }
}
function checkForView(element) {
    let isUsingReferenceElement = false;
    if (!checkForExpand(element)) {
        let viewRef = element.el.closest("arcgis-map") ?? element.el.closest("arcgis-scene");
        if (!viewRef && typeof element.referenceElement === "string") {
            viewRef = document.querySelector(element.referenceElement);
            isUsingReferenceElement = true;
        }
        if (viewRef?.view) {
            element.view = viewRef.view;
            const el = element.childElem ?? element.el;
            if (!isUsingReferenceElement) {
                element.view.ui.add(el, element.position);
            }
        }
        else if (viewRef) {
            waitForViewHandler(viewRef, element, isUsingReferenceElement);
        }
    }
    else {
        const viewRef = element.el.closest("arcgis-map") ?? element.el.closest("arcgis-scene");
        if (viewRef?.view) {
            element.view = viewRef.view;
        }
        else if (viewRef) {
            const handler = () => {
                viewRef.removeEventListener("arcgisViewReadyChange", handler, false);
                element.view = viewRef.view;
            };
            viewRef.addEventListener("arcgisViewReadyChange", handler, false);
        }
    }
}
function isNullOrEmptyString(value) {
    return value === undefined || value === null || value === "";
}
function isValidInteger(value) {
    return value != null && value % 1 === 0;
}
function isNotSameCamera(camera, camera2) {
    return (camera2 === undefined ||
        camera.position !== camera2.position ||
        camera.heading !== camera2.heading ||
        camera.tilt !== camera2.tilt);
}
function isNotSameEnvironment(environment, environment2) {
    return (environment2 === undefined ||
        environment2.atmosphereEnabled !== environment.atmosphereEnabled ||
        environment2.lighting.date !== environment.lighting.date ||
        environment2.lighting.directShadowsEnabled !==
            environment.lighting.directShadowsEnabled ||
        environment2.lighting.cameraTrackingEnabled !==
            environment.lighting.cameraTrackingEnabled ||
        environment2.lighting.date !== environment.lighting.date ||
        environment2.lighting.displayUTCOffset !==
            environment.lighting.displayUTCOffset);
}
function isNotSameViewpoint(viewpoint, viewpoint2) {
    return (viewpoint2 === undefined ||
        viewpoint.targetGeometry !== viewpoint2.targetGeometry ||
        viewpoint.rotation !== viewpoint2.rotation ||
        viewpoint.scale !== viewpoint2.scale);
}
async function updateForView(viewStr) {
    const viewRef = document.querySelector(viewStr);
    return await new Promise((resolve) => {
        if (viewRef?.view !== undefined) {
            resolve(viewRef.view);
        }
        else if (viewRef) {
            const handler = () => {
                viewRef.removeEventListener("arcgisViewReadyChange", handler, false);
                resolve(viewRef.view);
            };
            viewRef.addEventListener("arcgisViewReadyChange", handler, false);
        }
    });
}
async function referenceElementHelper(element, refElement) {
    if (refElement === undefined)
        return;
    else if (typeof refElement === "string") {
        element.view = await updateForView(refElement);
    }
    else if (element.widget) {
        element.view = refElement.view;
    }
}
//--------------------------------------------------------------------------
//
//  Private Methods
//
//--------------------------------------------------------------------------
function waitForViewHandler(viewRef, element, isUsingRefernceElement) {
    const handler = () => {
        viewRef.removeEventListener("arcgisViewReadyChange", handler, false);
        element.view = viewRef.view;
        if (!isUsingRefernceElement) {
            element.view.ui.add(element.childElem ?? element.el, element.position);
        }
    };
    viewRef.addEventListener("arcgisViewReadyChange", handler, false);
}




/***/ }),

/***/ "./node_modules/@arcgis/map-components/dist/esm/disconnected-6cf1c100.js":
/*!*******************************************************************************!*\
  !*** ./node_modules/@arcgis/map-components/dist/esm/disconnected-6cf1c100.js ***!
  \*******************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   o: () => (/* binding */ onDisconnectedHelper)
/* harmony export */ });
/*!
 * All material copyright Esri, All Rights Reserved, unless otherwise specified.
 * See https://js.arcgis.com/4.30/esri/copyright.txt for details.
 * v4.30.0-next.37
 */
function onDisconnectedHelper(element) {
    if (element.childElem) {
        if (!element.el.isConnected) {
            if (element.view) {
                element.view.ui.remove(element.childElem);
            }
            else if (element.widget?.view) {
                element.widget.view.ui.remove(element.childElem);
            }
            if (element._watchHandles) {
                element._watchHandles.forEach((handle) => {
                    handle.remove();
                });
            }
            element._watchHandles = [];
            element.widget?.destroy();
        }
    }
    else {
        setTimeout(() => {
            if (!element.el.isConnected) {
                if (element.view) {
                    element.view.ui.remove(element.el);
                }
                else if (element.widget?.view) {
                    element.widget.view.ui.remove(element.el);
                }
                if (element._watchHandles) {
                    element._watchHandles.forEach((handle) => {
                        handle.remove();
                    });
                }
                element._watchHandles = [];
                element.widget?.destroy();
            }
        }, 1000);
    }
}




/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2lkZ2V0cy9jaHVua3MvdmVuZG9ycy1ub2RlX21vZHVsZXNfYXJjZ2lzX21hcC1jb21wb25lbnRzX2Rpc3RfZXNtX2FyY2dpcy1lZGl0b3JfZW50cnlfanMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ2tHO0FBQ1I7QUFDc0I7QUFDekM7O0FBRXZFOztBQUVBO0FBQ0E7QUFDQSxRQUFRLHFEQUFnQjtBQUN4QixpQ0FBaUMscURBQVc7QUFDNUMsb0NBQW9DLHFEQUFXO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSwrREFBc0I7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QixxREFBZ0I7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLCtEQUFZO0FBQ3BCO0FBQ0E7QUFDQSxRQUFRLDREQUFvQjtBQUM1QjtBQUNBO0FBQ0EsZUFBZSxxREFBQyxVQUFVLG9DQUFvQztBQUM5RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixRQUFRLFFBQVEscURBQXVCO0FBQ3ZELFFBQVEsK0RBQVU7QUFDbEI7QUFDQSw2Q0FBNkMsd0JBQXdCO0FBQ3JFLFNBQVM7QUFDVDtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxPQUFPLHFEQUFVO0FBQ2hDLDRCQUE0QjtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUV5Qzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUMzVHpDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRXlOOzs7Ozs7Ozs7Ozs7Ozs7QUNwSnpOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBOztBQUVxQyIsInNvdXJjZXMiOlsid2VicGFjazovL2V4Yi1jbGllbnQvLi9ub2RlX21vZHVsZXMvQGFyY2dpcy9tYXAtY29tcG9uZW50cy9kaXN0L2VzbS9hcmNnaXMtZWRpdG9yLmVudHJ5LmpzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9ub2RlX21vZHVsZXMvQGFyY2dpcy9tYXAtY29tcG9uZW50cy9kaXN0L2VzbS9jb21wb25lbnQtdXRpbHMtMjMxOTRmN2MuanMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL25vZGVfbW9kdWxlcy9AYXJjZ2lzL21hcC1jb21wb25lbnRzL2Rpc3QvZXNtL2Rpc2Nvbm5lY3RlZC02Y2YxYzEwMC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiFcbiAqIEFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRXNyaSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG4gKiBTZWUgaHR0cHM6Ly9qcy5hcmNnaXMuY29tLzQuMzAvZXNyaS9jb3B5cmlnaHQudHh0IGZvciBkZXRhaWxzLlxuICogdjQuMzAuMC1uZXh0LjM3XG4gKi9cbmltcG9ydCB7IHIgYXMgcmVnaXN0ZXJJbnN0YW5jZSwgYyBhcyBjcmVhdGVFdmVudCwgaCwgZyBhcyBnZXRFbGVtZW50IH0gZnJvbSAnLi9pbmRleC02ZTE3MmFhYy5qcyc7XG5pbXBvcnQgeyB2IGFzIG5ld1dpZGdldHNFZGl0b3IsIGkgYXMgaW1wb3J0Q29yZVJlYWN0aXZlVXRpbHMgfSBmcm9tICcuL2luZGV4LTBiYzU1Y2E1LmpzJztcbmltcG9ydCB7IHIgYXMgcmVmZXJlbmNlRWxlbWVudEhlbHBlciwgYyBhcyBjaGVja0ZvclZpZXcsIGEgYXMgYWRkSGFuZGxlcyB9IGZyb20gJy4vY29tcG9uZW50LXV0aWxzLTIzMTk0ZjdjLmpzJztcbmltcG9ydCB7IG8gYXMgb25EaXNjb25uZWN0ZWRIZWxwZXIgfSBmcm9tICcuL2Rpc2Nvbm5lY3RlZC02Y2YxYzEwMC5qcyc7XG5cbmNvbnN0IGVkaXRvckNzcyA9IFwiXCI7XG5cbmNvbnN0IEFyY2dpc0VkaXRvciA9IGNsYXNzIHtcbiAgICBjb25zdHJ1Y3Rvcihob3N0UmVmKSB7XG4gICAgICAgIHJlZ2lzdGVySW5zdGFuY2UodGhpcywgaG9zdFJlZik7XG4gICAgICAgIHRoaXMuYXJjZ2lzRWRpdG9yUmVhZHkgPSBjcmVhdGVFdmVudCh0aGlzLCBcImFyY2dpc0VkaXRvclJlYWR5XCIsIDcpO1xuICAgICAgICB0aGlzLmFyY2dpc1Byb3BlcnR5Q2hhbmdlID0gY3JlYXRlRXZlbnQodGhpcywgXCJhcmNnaXNQcm9wZXJ0eUNoYW5nZVwiLCA3KTtcbiAgICAgICAgdGhpcy5fd2F0Y2hIYW5kbGVzID0gW107XG4gICAgICAgIHRoaXMucmVmZXJlbmNlRWxlbWVudCA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5hY3RpdmVXb3JrZmxvdyA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5hbGxvd2VkV29ya2Zsb3dzID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLmljb24gPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMubGFiZWxPcHRpb25zID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLmxheWVySW5mb3MgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuc25hcHBpbmdPcHRpb25zID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLnN1cHBvcnRpbmdXaWRnZXREZWZhdWx0cyA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy50b29sdGlwT3B0aW9ucyA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy52aXNpYmxlRWxlbWVudHNDcmVhdGVGZWF0dXJlc1NlY3Rpb24gPSB0cnVlO1xuICAgICAgICB0aGlzLnZpc2libGVFbGVtZW50c0VkaXRGZWF0dXJlc1NlY3Rpb24gPSB0cnVlO1xuICAgICAgICB0aGlzLnZpc2libGVFbGVtZW50c0xhYmVsc1RvZ2dsZSA9IHRydWU7XG4gICAgICAgIHRoaXMudmlzaWJsZUVsZW1lbnRzVG9vbHRpcHNUb2dnbGUgPSB0cnVlO1xuICAgICAgICB0aGlzLnZpc2libGVFbGVtZW50c1NuYXBwaW5nQ29udHJvbHMgPSB0cnVlO1xuICAgICAgICB0aGlzLnZpc2libGVFbGVtZW50c1NuYXBwaW5nQ29udHJvbHNIZWFkZXIgPSB0cnVlO1xuICAgICAgICB0aGlzLnZpc2libGVFbGVtZW50c1NuYXBwaW5nQ29udHJvbHNFbmFibGVkVG9nZ2xlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy52aXNpYmxlRWxlbWVudHNTbmFwcGluZ0NvbnRyb2xzU2VsZkVuYWJsZWRUb2dnbGUgPSB0cnVlO1xuICAgICAgICB0aGlzLnZpc2libGVFbGVtZW50c1NuYXBwaW5nQ29udHJvbHNGZWF0dXJlRW5hYmxlZFRvZ2dsZSA9IHRydWU7XG4gICAgICAgIHRoaXMudmlzaWJsZUVsZW1lbnRzU25hcHBpbmdDb250cm9sc0xheWVyTGlzdCA9IHRydWU7XG4gICAgICAgIHRoaXMucG9zaXRpb24gPSBcImJvdHRvbS1sZWZ0XCI7XG4gICAgICAgIHRoaXMudmlldyA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy53aWRnZXQgPSB1bmRlZmluZWQ7XG4gICAgfVxuICAgIHJlZmVyZW5jZUVsZW1lbnRXYXRjaGVyKHZhbHVlKSB7XG4gICAgICAgIHZvaWQgcmVmZXJlbmNlRWxlbWVudEhlbHBlcih0aGlzLCB2YWx1ZSk7XG4gICAgfVxuICAgIGFsbG93ZWRXb3JrZmxvd3NXYXRjaGVyKHZhbHVlKSB7XG4gICAgICAgIGlmICh0aGlzLndpZGdldCkge1xuICAgICAgICAgICAgdGhpcy53aWRnZXQuYWxsb3dlZFdvcmtmbG93cyA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGljb25XYXRjaGVyKHZhbHVlKSB7XG4gICAgICAgIGlmICh0aGlzLndpZGdldCkge1xuICAgICAgICAgICAgdGhpcy53aWRnZXQuaWNvbiA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGxhYmVsT3B0aW9uc1dhdGNoZXIodmFsdWUpIHtcbiAgICAgICAgaWYgKHRoaXMud2lkZ2V0KSB7XG4gICAgICAgICAgICB0aGlzLndpZGdldC5sYWJlbE9wdGlvbnMgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBsYXllckluZm9zV2F0Y2hlcih2YWx1ZSkge1xuICAgICAgICBpZiAodGhpcy53aWRnZXQpIHtcbiAgICAgICAgICAgIHRoaXMud2lkZ2V0LmxheWVySW5mb3MgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzbmFwcGluZ09wdGlvbnNXYXRjaGVyKHZhbHVlKSB7XG4gICAgICAgIGlmICh0aGlzLndpZGdldCkge1xuICAgICAgICAgICAgdGhpcy53aWRnZXQuc25hcHBpbmdPcHRpb25zID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3VwcG9ydGluZ1dpZGdldERlZmF1bHRzV2F0Y2hlcih2YWx1ZSkge1xuICAgICAgICBpZiAodGhpcy53aWRnZXQpIHtcbiAgICAgICAgICAgIHRoaXMud2lkZ2V0LnN1cHBvcnRpbmdXaWRnZXREZWZhdWx0cyA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHRvb2x0aXBPcHRpb25zV2F0Y2hlcih2YWx1ZSkge1xuICAgICAgICBpZiAodGhpcy53aWRnZXQpIHtcbiAgICAgICAgICAgIHRoaXMud2lkZ2V0LnRvb2x0aXBPcHRpb25zID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdmlzaWJsZUVsZW1lbnRzQ3JlYXRlRmVhdHVyZXNTZWN0aW9uV2F0Y2hlcih2YWx1ZSkge1xuICAgICAgICBpZiAodGhpcy53aWRnZXQpIHtcbiAgICAgICAgICAgIHRoaXMud2lkZ2V0LnZpc2libGVFbGVtZW50cyA9IHtcbiAgICAgICAgICAgICAgICAuLi50aGlzLndpZGdldC52aXNpYmxlRWxlbWVudHMsXG4gICAgICAgICAgICAgICAgY3JlYXRlRmVhdHVyZXNTZWN0aW9uOiB2YWx1ZSxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG4gICAgdmlzaWJsZUVsZW1lbnRzRWRpdEZlYXR1cmVzU2VjdGlvbldhdGNoZXIodmFsdWUpIHtcbiAgICAgICAgaWYgKHRoaXMud2lkZ2V0KSB7XG4gICAgICAgICAgICB0aGlzLndpZGdldC52aXNpYmxlRWxlbWVudHMgPSB7XG4gICAgICAgICAgICAgICAgLi4udGhpcy53aWRnZXQudmlzaWJsZUVsZW1lbnRzLFxuICAgICAgICAgICAgICAgIGVkaXRGZWF0dXJlc1NlY3Rpb246IHZhbHVlLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB2aXNpYmxlRWxlbWVudHNMYWJlbHNUb2dnbGVXYXRjaGVyKHZhbHVlKSB7XG4gICAgICAgIGlmICh0aGlzLndpZGdldCkge1xuICAgICAgICAgICAgdGhpcy53aWRnZXQudmlzaWJsZUVsZW1lbnRzID0ge1xuICAgICAgICAgICAgICAgIC4uLnRoaXMud2lkZ2V0LnZpc2libGVFbGVtZW50cyxcbiAgICAgICAgICAgICAgICBsYWJlbHNUb2dnbGU6IHZhbHVlLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB2aXNpYmxlRWxlbWVudHNUb29sdGlwc1RvZ2dsZVdhdGNoZXIodmFsdWUpIHtcbiAgICAgICAgaWYgKHRoaXMud2lkZ2V0KSB7XG4gICAgICAgICAgICB0aGlzLndpZGdldC52aXNpYmxlRWxlbWVudHMgPSB7XG4gICAgICAgICAgICAgICAgLi4udGhpcy53aWRnZXQudmlzaWJsZUVsZW1lbnRzLFxuICAgICAgICAgICAgICAgIHRvb2x0aXBzVG9nZ2xlOiB2YWx1ZSxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG4gICAgdmlzaWJsZUVsZW1lbnRzU25hcHBpbmdDb250cm9sc1dhdGNoZXIodmFsdWUpIHtcbiAgICAgICAgaWYgKHRoaXMud2lkZ2V0KSB7XG4gICAgICAgICAgICB0aGlzLndpZGdldC52aXNpYmxlRWxlbWVudHMgPSB7XG4gICAgICAgICAgICAgICAgLi4udGhpcy53aWRnZXQudmlzaWJsZUVsZW1lbnRzLFxuICAgICAgICAgICAgICAgIHNuYXBwaW5nQ29udHJvbHM6IHZhbHVlLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB2aXNpYmxlRWxlbWVudHNTbmFwcGluZ0NvbnRyb2xzSGVhZGVyV2F0Y2hlcih2YWx1ZSkge1xuICAgICAgICBpZiAodGhpcy53aWRnZXQpIHtcbiAgICAgICAgICAgIHRoaXMud2lkZ2V0LnZpc2libGVFbGVtZW50cyA9IHtcbiAgICAgICAgICAgICAgICAuLi50aGlzLndpZGdldC52aXNpYmxlRWxlbWVudHMsXG4gICAgICAgICAgICAgICAgc25hcHBpbmdDb250cm9sc0VsZW1lbnRzOiB7XG4gICAgICAgICAgICAgICAgICAgIC4uLnRoaXMud2lkZ2V0LnZpc2libGVFbGVtZW50cy5zbmFwcGluZ0NvbnRyb2xzRWxlbWVudHMsXG4gICAgICAgICAgICAgICAgICAgIGhlYWRlcjogdmFsdWUsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG4gICAgdmlzaWJsZUVsZW1lbnRzU25hcHBpbmdDb250cm9sc0VuYWJsZWRUb2dnbGVXYXRjaGVyKHZhbHVlKSB7XG4gICAgICAgIGlmICh0aGlzLndpZGdldCkge1xuICAgICAgICAgICAgdGhpcy53aWRnZXQudmlzaWJsZUVsZW1lbnRzID0ge1xuICAgICAgICAgICAgICAgIC4uLnRoaXMud2lkZ2V0LnZpc2libGVFbGVtZW50cyxcbiAgICAgICAgICAgICAgICBzbmFwcGluZ0NvbnRyb2xzRWxlbWVudHM6IHtcbiAgICAgICAgICAgICAgICAgICAgLi4udGhpcy53aWRnZXQudmlzaWJsZUVsZW1lbnRzLnNuYXBwaW5nQ29udHJvbHNFbGVtZW50cyxcbiAgICAgICAgICAgICAgICAgICAgZW5hYmxlZFRvZ2dsZTogdmFsdWUsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG4gICAgdmlzaWJsZUVsZW1lbnRzU25hcHBpbmdDb250cm9sc1NlbGZFbmFibGVkVG9nZ2xlV2F0Y2hlcih2YWx1ZSkge1xuICAgICAgICBpZiAodGhpcy53aWRnZXQpIHtcbiAgICAgICAgICAgIHRoaXMud2lkZ2V0LnZpc2libGVFbGVtZW50cyA9IHtcbiAgICAgICAgICAgICAgICAuLi50aGlzLndpZGdldC52aXNpYmxlRWxlbWVudHMsXG4gICAgICAgICAgICAgICAgc25hcHBpbmdDb250cm9sc0VsZW1lbnRzOiB7XG4gICAgICAgICAgICAgICAgICAgIC4uLnRoaXMud2lkZ2V0LnZpc2libGVFbGVtZW50cy5zbmFwcGluZ0NvbnRyb2xzRWxlbWVudHMsXG4gICAgICAgICAgICAgICAgICAgIHNlbGZFbmFibGVkVG9nZ2xlOiB2YWx1ZSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB2aXNpYmxlRWxlbWVudHNTbmFwcGluZ0NvbnRyb2xzRmVhdHVyZUVuYWJsZWRUb2dnbGVXYXRjaGVyKHZhbHVlKSB7XG4gICAgICAgIGlmICh0aGlzLndpZGdldCkge1xuICAgICAgICAgICAgdGhpcy53aWRnZXQudmlzaWJsZUVsZW1lbnRzID0ge1xuICAgICAgICAgICAgICAgIC4uLnRoaXMud2lkZ2V0LnZpc2libGVFbGVtZW50cyxcbiAgICAgICAgICAgICAgICBzbmFwcGluZ0NvbnRyb2xzRWxlbWVudHM6IHtcbiAgICAgICAgICAgICAgICAgICAgLi4udGhpcy53aWRnZXQudmlzaWJsZUVsZW1lbnRzLnNuYXBwaW5nQ29udHJvbHNFbGVtZW50cyxcbiAgICAgICAgICAgICAgICAgICAgZmVhdHVyZUVuYWJsZWRUb2dnbGU6IHZhbHVlLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuICAgIHZpc2libGVFbGVtZW50c1NuYXBwaW5nQ29udHJvbHNMYXllckxpc3RXYXRjaGVyKHZhbHVlKSB7XG4gICAgICAgIGlmICh0aGlzLndpZGdldCkge1xuICAgICAgICAgICAgdGhpcy53aWRnZXQudmlzaWJsZUVsZW1lbnRzID0ge1xuICAgICAgICAgICAgICAgIC4uLnRoaXMud2lkZ2V0LnZpc2libGVFbGVtZW50cyxcbiAgICAgICAgICAgICAgICBzbmFwcGluZ0NvbnRyb2xzRWxlbWVudHM6IHtcbiAgICAgICAgICAgICAgICAgICAgLi4udGhpcy53aWRnZXQudmlzaWJsZUVsZW1lbnRzLnNuYXBwaW5nQ29udHJvbHNFbGVtZW50cyxcbiAgICAgICAgICAgICAgICAgICAgbGF5ZXJMaXN0OiB2YWx1ZSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBwb3NpdGlvbldhdGNoZXIodmFsdWUpIHtcbiAgICAgICAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQgJiYgdGhpcy53aWRnZXQpIHtcbiAgICAgICAgICAgIHRoaXMudmlldy51aS5tb3ZlKHRoaXMuY2hpbGRFbGVtLCB2YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdmlld1dhdGNoZXIodmFsdWUpIHtcbiAgICAgICAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQgJiYgdGhpcy53aWRnZXQpIHtcbiAgICAgICAgICAgIHRoaXMud2lkZ2V0LnZpZXcgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy9cbiAgICAvLyAgTWV0aG9kc1xuICAgIC8vXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIGFzeW5jIGNhbmNlbFdvcmtmbG93KCkge1xuICAgICAgICBhd2FpdCB0aGlzLndpZGdldD8uY2FuY2VsV29ya2Zsb3coKTtcbiAgICB9XG4gICAgYXN5bmMgZGVsZXRlRmVhdHVyZUZyb21Xb3JrZmxvdygpIHtcbiAgICAgICAgYXdhaXQgdGhpcy53aWRnZXQ/LmRlbGV0ZUZlYXR1cmVGcm9tV29ya2Zsb3coKTtcbiAgICB9XG4gICAgYXN5bmMgc3RhcnRDcmVhdGVGZWF0dXJlc1dvcmtmbG93QXRGZWF0dXJlQ3JlYXRpb24oaW5mbykge1xuICAgICAgICBhd2FpdCB0aGlzLndpZGdldD8uc3RhcnRDcmVhdGVGZWF0dXJlc1dvcmtmbG93QXRGZWF0dXJlQ3JlYXRpb24oaW5mbyk7XG4gICAgfVxuICAgIGFzeW5jIHN0YXJ0Q3JlYXRlRmVhdHVyZXNXb3JrZmxvd0F0RmVhdHVyZVR5cGVTZWxlY3Rpb24oKSB7XG4gICAgICAgIGF3YWl0IHRoaXMud2lkZ2V0Py5zdGFydENyZWF0ZUZlYXR1cmVzV29ya2Zsb3dBdEZlYXR1cmVUeXBlU2VsZWN0aW9uKCk7XG4gICAgfVxuICAgIGFzeW5jIHN0YXJ0VXBkYXRlV29ya2Zsb3dBdEZlYXR1cmVFZGl0KGZlYXR1cmUpIHtcbiAgICAgICAgYXdhaXQgdGhpcy53aWRnZXQ/LnN0YXJ0VXBkYXRlV29ya2Zsb3dBdEZlYXR1cmVFZGl0KGZlYXR1cmUpO1xuICAgIH1cbiAgICBhc3luYyBzdGFydFVwZGF0ZVdvcmtmbG93QXRGZWF0dXJlU2VsZWN0aW9uKCkge1xuICAgICAgICBhd2FpdCB0aGlzLndpZGdldD8uc3RhcnRVcGRhdGVXb3JrZmxvd0F0RmVhdHVyZVNlbGVjdGlvbigpO1xuICAgIH1cbiAgICBhc3luYyBzdGFydFVwZGF0ZVdvcmtmbG93QXRNdWx0aXBsZUZlYXR1cmVTZWxlY3Rpb24oY2FuZGlkYXRlcykge1xuICAgICAgICBhd2FpdCB0aGlzLndpZGdldD8uc3RhcnRVcGRhdGVXb3JrZmxvd0F0TXVsdGlwbGVGZWF0dXJlU2VsZWN0aW9uKGNhbmRpZGF0ZXMpO1xuICAgIH1cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy9cbiAgICAvLyAgTGlmZWN5Y2xlXG4gICAgLy9cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgYXN5bmMgY29tcG9uZW50RGlkTG9hZCgpIHtcbiAgICAgICAgY29uc3QgcGFyYW1zID0gdGhpcy5fY3JlYXRlUGFyYW1zKCk7XG4gICAgICAgIGNvbnN0IHdpZGdldCA9IGF3YWl0IG5ld1dpZGdldHNFZGl0b3IocGFyYW1zKTtcbiAgICAgICAgdGhpcy53aWRnZXQgPSB3aWRnZXQ7XG4gICAgICAgIGF3YWl0IHRoaXMuX2FkZFdhdGNoZXJzKCk7XG4gICAgICAgIHRoaXMuX2FkZENvbnRhaW5lcigpO1xuICAgICAgICB0aGlzLmFyY2dpc0VkaXRvclJlYWR5LmVtaXQoKTtcbiAgICAgICAgY2hlY2tGb3JWaWV3KHRoaXMpO1xuICAgIH1cbiAgICBkaXNjb25uZWN0ZWRDYWxsYmFjaygpIHtcbiAgICAgICAgb25EaXNjb25uZWN0ZWRIZWxwZXIodGhpcyk7XG4gICAgfVxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgcmV0dXJuIGgoXCJkaXZcIiwgeyByZWY6IChlbCkgPT4gKHRoaXMuY2hpbGRFbGVtID0gZWwpIH0pO1xuICAgIH1cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy9cbiAgICAvLyAgUHJpdmF0ZSBNZXRob2RzXG4gICAgLy9cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgX2FkZENvbnRhaW5lcigpIHtcbiAgICAgICAgdGhpcy53aWRnZXQuY29udGFpbmVyID0gdGhpcy5jaGlsZEVsZW07XG4gICAgfVxuICAgIGFzeW5jIF9hZGRXYXRjaGVycygpIHtcbiAgICAgICAgY29uc3QgeyB3YXRjaCB9ID0gYXdhaXQgaW1wb3J0Q29yZVJlYWN0aXZlVXRpbHMoKTtcbiAgICAgICAgYWRkSGFuZGxlcyh0aGlzLCB3YXRjaCgoKSA9PiB0aGlzLndpZGdldC5hY3RpdmVXb3JrZmxvdywgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmFjdGl2ZVdvcmtmbG93ID0gdmFsdWU7XG4gICAgICAgICAgICB0aGlzLmFyY2dpc1Byb3BlcnR5Q2hhbmdlLmVtaXQoeyBuYW1lOiBcImFjdGl2ZVdvcmtmbG93XCIgfSk7XG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGluaXRpYWw6IHRydWUsXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgX2NyZWF0ZVBhcmFtcygpIHtcbiAgICAgICAgY29uc3QgcGFyYW1zID0ge307XG4gICAgICAgIHBhcmFtcy52aXNpYmxlRWxlbWVudHMgPSB7XG4gICAgICAgICAgICBjcmVhdGVGZWF0dXJlc1NlY3Rpb246IHRoaXMudmlzaWJsZUVsZW1lbnRzQ3JlYXRlRmVhdHVyZXNTZWN0aW9uLFxuICAgICAgICAgICAgZWRpdEZlYXR1cmVzU2VjdGlvbjogdGhpcy52aXNpYmxlRWxlbWVudHNFZGl0RmVhdHVyZXNTZWN0aW9uLFxuICAgICAgICAgICAgbGFiZWxzVG9nZ2xlOiB0aGlzLnZpc2libGVFbGVtZW50c0xhYmVsc1RvZ2dsZSxcbiAgICAgICAgICAgIHRvb2x0aXBzVG9nZ2xlOiB0aGlzLnZpc2libGVFbGVtZW50c1Rvb2x0aXBzVG9nZ2xlLFxuICAgICAgICAgICAgc25hcHBpbmdDb250cm9sczogdGhpcy52aXNpYmxlRWxlbWVudHNTbmFwcGluZ0NvbnRyb2xzLFxuICAgICAgICAgICAgc25hcHBpbmdDb250cm9sc0VsZW1lbnRzOiB7XG4gICAgICAgICAgICAgICAgaGVhZGVyOiB0aGlzLnZpc2libGVFbGVtZW50c1NuYXBwaW5nQ29udHJvbHNIZWFkZXIsXG4gICAgICAgICAgICAgICAgZW5hYmxlZFRvZ2dsZTogdGhpcy52aXNpYmxlRWxlbWVudHNTbmFwcGluZ0NvbnRyb2xzRW5hYmxlZFRvZ2dsZSxcbiAgICAgICAgICAgICAgICBzZWxmRW5hYmxlZFRvZ2dsZTogdGhpcy52aXNpYmxlRWxlbWVudHNTbmFwcGluZ0NvbnRyb2xzU2VsZkVuYWJsZWRUb2dnbGUsXG4gICAgICAgICAgICAgICAgZmVhdHVyZUVuYWJsZWRUb2dnbGU6IHRoaXMudmlzaWJsZUVsZW1lbnRzU25hcHBpbmdDb250cm9sc0ZlYXR1cmVFbmFibGVkVG9nZ2xlLFxuICAgICAgICAgICAgICAgIGxheWVyTGlzdDogdGhpcy52aXNpYmxlRWxlbWVudHNTbmFwcGluZ0NvbnRyb2xzTGF5ZXJMaXN0LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKHRoaXMuYWxsb3dlZFdvcmtmbG93cykge1xuICAgICAgICAgICAgcGFyYW1zLmFsbG93ZWRXb3JrZmxvd3MgPSB0aGlzLmFsbG93ZWRXb3JrZmxvd3M7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuaWNvbikge1xuICAgICAgICAgICAgcGFyYW1zLmljb24gPSB0aGlzLmljb247XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubGFiZWxPcHRpb25zKSB7XG4gICAgICAgICAgICBwYXJhbXMubGFiZWxPcHRpb25zID0gdGhpcy5sYWJlbE9wdGlvbnM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubGF5ZXJJbmZvcykge1xuICAgICAgICAgICAgcGFyYW1zLmxheWVySW5mb3MgPSB0aGlzLmxheWVySW5mb3M7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuc25hcHBpbmdPcHRpb25zKSB7XG4gICAgICAgICAgICBwYXJhbXMuc25hcHBpbmdPcHRpb25zID0gdGhpcy5zbmFwcGluZ09wdGlvbnM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuc3VwcG9ydGluZ1dpZGdldERlZmF1bHRzKSB7XG4gICAgICAgICAgICBwYXJhbXMuc3VwcG9ydGluZ1dpZGdldERlZmF1bHRzID0gdGhpcy5zdXBwb3J0aW5nV2lkZ2V0RGVmYXVsdHM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMudG9vbHRpcE9wdGlvbnMpIHtcbiAgICAgICAgICAgIHBhcmFtcy50b29sdGlwT3B0aW9ucyA9IHRoaXMudG9vbHRpcE9wdGlvbnM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMudmlldykge1xuICAgICAgICAgICAgcGFyYW1zLnZpZXcgPSB0aGlzLnZpZXc7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHBhcmFtcztcbiAgICB9XG4gICAgZ2V0IGVsKCkgeyByZXR1cm4gZ2V0RWxlbWVudCh0aGlzKTsgfVxuICAgIHN0YXRpYyBnZXQgd2F0Y2hlcnMoKSB7IHJldHVybiB7XG4gICAgICAgIFwicmVmZXJlbmNlRWxlbWVudFwiOiBbXCJyZWZlcmVuY2VFbGVtZW50V2F0Y2hlclwiXSxcbiAgICAgICAgXCJhbGxvd2VkV29ya2Zsb3dzXCI6IFtcImFsbG93ZWRXb3JrZmxvd3NXYXRjaGVyXCJdLFxuICAgICAgICBcImljb25cIjogW1wiaWNvbldhdGNoZXJcIl0sXG4gICAgICAgIFwibGFiZWxPcHRpb25zXCI6IFtcImxhYmVsT3B0aW9uc1dhdGNoZXJcIl0sXG4gICAgICAgIFwibGF5ZXJJbmZvc1wiOiBbXCJsYXllckluZm9zV2F0Y2hlclwiXSxcbiAgICAgICAgXCJzbmFwcGluZ09wdGlvbnNcIjogW1wic25hcHBpbmdPcHRpb25zV2F0Y2hlclwiXSxcbiAgICAgICAgXCJzdXBwb3J0aW5nV2lkZ2V0RGVmYXVsdHNcIjogW1wic3VwcG9ydGluZ1dpZGdldERlZmF1bHRzV2F0Y2hlclwiXSxcbiAgICAgICAgXCJ0b29sdGlwT3B0aW9uc1wiOiBbXCJ0b29sdGlwT3B0aW9uc1dhdGNoZXJcIl0sXG4gICAgICAgIFwidmlzaWJsZUVsZW1lbnRzQ3JlYXRlRmVhdHVyZXNTZWN0aW9uXCI6IFtcInZpc2libGVFbGVtZW50c0NyZWF0ZUZlYXR1cmVzU2VjdGlvbldhdGNoZXJcIl0sXG4gICAgICAgIFwidmlzaWJsZUVsZW1lbnRzRWRpdEZlYXR1cmVzU2VjdGlvblwiOiBbXCJ2aXNpYmxlRWxlbWVudHNFZGl0RmVhdHVyZXNTZWN0aW9uV2F0Y2hlclwiXSxcbiAgICAgICAgXCJ2aXNpYmxlRWxlbWVudHNMYWJlbHNUb2dnbGVcIjogW1widmlzaWJsZUVsZW1lbnRzTGFiZWxzVG9nZ2xlV2F0Y2hlclwiXSxcbiAgICAgICAgXCJ2aXNpYmxlRWxlbWVudHNUb29sdGlwc1RvZ2dsZVwiOiBbXCJ2aXNpYmxlRWxlbWVudHNUb29sdGlwc1RvZ2dsZVdhdGNoZXJcIl0sXG4gICAgICAgIFwidmlzaWJsZUVsZW1lbnRzU25hcHBpbmdDb250cm9sc1wiOiBbXCJ2aXNpYmxlRWxlbWVudHNTbmFwcGluZ0NvbnRyb2xzV2F0Y2hlclwiXSxcbiAgICAgICAgXCJ2aXNpYmxlRWxlbWVudHNTbmFwcGluZ0NvbnRyb2xzSGVhZGVyXCI6IFtcInZpc2libGVFbGVtZW50c1NuYXBwaW5nQ29udHJvbHNIZWFkZXJXYXRjaGVyXCJdLFxuICAgICAgICBcInZpc2libGVFbGVtZW50c1NuYXBwaW5nQ29udHJvbHNFbmFibGVkVG9nZ2xlXCI6IFtcInZpc2libGVFbGVtZW50c1NuYXBwaW5nQ29udHJvbHNFbmFibGVkVG9nZ2xlV2F0Y2hlclwiXSxcbiAgICAgICAgXCJ2aXNpYmxlRWxlbWVudHNTbmFwcGluZ0NvbnRyb2xzU2VsZkVuYWJsZWRUb2dnbGVcIjogW1widmlzaWJsZUVsZW1lbnRzU25hcHBpbmdDb250cm9sc1NlbGZFbmFibGVkVG9nZ2xlV2F0Y2hlclwiXSxcbiAgICAgICAgXCJ2aXNpYmxlRWxlbWVudHNTbmFwcGluZ0NvbnRyb2xzRmVhdHVyZUVuYWJsZWRUb2dnbGVcIjogW1widmlzaWJsZUVsZW1lbnRzU25hcHBpbmdDb250cm9sc0ZlYXR1cmVFbmFibGVkVG9nZ2xlV2F0Y2hlclwiXSxcbiAgICAgICAgXCJ2aXNpYmxlRWxlbWVudHNTbmFwcGluZ0NvbnRyb2xzTGF5ZXJMaXN0XCI6IFtcInZpc2libGVFbGVtZW50c1NuYXBwaW5nQ29udHJvbHNMYXllckxpc3RXYXRjaGVyXCJdLFxuICAgICAgICBcInBvc2l0aW9uXCI6IFtcInBvc2l0aW9uV2F0Y2hlclwiXSxcbiAgICAgICAgXCJ2aWV3XCI6IFtcInZpZXdXYXRjaGVyXCJdXG4gICAgfTsgfVxufTtcbkFyY2dpc0VkaXRvci5zdHlsZSA9IGVkaXRvckNzcztcblxuZXhwb3J0IHsgQXJjZ2lzRWRpdG9yIGFzIGFyY2dpc19lZGl0b3IgfTtcbiIsIi8qIVxuICogQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFc3JpLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAqIFNlZSBodHRwczovL2pzLmFyY2dpcy5jb20vNC4zMC9lc3JpL2NvcHlyaWdodC50eHQgZm9yIGRldGFpbHMuXG4gKiB2NC4zMC4wLW5leHQuMzdcbiAqL1xuZnVuY3Rpb24gY2hlY2tGb3JFeHBhbmQoZWxlbWVudCkge1xuICAgIGNvbnN0IGV4cGFuZFJlZiA9IGVsZW1lbnQuZWwuY2xvc2VzdChcImFyY2dpcy1leHBhbmRcIikgPz8gZWxlbWVudC5leHBhbmRFbGVtO1xuICAgIGlmIChleHBhbmRSZWY/LndpZGdldCkge1xuICAgICAgICBlbGVtZW50LnZpZXcgPSBleHBhbmRSZWYudmlldztcbiAgICAgICAgZXhwYW5kUmVmLndpZGdldC5jb250ZW50ID0gZWxlbWVudC5jaGlsZEVsZW0gPz8gZWxlbWVudC5lbDtcbiAgICAgICAgLy8gVE9ETzogVXBkYXRlIHRvIGJlIGV4cGFuZEljb24gPSB3aWRnZXQuaWNvbiwgbm90IHJlYWR5IHlldCBpbiA0LjI3bmV4dFxuICAgICAgICBpZiAoIWV4cGFuZFJlZi5leHBhbmRJY29uKSB7XG4gICAgICAgICAgICBleHBhbmRSZWYud2lkZ2V0LmV4cGFuZEljb24gPSBlbGVtZW50LndpZGdldCA/IGVsZW1lbnQud2lkZ2V0Lmljb24gOiBlbGVtZW50Py5pY29uO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICBpZiAoZXhwYW5kUmVmKSB7XG4gICAgICAgIGNvbnN0IHdpZGdldEhhbmRsZXIgPSAoKSA9PiB7XG4gICAgICAgICAgICBleHBhbmRSZWYucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImFyY2dpc0V4cGFuZFJlYWR5XCIsIHdpZGdldEhhbmRsZXIsIGZhbHNlKTtcbiAgICAgICAgICAgIGVsZW1lbnQudmlldyA9IGV4cGFuZFJlZi52aWV3O1xuICAgICAgICAgICAgZXhwYW5kUmVmLndpZGdldC5jb250ZW50ID0gZWxlbWVudC5jaGlsZEVsZW0gPz8gZWxlbWVudC5lbDtcbiAgICAgICAgICAgIGlmICghZXhwYW5kUmVmLmV4cGFuZEljb24pIHtcbiAgICAgICAgICAgICAgICBleHBhbmRSZWYud2lkZ2V0LmV4cGFuZEljb24gPSBlbGVtZW50LndpZGdldCA/IGVsZW1lbnQud2lkZ2V0Lmljb24gOiBlbGVtZW50Py5pY29uO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBleHBhbmRSZWYuYWRkRXZlbnRMaXN0ZW5lcihcImFyY2dpc0V4cGFuZFJlYWR5XCIsIHdpZGdldEhhbmRsZXIsIGZhbHNlKTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbn1cblxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy9cbi8vICBQdWJsaWMgTWV0aG9kc1xuLy9cbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbmZ1bmN0aW9uIGFkZEhhbmRsZXMoZWxlbWVudCwgaGFuZGxlKSB7XG4gICAgaWYgKEFycmF5LmlzQXJyYXkoaGFuZGxlKSkge1xuICAgICAgICBlbGVtZW50Ll93YXRjaEhhbmRsZXMgPSBbLi4uZWxlbWVudC5fd2F0Y2hIYW5kbGVzLCAuLi5oYW5kbGVdO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgZWxlbWVudC5fd2F0Y2hIYW5kbGVzLnB1c2goaGFuZGxlKTtcbiAgICB9XG59XG5mdW5jdGlvbiBjaGVja0ZvclZpZXcoZWxlbWVudCkge1xuICAgIGxldCBpc1VzaW5nUmVmZXJlbmNlRWxlbWVudCA9IGZhbHNlO1xuICAgIGlmICghY2hlY2tGb3JFeHBhbmQoZWxlbWVudCkpIHtcbiAgICAgICAgbGV0IHZpZXdSZWYgPSBlbGVtZW50LmVsLmNsb3Nlc3QoXCJhcmNnaXMtbWFwXCIpID8/IGVsZW1lbnQuZWwuY2xvc2VzdChcImFyY2dpcy1zY2VuZVwiKTtcbiAgICAgICAgaWYgKCF2aWV3UmVmICYmIHR5cGVvZiBlbGVtZW50LnJlZmVyZW5jZUVsZW1lbnQgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgIHZpZXdSZWYgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGVsZW1lbnQucmVmZXJlbmNlRWxlbWVudCk7XG4gICAgICAgICAgICBpc1VzaW5nUmVmZXJlbmNlRWxlbWVudCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHZpZXdSZWY/LnZpZXcpIHtcbiAgICAgICAgICAgIGVsZW1lbnQudmlldyA9IHZpZXdSZWYudmlldztcbiAgICAgICAgICAgIGNvbnN0IGVsID0gZWxlbWVudC5jaGlsZEVsZW0gPz8gZWxlbWVudC5lbDtcbiAgICAgICAgICAgIGlmICghaXNVc2luZ1JlZmVyZW5jZUVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICBlbGVtZW50LnZpZXcudWkuYWRkKGVsLCBlbGVtZW50LnBvc2l0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh2aWV3UmVmKSB7XG4gICAgICAgICAgICB3YWl0Rm9yVmlld0hhbmRsZXIodmlld1JlZiwgZWxlbWVudCwgaXNVc2luZ1JlZmVyZW5jZUVsZW1lbnQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBjb25zdCB2aWV3UmVmID0gZWxlbWVudC5lbC5jbG9zZXN0KFwiYXJjZ2lzLW1hcFwiKSA/PyBlbGVtZW50LmVsLmNsb3Nlc3QoXCJhcmNnaXMtc2NlbmVcIik7XG4gICAgICAgIGlmICh2aWV3UmVmPy52aWV3KSB7XG4gICAgICAgICAgICBlbGVtZW50LnZpZXcgPSB2aWV3UmVmLnZpZXc7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodmlld1JlZikge1xuICAgICAgICAgICAgY29uc3QgaGFuZGxlciA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICB2aWV3UmVmLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJhcmNnaXNWaWV3UmVhZHlDaGFuZ2VcIiwgaGFuZGxlciwgZmFsc2UpO1xuICAgICAgICAgICAgICAgIGVsZW1lbnQudmlldyA9IHZpZXdSZWYudmlldztcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2aWV3UmVmLmFkZEV2ZW50TGlzdGVuZXIoXCJhcmNnaXNWaWV3UmVhZHlDaGFuZ2VcIiwgaGFuZGxlciwgZmFsc2UpO1xuICAgICAgICB9XG4gICAgfVxufVxuZnVuY3Rpb24gaXNOdWxsT3JFbXB0eVN0cmluZyh2YWx1ZSkge1xuICAgIHJldHVybiB2YWx1ZSA9PT0gdW5kZWZpbmVkIHx8IHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSBcIlwiO1xufVxuZnVuY3Rpb24gaXNWYWxpZEludGVnZXIodmFsdWUpIHtcbiAgICByZXR1cm4gdmFsdWUgIT0gbnVsbCAmJiB2YWx1ZSAlIDEgPT09IDA7XG59XG5mdW5jdGlvbiBpc05vdFNhbWVDYW1lcmEoY2FtZXJhLCBjYW1lcmEyKSB7XG4gICAgcmV0dXJuIChjYW1lcmEyID09PSB1bmRlZmluZWQgfHxcbiAgICAgICAgY2FtZXJhLnBvc2l0aW9uICE9PSBjYW1lcmEyLnBvc2l0aW9uIHx8XG4gICAgICAgIGNhbWVyYS5oZWFkaW5nICE9PSBjYW1lcmEyLmhlYWRpbmcgfHxcbiAgICAgICAgY2FtZXJhLnRpbHQgIT09IGNhbWVyYTIudGlsdCk7XG59XG5mdW5jdGlvbiBpc05vdFNhbWVFbnZpcm9ubWVudChlbnZpcm9ubWVudCwgZW52aXJvbm1lbnQyKSB7XG4gICAgcmV0dXJuIChlbnZpcm9ubWVudDIgPT09IHVuZGVmaW5lZCB8fFxuICAgICAgICBlbnZpcm9ubWVudDIuYXRtb3NwaGVyZUVuYWJsZWQgIT09IGVudmlyb25tZW50LmF0bW9zcGhlcmVFbmFibGVkIHx8XG4gICAgICAgIGVudmlyb25tZW50Mi5saWdodGluZy5kYXRlICE9PSBlbnZpcm9ubWVudC5saWdodGluZy5kYXRlIHx8XG4gICAgICAgIGVudmlyb25tZW50Mi5saWdodGluZy5kaXJlY3RTaGFkb3dzRW5hYmxlZCAhPT1cbiAgICAgICAgICAgIGVudmlyb25tZW50LmxpZ2h0aW5nLmRpcmVjdFNoYWRvd3NFbmFibGVkIHx8XG4gICAgICAgIGVudmlyb25tZW50Mi5saWdodGluZy5jYW1lcmFUcmFja2luZ0VuYWJsZWQgIT09XG4gICAgICAgICAgICBlbnZpcm9ubWVudC5saWdodGluZy5jYW1lcmFUcmFja2luZ0VuYWJsZWQgfHxcbiAgICAgICAgZW52aXJvbm1lbnQyLmxpZ2h0aW5nLmRhdGUgIT09IGVudmlyb25tZW50LmxpZ2h0aW5nLmRhdGUgfHxcbiAgICAgICAgZW52aXJvbm1lbnQyLmxpZ2h0aW5nLmRpc3BsYXlVVENPZmZzZXQgIT09XG4gICAgICAgICAgICBlbnZpcm9ubWVudC5saWdodGluZy5kaXNwbGF5VVRDT2Zmc2V0KTtcbn1cbmZ1bmN0aW9uIGlzTm90U2FtZVZpZXdwb2ludCh2aWV3cG9pbnQsIHZpZXdwb2ludDIpIHtcbiAgICByZXR1cm4gKHZpZXdwb2ludDIgPT09IHVuZGVmaW5lZCB8fFxuICAgICAgICB2aWV3cG9pbnQudGFyZ2V0R2VvbWV0cnkgIT09IHZpZXdwb2ludDIudGFyZ2V0R2VvbWV0cnkgfHxcbiAgICAgICAgdmlld3BvaW50LnJvdGF0aW9uICE9PSB2aWV3cG9pbnQyLnJvdGF0aW9uIHx8XG4gICAgICAgIHZpZXdwb2ludC5zY2FsZSAhPT0gdmlld3BvaW50Mi5zY2FsZSk7XG59XG5hc3luYyBmdW5jdGlvbiB1cGRhdGVGb3JWaWV3KHZpZXdTdHIpIHtcbiAgICBjb25zdCB2aWV3UmVmID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih2aWV3U3RyKTtcbiAgICByZXR1cm4gYXdhaXQgbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcbiAgICAgICAgaWYgKHZpZXdSZWY/LnZpZXcgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmVzb2x2ZSh2aWV3UmVmLnZpZXcpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHZpZXdSZWYpIHtcbiAgICAgICAgICAgIGNvbnN0IGhhbmRsZXIgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdmlld1JlZi5yZW1vdmVFdmVudExpc3RlbmVyKFwiYXJjZ2lzVmlld1JlYWR5Q2hhbmdlXCIsIGhhbmRsZXIsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICByZXNvbHZlKHZpZXdSZWYudmlldyk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdmlld1JlZi5hZGRFdmVudExpc3RlbmVyKFwiYXJjZ2lzVmlld1JlYWR5Q2hhbmdlXCIsIGhhbmRsZXIsIGZhbHNlKTtcbiAgICAgICAgfVxuICAgIH0pO1xufVxuYXN5bmMgZnVuY3Rpb24gcmVmZXJlbmNlRWxlbWVudEhlbHBlcihlbGVtZW50LCByZWZFbGVtZW50KSB7XG4gICAgaWYgKHJlZkVsZW1lbnQgPT09IHVuZGVmaW5lZClcbiAgICAgICAgcmV0dXJuO1xuICAgIGVsc2UgaWYgKHR5cGVvZiByZWZFbGVtZW50ID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgIGVsZW1lbnQudmlldyA9IGF3YWl0IHVwZGF0ZUZvclZpZXcocmVmRWxlbWVudCk7XG4gICAgfVxuICAgIGVsc2UgaWYgKGVsZW1lbnQud2lkZ2V0KSB7XG4gICAgICAgIGVsZW1lbnQudmlldyA9IHJlZkVsZW1lbnQudmlldztcbiAgICB9XG59XG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vL1xuLy8gIFByaXZhdGUgTWV0aG9kc1xuLy9cbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbmZ1bmN0aW9uIHdhaXRGb3JWaWV3SGFuZGxlcih2aWV3UmVmLCBlbGVtZW50LCBpc1VzaW5nUmVmZXJuY2VFbGVtZW50KSB7XG4gICAgY29uc3QgaGFuZGxlciA9ICgpID0+IHtcbiAgICAgICAgdmlld1JlZi5yZW1vdmVFdmVudExpc3RlbmVyKFwiYXJjZ2lzVmlld1JlYWR5Q2hhbmdlXCIsIGhhbmRsZXIsIGZhbHNlKTtcbiAgICAgICAgZWxlbWVudC52aWV3ID0gdmlld1JlZi52aWV3O1xuICAgICAgICBpZiAoIWlzVXNpbmdSZWZlcm5jZUVsZW1lbnQpIHtcbiAgICAgICAgICAgIGVsZW1lbnQudmlldy51aS5hZGQoZWxlbWVudC5jaGlsZEVsZW0gPz8gZWxlbWVudC5lbCwgZWxlbWVudC5wb3NpdGlvbik7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHZpZXdSZWYuYWRkRXZlbnRMaXN0ZW5lcihcImFyY2dpc1ZpZXdSZWFkeUNoYW5nZVwiLCBoYW5kbGVyLCBmYWxzZSk7XG59XG5cbmV4cG9ydCB7IGFkZEhhbmRsZXMgYXMgYSwgaXNOb3RTYW1lVmlld3BvaW50IGFzIGIsIGNoZWNrRm9yVmlldyBhcyBjLCBjaGVja0ZvckV4cGFuZCBhcyBkLCBpc05vdFNhbWVDYW1lcmEgYXMgZSwgaXNOb3RTYW1lRW52aXJvbm1lbnQgYXMgZiwgaXNWYWxpZEludGVnZXIgYXMgZywgaXNOdWxsT3JFbXB0eVN0cmluZyBhcyBpLCByZWZlcmVuY2VFbGVtZW50SGVscGVyIGFzIHIgfTtcbiIsIi8qIVxuICogQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFc3JpLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAqIFNlZSBodHRwczovL2pzLmFyY2dpcy5jb20vNC4zMC9lc3JpL2NvcHlyaWdodC50eHQgZm9yIGRldGFpbHMuXG4gKiB2NC4zMC4wLW5leHQuMzdcbiAqL1xuZnVuY3Rpb24gb25EaXNjb25uZWN0ZWRIZWxwZXIoZWxlbWVudCkge1xuICAgIGlmIChlbGVtZW50LmNoaWxkRWxlbSkge1xuICAgICAgICBpZiAoIWVsZW1lbnQuZWwuaXNDb25uZWN0ZWQpIHtcbiAgICAgICAgICAgIGlmIChlbGVtZW50LnZpZXcpIHtcbiAgICAgICAgICAgICAgICBlbGVtZW50LnZpZXcudWkucmVtb3ZlKGVsZW1lbnQuY2hpbGRFbGVtKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGVsZW1lbnQud2lkZ2V0Py52aWV3KSB7XG4gICAgICAgICAgICAgICAgZWxlbWVudC53aWRnZXQudmlldy51aS5yZW1vdmUoZWxlbWVudC5jaGlsZEVsZW0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGVsZW1lbnQuX3dhdGNoSGFuZGxlcykge1xuICAgICAgICAgICAgICAgIGVsZW1lbnQuX3dhdGNoSGFuZGxlcy5mb3JFYWNoKChoYW5kbGUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxlbWVudC5fd2F0Y2hIYW5kbGVzID0gW107XG4gICAgICAgICAgICBlbGVtZW50LndpZGdldD8uZGVzdHJveSgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIGlmICghZWxlbWVudC5lbC5pc0Nvbm5lY3RlZCkge1xuICAgICAgICAgICAgICAgIGlmIChlbGVtZW50LnZpZXcpIHtcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC52aWV3LnVpLnJlbW92ZShlbGVtZW50LmVsKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoZWxlbWVudC53aWRnZXQ/LnZpZXcpIHtcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC53aWRnZXQudmlldy51aS5yZW1vdmUoZWxlbWVudC5lbCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChlbGVtZW50Ll93YXRjaEhhbmRsZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5fd2F0Y2hIYW5kbGVzLmZvckVhY2goKGhhbmRsZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxlbWVudC5fd2F0Y2hIYW5kbGVzID0gW107XG4gICAgICAgICAgICAgICAgZWxlbWVudC53aWRnZXQ/LmRlc3Ryb3koKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwgMTAwMCk7XG4gICAgfVxufVxuXG5leHBvcnQgeyBvbkRpc2Nvbm5lY3RlZEhlbHBlciBhcyBvIH07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=