"use strict";
(self["webpackChunkexb_client"] = self["webpackChunkexb_client"] || []).push([["vendors-node_modules_arcgis_map-components_dist_esm_arcgis-search_entry_js"],{

/***/ "./node_modules/@arcgis/map-components/dist/esm/arcgis-search.entry.js":
/*!*****************************************************************************!*\
  !*** ./node_modules/@arcgis/map-components/dist/esm/arcgis-search.entry.js ***!
  \*****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   arcgis_search: () => (/* binding */ ArcgisSearch)
/* harmony export */ });
/* harmony import */ var _index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-6e172aac.js */ "./node_modules/@arcgis/map-components/dist/esm/index-6e172aac.js");
/* harmony import */ var _index_0bc55ca5_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./index-0bc55ca5.js */ "./node_modules/@arcgis/map-components/dist/esm/index-0bc55ca5.js");
/* harmony import */ var _component_utils_23194f7c_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./component-utils-23194f7c.js */ "./node_modules/@arcgis/map-components/dist/esm/component-utils-23194f7c.js");
/* harmony import */ var _disconnected_6cf1c100_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./disconnected-6cf1c100.js */ "./node_modules/@arcgis/map-components/dist/esm/disconnected-6cf1c100.js");
/*!
 * All material copyright Esri, All Rights Reserved, unless otherwise specified.
 * See https://js.arcgis.com/4.30/esri/copyright.txt for details.
 * v4.30.0-next.37
 */





const searchCss = "";

const ArcgisSearch = class {
    constructor(hostRef) {
        (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);
        this.arcgisSearchReady = (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "arcgisSearchReady", 7);
        this.searchBlur = (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "searchBlur", 7);
        this.searchClear = (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "searchClear", 7);
        this.searchComplete = (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "searchComplete", 7);
        this.searchFocus = (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "searchFocus", 7);
        this.searchStart = (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "searchStart", 7);
        this.searchSelectResult = (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "searchSelectResult", 7);
        this.searchSuggestComplete = (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "searchSuggestComplete", 7);
        this.searchSuggestStart = (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "searchSuggestStart", 7);
        this._watchHandles = [];
        this.referenceElement = undefined;
        this.activeMenu = "none";
        this.activeSource = undefined;
        this.activeSourceIndex = 0;
        this.allPlaceholder = "Find address or place";
        this.allSources = undefined;
        this.autoSelect = true;
        this.defaultSources = undefined;
        this.disabled = false;
        this.icon = undefined;
        this.includeDefaultSources = true;
        this.locationEnabled = true;
        this.maxResults = 6;
        this.maxSuggestions = 6;
        this.minSuggestCharacters = 3;
        this.popupEnabled = true;
        this.popupTemplate = undefined;
        this.portal = undefined;
        this.resultGraphic = undefined;
        this.resultGraphicEnabled = true;
        this.results = undefined;
        this.searchAllEnabled = true;
        this.searchTerm = undefined;
        this.selectedResult = undefined;
        this.sources = undefined;
        this.suggestions = undefined;
        this.suggestionsEnabled = true;
        this.position = "top-right";
        this.view = undefined;
        this.widget = undefined;
    }
    referenceElementWatcher(value) {
        void (0,_component_utils_23194f7c_js__WEBPACK_IMPORTED_MODULE_2__.r)(this, value);
    }
    activeMenuWatcher(value) {
        if (value !== undefined && this.widget) {
            this.widget.activeMenu = value;
        }
    }
    activeSourceIndexWatcher(value) {
        if (value !== undefined && this.widget) {
            this.widget.activeSourceIndex = value;
        }
    }
    allPlaceholderWatcher(value) {
        if (this.widget) {
            this.widget.allPlaceholder = value;
        }
    }
    autoSelectWatcher(value) {
        if (value !== undefined && this.widget) {
            this.widget.autoSelect = value;
        }
    }
    disabledWatcher(value, old) {
        if (this.widget && value !== old) {
            this.widget.disabled = value;
        }
    }
    iconWatcher(value) {
        if (this.widget) {
            this.widget.icon = value;
        }
    }
    includeDefaultSourcesWatcher(value) {
        if (value !== undefined && this.widget) {
            this.widget.includeDefaultSources = value;
        }
    }
    locationEnabledWatcher(value) {
        if (value !== undefined && this.widget) {
            this.widget.locationEnabled = value;
        }
    }
    maxResultsWatcher(value) {
        if (value !== undefined && this.widget) {
            this.widget.maxResults = value;
        }
    }
    maxSuggestionsWatcher(value) {
        if (value !== undefined && this.widget) {
            this.widget.maxSuggestions = value;
        }
    }
    minSuggestCharactersWatcher(value) {
        if (value !== undefined && this.widget) {
            this.widget.minSuggestCharacters = value;
        }
    }
    popupEnabledWatcher(value) {
        if (value !== undefined && this.widget) {
            this.widget.popupEnabled = value;
        }
    }
    popupTemplateWatcher(value) {
        if (this.widget) {
            this.widget.popupTemplate = value;
        }
    }
    portalWatcher(value) {
        if (this.widget) {
            this.widget.portal = value;
        }
    }
    resultGraphicEnabledWatcher(value) {
        if (value !== undefined && this.widget) {
            this.widget.resultGraphicEnabled = value;
        }
    }
    searchAllEnabledWatcher(value) {
        if (value !== undefined && this.widget) {
            this.widget.searchAllEnabled = value;
        }
    }
    searchTermWatcher(value) {
        if (this.widget) {
            this.widget.searchTerm = value;
        }
    }
    sourcesWatcher(value) {
        if (this.widget) {
            this.widget.sources = value;
        }
    }
    suggestionsEnabledWatcher(value) {
        if (value !== undefined && this.widget) {
            this.widget.suggestionsEnabled = value;
        }
    }
    positionWatcher(value) {
        if (value !== undefined && this.widget) {
            this.view.ui.move(this.childElem, value);
        }
    }
    viewWatcher(value) {
        if (value !== undefined && this.widget) {
            this.widget.view = value;
        }
    }
    //--------------------------------------------------------------------------
    //
    //  Methods
    //
    //--------------------------------------------------------------------------
    async blurSearch() {
        this.widget?.blur();
    }
    async clearSearch() {
        this.widget?.clear();
    }
    async focusSearch() {
        this.widget?.focus();
    }
    async search(term) {
        return await this.widget?.search(term);
    }
    async suggest(term) {
        return await this.widget?.suggest(term);
    }
    //--------------------------------------------------------------------------
    //
    //  Lifecycle
    //
    //--------------------------------------------------------------------------
    async componentDidLoad() {
        const params = this._createParams();
        const widget = await (0,_index_0bc55ca5_js__WEBPACK_IMPORTED_MODULE_1__.T)(params);
        this.widget = widget;
        await this._addWatchers();
        this._proxyEvents();
        this._addContainer();
        this.arcgisSearchReady.emit();
        (0,_component_utils_23194f7c_js__WEBPACK_IMPORTED_MODULE_2__.c)(this);
    }
    disconnectedCallback() {
        (0,_disconnected_6cf1c100_js__WEBPACK_IMPORTED_MODULE_3__.o)(this);
    }
    render() {
        return (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { ref: (el) => (this.childElem = el) });
    }
    //--------------------------------------------------------------------------
    //
    //  Private Interal Methods
    //
    //--------------------------------------------------------------------------
    _addContainer() {
        this.widget.container = this.childElem;
    }
    async _addWatchers() {
        const { watch } = await (0,_index_0bc55ca5_js__WEBPACK_IMPORTED_MODULE_1__.i)();
        (0,_component_utils_23194f7c_js__WEBPACK_IMPORTED_MODULE_2__.a)(this, watch(() => this.widget.activeSource, (value) => (this.activeSource = value), {
            initial: true,
        }));
        (0,_component_utils_23194f7c_js__WEBPACK_IMPORTED_MODULE_2__.a)(this, watch(() => this.widget.activeSourceIndex, (value) => (this.activeSourceIndex = value), {
            initial: true,
        }));
        (0,_component_utils_23194f7c_js__WEBPACK_IMPORTED_MODULE_2__.a)(this, watch(() => this.widget.allSources, (value) => (this.allSources = value), {
            initial: true,
        }));
        (0,_component_utils_23194f7c_js__WEBPACK_IMPORTED_MODULE_2__.a)(this, watch(() => this.widget.defaultSources, (value) => (this.defaultSources = value), {
            initial: true,
        }));
        (0,_component_utils_23194f7c_js__WEBPACK_IMPORTED_MODULE_2__.a)(this, watch(() => this.widget.disabled, (value) => (this.disabled = value), {
            initial: true,
        }));
        (0,_component_utils_23194f7c_js__WEBPACK_IMPORTED_MODULE_2__.a)(this, watch(() => this.widget.resultGraphic, (value) => (this.resultGraphic = value), {
            initial: true,
        }));
        (0,_component_utils_23194f7c_js__WEBPACK_IMPORTED_MODULE_2__.a)(this, watch(() => this.widget.results, (value) => (this.results = value), {
            initial: true,
        }));
        (0,_component_utils_23194f7c_js__WEBPACK_IMPORTED_MODULE_2__.a)(this, watch(() => this.widget.selectedResult, (value) => (this.selectedResult = value), {
            initial: true,
        }));
        (0,_component_utils_23194f7c_js__WEBPACK_IMPORTED_MODULE_2__.a)(this, watch(() => this.widget.suggestions, (value) => (this.suggestions = value), {
            initial: true,
        }));
    }
    _createParams() {
        const params = {};
        if (this.allPlaceholder) {
            params.allPlaceholder = this.allPlaceholder;
        }
        if (this.autoSelect !== undefined) {
            params.autoSelect = this.autoSelect;
        }
        if (this.includeDefaultSources !== undefined) {
            params.includeDefaultSources = this.includeDefaultSources;
        }
        if (this.locationEnabled !== undefined) {
            params.locationEnabled = this.locationEnabled;
        }
        if (this.maxResults !== undefined) {
            params.maxResults = this.maxResults;
        }
        if (this.maxSuggestions !== undefined) {
            params.maxSuggestions = this.maxSuggestions;
        }
        if (this.minSuggestCharacters !== undefined) {
            params.minSuggestCharacters = this.minSuggestCharacters;
        }
        if (this.popupEnabled !== undefined) {
            params.popupEnabled = this.popupEnabled;
        }
        if (this.popupTemplate) {
            params.popupTemplate = this.popupTemplate;
        }
        if (this.portal) {
            params.portal = this.portal;
        }
        if (this.resultGraphicEnabled !== undefined) {
            params.resultGraphicEnabled = this.resultGraphicEnabled;
        }
        if (this.searchAllEnabled !== undefined) {
            params.searchAllEnabled = this.searchAllEnabled;
        }
        if (this.searchTerm) {
            params.searchTerm = this.searchTerm;
        }
        if (this.sources) {
            params.sources = this.sources;
        }
        if (this.suggestionsEnabled !== undefined) {
            params.suggestionsEnabled = this.suggestionsEnabled;
        }
        if (this.view) {
            params.view = this.view;
        }
        return params;
    }
    _proxyEvents() {
        this.widget.on("search-blur", (e) => this.searchBlur.emit(e));
        this.widget.on("search-clear", (e) => this.searchClear.emit(e));
        this.widget.on("search-complete", (e) => this.searchComplete.emit(e));
        this.widget.on("search-focus", (e) => this.searchFocus.emit(e));
        this.widget.on("search-start", (e) => this.searchStart.emit(e));
        this.widget.on("select-result", (e) => this.searchSelectResult.emit(e));
        this.widget.on("suggest-complete", (e) => this.searchSuggestComplete.emit(e));
        this.widget.on("suggest-start", (e) => this.searchSuggestStart.emit(e));
    }
    get el() { return (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.g)(this); }
    static get watchers() { return {
        "referenceElement": ["referenceElementWatcher"],
        "activeMenu": ["activeMenuWatcher"],
        "activeSourceIndex": ["activeSourceIndexWatcher"],
        "allPlaceholder": ["allPlaceholderWatcher"],
        "autoSelect": ["autoSelectWatcher"],
        "disabled": ["disabledWatcher"],
        "icon": ["iconWatcher"],
        "includeDefaultSources": ["includeDefaultSourcesWatcher"],
        "locationEnabled": ["locationEnabledWatcher"],
        "maxResults": ["maxResultsWatcher"],
        "maxSuggestions": ["maxSuggestionsWatcher"],
        "minSuggestCharacters": ["minSuggestCharactersWatcher"],
        "popupEnabled": ["popupEnabledWatcher"],
        "popupTemplate": ["popupTemplateWatcher"],
        "portal": ["portalWatcher"],
        "resultGraphicEnabled": ["resultGraphicEnabledWatcher"],
        "searchAllEnabled": ["searchAllEnabledWatcher"],
        "searchTerm": ["searchTermWatcher"],
        "sources": ["sourcesWatcher"],
        "suggestionsEnabled": ["suggestionsEnabledWatcher"],
        "position": ["positionWatcher"],
        "view": ["viewWatcher"]
    }; }
};
ArcgisSearch.style = searchCss;




/***/ }),

/***/ "./node_modules/@arcgis/map-components/dist/esm/component-utils-23194f7c.js":
/*!**********************************************************************************!*\
  !*** ./node_modules/@arcgis/map-components/dist/esm/component-utils-23194f7c.js ***!
  \**********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   a: () => (/* binding */ addHandles),
/* harmony export */   b: () => (/* binding */ isNotSameViewpoint),
/* harmony export */   c: () => (/* binding */ checkForView),
/* harmony export */   d: () => (/* binding */ checkForExpand),
/* harmony export */   e: () => (/* binding */ isNotSameCamera),
/* harmony export */   f: () => (/* binding */ isNotSameEnvironment),
/* harmony export */   g: () => (/* binding */ isValidInteger),
/* harmony export */   i: () => (/* binding */ isNullOrEmptyString),
/* harmony export */   r: () => (/* binding */ referenceElementHelper)
/* harmony export */ });
/*!
 * All material copyright Esri, All Rights Reserved, unless otherwise specified.
 * See https://js.arcgis.com/4.30/esri/copyright.txt for details.
 * v4.30.0-next.37
 */
function checkForExpand(element) {
    const expandRef = element.el.closest("arcgis-expand") ?? element.expandElem;
    if (expandRef?.widget) {
        element.view = expandRef.view;
        expandRef.widget.content = element.childElem ?? element.el;
        // TODO: Update to be expandIcon = widget.icon, not ready yet in 4.27next
        if (!expandRef.expandIcon) {
            expandRef.widget.expandIcon = element.widget ? element.widget.icon : element?.icon;
        }
        return true;
    }
    if (expandRef) {
        const widgetHandler = () => {
            expandRef.removeEventListener("arcgisExpandReady", widgetHandler, false);
            element.view = expandRef.view;
            expandRef.widget.content = element.childElem ?? element.el;
            if (!expandRef.expandIcon) {
                expandRef.widget.expandIcon = element.widget ? element.widget.icon : element?.icon;
            }
        };
        expandRef.addEventListener("arcgisExpandReady", widgetHandler, false);
        return true;
    }
    return false;
}

//--------------------------------------------------------------------------
//
//  Public Methods
//
//--------------------------------------------------------------------------
function addHandles(element, handle) {
    if (Array.isArray(handle)) {
        element._watchHandles = [...element._watchHandles, ...handle];
    }
    else {
        element._watchHandles.push(handle);
    }
}
function checkForView(element) {
    let isUsingReferenceElement = false;
    if (!checkForExpand(element)) {
        let viewRef = element.el.closest("arcgis-map") ?? element.el.closest("arcgis-scene");
        if (!viewRef && typeof element.referenceElement === "string") {
            viewRef = document.querySelector(element.referenceElement);
            isUsingReferenceElement = true;
        }
        if (viewRef?.view) {
            element.view = viewRef.view;
            const el = element.childElem ?? element.el;
            if (!isUsingReferenceElement) {
                element.view.ui.add(el, element.position);
            }
        }
        else if (viewRef) {
            waitForViewHandler(viewRef, element, isUsingReferenceElement);
        }
    }
    else {
        const viewRef = element.el.closest("arcgis-map") ?? element.el.closest("arcgis-scene");
        if (viewRef?.view) {
            element.view = viewRef.view;
        }
        else if (viewRef) {
            const handler = () => {
                viewRef.removeEventListener("arcgisViewReadyChange", handler, false);
                element.view = viewRef.view;
            };
            viewRef.addEventListener("arcgisViewReadyChange", handler, false);
        }
    }
}
function isNullOrEmptyString(value) {
    return value === undefined || value === null || value === "";
}
function isValidInteger(value) {
    return value != null && value % 1 === 0;
}
function isNotSameCamera(camera, camera2) {
    return (camera2 === undefined ||
        camera.position !== camera2.position ||
        camera.heading !== camera2.heading ||
        camera.tilt !== camera2.tilt);
}
function isNotSameEnvironment(environment, environment2) {
    return (environment2 === undefined ||
        environment2.atmosphereEnabled !== environment.atmosphereEnabled ||
        environment2.lighting.date !== environment.lighting.date ||
        environment2.lighting.directShadowsEnabled !==
            environment.lighting.directShadowsEnabled ||
        environment2.lighting.cameraTrackingEnabled !==
            environment.lighting.cameraTrackingEnabled ||
        environment2.lighting.date !== environment.lighting.date ||
        environment2.lighting.displayUTCOffset !==
            environment.lighting.displayUTCOffset);
}
function isNotSameViewpoint(viewpoint, viewpoint2) {
    return (viewpoint2 === undefined ||
        viewpoint.targetGeometry !== viewpoint2.targetGeometry ||
        viewpoint.rotation !== viewpoint2.rotation ||
        viewpoint.scale !== viewpoint2.scale);
}
async function updateForView(viewStr) {
    const viewRef = document.querySelector(viewStr);
    return await new Promise((resolve) => {
        if (viewRef?.view !== undefined) {
            resolve(viewRef.view);
        }
        else if (viewRef) {
            const handler = () => {
                viewRef.removeEventListener("arcgisViewReadyChange", handler, false);
                resolve(viewRef.view);
            };
            viewRef.addEventListener("arcgisViewReadyChange", handler, false);
        }
    });
}
async function referenceElementHelper(element, refElement) {
    if (refElement === undefined)
        return;
    else if (typeof refElement === "string") {
        element.view = await updateForView(refElement);
    }
    else if (element.widget) {
        element.view = refElement.view;
    }
}
//--------------------------------------------------------------------------
//
//  Private Methods
//
//--------------------------------------------------------------------------
function waitForViewHandler(viewRef, element, isUsingRefernceElement) {
    const handler = () => {
        viewRef.removeEventListener("arcgisViewReadyChange", handler, false);
        element.view = viewRef.view;
        if (!isUsingRefernceElement) {
            element.view.ui.add(element.childElem ?? element.el, element.position);
        }
    };
    viewRef.addEventListener("arcgisViewReadyChange", handler, false);
}




/***/ }),

/***/ "./node_modules/@arcgis/map-components/dist/esm/disconnected-6cf1c100.js":
/*!*******************************************************************************!*\
  !*** ./node_modules/@arcgis/map-components/dist/esm/disconnected-6cf1c100.js ***!
  \*******************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   o: () => (/* binding */ onDisconnectedHelper)
/* harmony export */ });
/*!
 * All material copyright Esri, All Rights Reserved, unless otherwise specified.
 * See https://js.arcgis.com/4.30/esri/copyright.txt for details.
 * v4.30.0-next.37
 */
function onDisconnectedHelper(element) {
    if (element.childElem) {
        if (!element.el.isConnected) {
            if (element.view) {
                element.view.ui.remove(element.childElem);
            }
            else if (element.widget?.view) {
                element.widget.view.ui.remove(element.childElem);
            }
            if (element._watchHandles) {
                element._watchHandles.forEach((handle) => {
                    handle.remove();
                });
            }
            element._watchHandles = [];
            element.widget?.destroy();
        }
    }
    else {
        setTimeout(() => {
            if (!element.el.isConnected) {
                if (element.view) {
                    element.view.ui.remove(element.el);
                }
                else if (element.widget?.view) {
                    element.widget.view.ui.remove(element.el);
                }
                if (element._watchHandles) {
                    element._watchHandles.forEach((handle) => {
                        handle.remove();
                    });
                }
                element._watchHandles = [];
                element.widget?.destroy();
            }
        }, 1000);
    }
}




/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2lkZ2V0cy9jaHVua3MvdmVuZG9ycy1ub2RlX21vZHVsZXNfYXJjZ2lzX21hcC1jb21wb25lbnRzX2Rpc3RfZXNtX2FyY2dpcy1zZWFyY2hfZW50cnlfanMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ2tHO0FBQ1I7QUFDc0I7QUFDekM7O0FBRXZFOztBQUVBO0FBQ0E7QUFDQSxRQUFRLHFEQUFnQjtBQUN4QixpQ0FBaUMscURBQVc7QUFDNUMsMEJBQTBCLHFEQUFXO0FBQ3JDLDJCQUEyQixxREFBVztBQUN0Qyw4QkFBOEIscURBQVc7QUFDekMsMkJBQTJCLHFEQUFXO0FBQ3RDLDJCQUEyQixxREFBVztBQUN0QyxrQ0FBa0MscURBQVc7QUFDN0MscUNBQXFDLHFEQUFXO0FBQ2hELGtDQUFrQyxxREFBVztBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLCtEQUFzQjtBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QixxREFBZ0I7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsK0RBQVk7QUFDcEI7QUFDQTtBQUNBLFFBQVEsNERBQW9CO0FBQzVCO0FBQ0E7QUFDQSxlQUFlLHFEQUFDLFVBQVUsb0NBQW9DO0FBQzlEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLFFBQVEsUUFBUSxxREFBdUI7QUFDdkQsUUFBUSwrREFBVTtBQUNsQjtBQUNBLFNBQVM7QUFDVCxRQUFRLCtEQUFVO0FBQ2xCO0FBQ0EsU0FBUztBQUNULFFBQVEsK0RBQVU7QUFDbEI7QUFDQSxTQUFTO0FBQ1QsUUFBUSwrREFBVTtBQUNsQjtBQUNBLFNBQVM7QUFDVCxRQUFRLCtEQUFVO0FBQ2xCO0FBQ0EsU0FBUztBQUNULFFBQVEsK0RBQVU7QUFDbEI7QUFDQSxTQUFTO0FBQ1QsUUFBUSwrREFBVTtBQUNsQjtBQUNBLFNBQVM7QUFDVCxRQUFRLCtEQUFVO0FBQ2xCO0FBQ0EsU0FBUztBQUNULFFBQVEsK0RBQVU7QUFDbEI7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxPQUFPLHFEQUFVO0FBQ2hDLDRCQUE0QjtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFeUM7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDN1V6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUV5Tjs7Ozs7Ozs7Ozs7Ozs7O0FDcEp6TjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTs7QUFFcUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vbm9kZV9tb2R1bGVzL0BhcmNnaXMvbWFwLWNvbXBvbmVudHMvZGlzdC9lc20vYXJjZ2lzLXNlYXJjaC5lbnRyeS5qcyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vbm9kZV9tb2R1bGVzL0BhcmNnaXMvbWFwLWNvbXBvbmVudHMvZGlzdC9lc20vY29tcG9uZW50LXV0aWxzLTIzMTk0ZjdjLmpzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9ub2RlX21vZHVsZXMvQGFyY2dpcy9tYXAtY29tcG9uZW50cy9kaXN0L2VzbS9kaXNjb25uZWN0ZWQtNmNmMWMxMDAuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyohXG4gKiBBbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVzcmksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuICogU2VlIGh0dHBzOi8vanMuYXJjZ2lzLmNvbS80LjMwL2VzcmkvY29weXJpZ2h0LnR4dCBmb3IgZGV0YWlscy5cbiAqIHY0LjMwLjAtbmV4dC4zN1xuICovXG5pbXBvcnQgeyByIGFzIHJlZ2lzdGVySW5zdGFuY2UsIGMgYXMgY3JlYXRlRXZlbnQsIGgsIGcgYXMgZ2V0RWxlbWVudCB9IGZyb20gJy4vaW5kZXgtNmUxNzJhYWMuanMnO1xuaW1wb3J0IHsgVCBhcyBuZXdXaWRnZXRzU2VhcmNoLCBpIGFzIGltcG9ydENvcmVSZWFjdGl2ZVV0aWxzIH0gZnJvbSAnLi9pbmRleC0wYmM1NWNhNS5qcyc7XG5pbXBvcnQgeyByIGFzIHJlZmVyZW5jZUVsZW1lbnRIZWxwZXIsIGMgYXMgY2hlY2tGb3JWaWV3LCBhIGFzIGFkZEhhbmRsZXMgfSBmcm9tICcuL2NvbXBvbmVudC11dGlscy0yMzE5NGY3Yy5qcyc7XG5pbXBvcnQgeyBvIGFzIG9uRGlzY29ubmVjdGVkSGVscGVyIH0gZnJvbSAnLi9kaXNjb25uZWN0ZWQtNmNmMWMxMDAuanMnO1xuXG5jb25zdCBzZWFyY2hDc3MgPSBcIlwiO1xuXG5jb25zdCBBcmNnaXNTZWFyY2ggPSBjbGFzcyB7XG4gICAgY29uc3RydWN0b3IoaG9zdFJlZikge1xuICAgICAgICByZWdpc3Rlckluc3RhbmNlKHRoaXMsIGhvc3RSZWYpO1xuICAgICAgICB0aGlzLmFyY2dpc1NlYXJjaFJlYWR5ID0gY3JlYXRlRXZlbnQodGhpcywgXCJhcmNnaXNTZWFyY2hSZWFkeVwiLCA3KTtcbiAgICAgICAgdGhpcy5zZWFyY2hCbHVyID0gY3JlYXRlRXZlbnQodGhpcywgXCJzZWFyY2hCbHVyXCIsIDcpO1xuICAgICAgICB0aGlzLnNlYXJjaENsZWFyID0gY3JlYXRlRXZlbnQodGhpcywgXCJzZWFyY2hDbGVhclwiLCA3KTtcbiAgICAgICAgdGhpcy5zZWFyY2hDb21wbGV0ZSA9IGNyZWF0ZUV2ZW50KHRoaXMsIFwic2VhcmNoQ29tcGxldGVcIiwgNyk7XG4gICAgICAgIHRoaXMuc2VhcmNoRm9jdXMgPSBjcmVhdGVFdmVudCh0aGlzLCBcInNlYXJjaEZvY3VzXCIsIDcpO1xuICAgICAgICB0aGlzLnNlYXJjaFN0YXJ0ID0gY3JlYXRlRXZlbnQodGhpcywgXCJzZWFyY2hTdGFydFwiLCA3KTtcbiAgICAgICAgdGhpcy5zZWFyY2hTZWxlY3RSZXN1bHQgPSBjcmVhdGVFdmVudCh0aGlzLCBcInNlYXJjaFNlbGVjdFJlc3VsdFwiLCA3KTtcbiAgICAgICAgdGhpcy5zZWFyY2hTdWdnZXN0Q29tcGxldGUgPSBjcmVhdGVFdmVudCh0aGlzLCBcInNlYXJjaFN1Z2dlc3RDb21wbGV0ZVwiLCA3KTtcbiAgICAgICAgdGhpcy5zZWFyY2hTdWdnZXN0U3RhcnQgPSBjcmVhdGVFdmVudCh0aGlzLCBcInNlYXJjaFN1Z2dlc3RTdGFydFwiLCA3KTtcbiAgICAgICAgdGhpcy5fd2F0Y2hIYW5kbGVzID0gW107XG4gICAgICAgIHRoaXMucmVmZXJlbmNlRWxlbWVudCA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5hY3RpdmVNZW51ID0gXCJub25lXCI7XG4gICAgICAgIHRoaXMuYWN0aXZlU291cmNlID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLmFjdGl2ZVNvdXJjZUluZGV4ID0gMDtcbiAgICAgICAgdGhpcy5hbGxQbGFjZWhvbGRlciA9IFwiRmluZCBhZGRyZXNzIG9yIHBsYWNlXCI7XG4gICAgICAgIHRoaXMuYWxsU291cmNlcyA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5hdXRvU2VsZWN0ID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5kZWZhdWx0U291cmNlcyA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5kaXNhYmxlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLmljb24gPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuaW5jbHVkZURlZmF1bHRTb3VyY2VzID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5sb2NhdGlvbkVuYWJsZWQgPSB0cnVlO1xuICAgICAgICB0aGlzLm1heFJlc3VsdHMgPSA2O1xuICAgICAgICB0aGlzLm1heFN1Z2dlc3Rpb25zID0gNjtcbiAgICAgICAgdGhpcy5taW5TdWdnZXN0Q2hhcmFjdGVycyA9IDM7XG4gICAgICAgIHRoaXMucG9wdXBFbmFibGVkID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5wb3B1cFRlbXBsYXRlID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLnBvcnRhbCA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5yZXN1bHRHcmFwaGljID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLnJlc3VsdEdyYXBoaWNFbmFibGVkID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5yZXN1bHRzID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLnNlYXJjaEFsbEVuYWJsZWQgPSB0cnVlO1xuICAgICAgICB0aGlzLnNlYXJjaFRlcm0gPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuc2VsZWN0ZWRSZXN1bHQgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuc291cmNlcyA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5zdWdnZXN0aW9ucyA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5zdWdnZXN0aW9uc0VuYWJsZWQgPSB0cnVlO1xuICAgICAgICB0aGlzLnBvc2l0aW9uID0gXCJ0b3AtcmlnaHRcIjtcbiAgICAgICAgdGhpcy52aWV3ID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLndpZGdldCA9IHVuZGVmaW5lZDtcbiAgICB9XG4gICAgcmVmZXJlbmNlRWxlbWVudFdhdGNoZXIodmFsdWUpIHtcbiAgICAgICAgdm9pZCByZWZlcmVuY2VFbGVtZW50SGVscGVyKHRoaXMsIHZhbHVlKTtcbiAgICB9XG4gICAgYWN0aXZlTWVudVdhdGNoZXIodmFsdWUpIHtcbiAgICAgICAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQgJiYgdGhpcy53aWRnZXQpIHtcbiAgICAgICAgICAgIHRoaXMud2lkZ2V0LmFjdGl2ZU1lbnUgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBhY3RpdmVTb3VyY2VJbmRleFdhdGNoZXIodmFsdWUpIHtcbiAgICAgICAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQgJiYgdGhpcy53aWRnZXQpIHtcbiAgICAgICAgICAgIHRoaXMud2lkZ2V0LmFjdGl2ZVNvdXJjZUluZGV4ID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgYWxsUGxhY2Vob2xkZXJXYXRjaGVyKHZhbHVlKSB7XG4gICAgICAgIGlmICh0aGlzLndpZGdldCkge1xuICAgICAgICAgICAgdGhpcy53aWRnZXQuYWxsUGxhY2Vob2xkZXIgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBhdXRvU2VsZWN0V2F0Y2hlcih2YWx1ZSkge1xuICAgICAgICBpZiAodmFsdWUgIT09IHVuZGVmaW5lZCAmJiB0aGlzLndpZGdldCkge1xuICAgICAgICAgICAgdGhpcy53aWRnZXQuYXV0b1NlbGVjdCA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGRpc2FibGVkV2F0Y2hlcih2YWx1ZSwgb2xkKSB7XG4gICAgICAgIGlmICh0aGlzLndpZGdldCAmJiB2YWx1ZSAhPT0gb2xkKSB7XG4gICAgICAgICAgICB0aGlzLndpZGdldC5kaXNhYmxlZCA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGljb25XYXRjaGVyKHZhbHVlKSB7XG4gICAgICAgIGlmICh0aGlzLndpZGdldCkge1xuICAgICAgICAgICAgdGhpcy53aWRnZXQuaWNvbiA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGluY2x1ZGVEZWZhdWx0U291cmNlc1dhdGNoZXIodmFsdWUpIHtcbiAgICAgICAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQgJiYgdGhpcy53aWRnZXQpIHtcbiAgICAgICAgICAgIHRoaXMud2lkZ2V0LmluY2x1ZGVEZWZhdWx0U291cmNlcyA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGxvY2F0aW9uRW5hYmxlZFdhdGNoZXIodmFsdWUpIHtcbiAgICAgICAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQgJiYgdGhpcy53aWRnZXQpIHtcbiAgICAgICAgICAgIHRoaXMud2lkZ2V0LmxvY2F0aW9uRW5hYmxlZCA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIG1heFJlc3VsdHNXYXRjaGVyKHZhbHVlKSB7XG4gICAgICAgIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkICYmIHRoaXMud2lkZ2V0KSB7XG4gICAgICAgICAgICB0aGlzLndpZGdldC5tYXhSZXN1bHRzID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgbWF4U3VnZ2VzdGlvbnNXYXRjaGVyKHZhbHVlKSB7XG4gICAgICAgIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkICYmIHRoaXMud2lkZ2V0KSB7XG4gICAgICAgICAgICB0aGlzLndpZGdldC5tYXhTdWdnZXN0aW9ucyA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIG1pblN1Z2dlc3RDaGFyYWN0ZXJzV2F0Y2hlcih2YWx1ZSkge1xuICAgICAgICBpZiAodmFsdWUgIT09IHVuZGVmaW5lZCAmJiB0aGlzLndpZGdldCkge1xuICAgICAgICAgICAgdGhpcy53aWRnZXQubWluU3VnZ2VzdENoYXJhY3RlcnMgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBwb3B1cEVuYWJsZWRXYXRjaGVyKHZhbHVlKSB7XG4gICAgICAgIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkICYmIHRoaXMud2lkZ2V0KSB7XG4gICAgICAgICAgICB0aGlzLndpZGdldC5wb3B1cEVuYWJsZWQgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBwb3B1cFRlbXBsYXRlV2F0Y2hlcih2YWx1ZSkge1xuICAgICAgICBpZiAodGhpcy53aWRnZXQpIHtcbiAgICAgICAgICAgIHRoaXMud2lkZ2V0LnBvcHVwVGVtcGxhdGUgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBwb3J0YWxXYXRjaGVyKHZhbHVlKSB7XG4gICAgICAgIGlmICh0aGlzLndpZGdldCkge1xuICAgICAgICAgICAgdGhpcy53aWRnZXQucG9ydGFsID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmVzdWx0R3JhcGhpY0VuYWJsZWRXYXRjaGVyKHZhbHVlKSB7XG4gICAgICAgIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkICYmIHRoaXMud2lkZ2V0KSB7XG4gICAgICAgICAgICB0aGlzLndpZGdldC5yZXN1bHRHcmFwaGljRW5hYmxlZCA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHNlYXJjaEFsbEVuYWJsZWRXYXRjaGVyKHZhbHVlKSB7XG4gICAgICAgIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkICYmIHRoaXMud2lkZ2V0KSB7XG4gICAgICAgICAgICB0aGlzLndpZGdldC5zZWFyY2hBbGxFbmFibGVkID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc2VhcmNoVGVybVdhdGNoZXIodmFsdWUpIHtcbiAgICAgICAgaWYgKHRoaXMud2lkZ2V0KSB7XG4gICAgICAgICAgICB0aGlzLndpZGdldC5zZWFyY2hUZXJtID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc291cmNlc1dhdGNoZXIodmFsdWUpIHtcbiAgICAgICAgaWYgKHRoaXMud2lkZ2V0KSB7XG4gICAgICAgICAgICB0aGlzLndpZGdldC5zb3VyY2VzID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3VnZ2VzdGlvbnNFbmFibGVkV2F0Y2hlcih2YWx1ZSkge1xuICAgICAgICBpZiAodmFsdWUgIT09IHVuZGVmaW5lZCAmJiB0aGlzLndpZGdldCkge1xuICAgICAgICAgICAgdGhpcy53aWRnZXQuc3VnZ2VzdGlvbnNFbmFibGVkID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcG9zaXRpb25XYXRjaGVyKHZhbHVlKSB7XG4gICAgICAgIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkICYmIHRoaXMud2lkZ2V0KSB7XG4gICAgICAgICAgICB0aGlzLnZpZXcudWkubW92ZSh0aGlzLmNoaWxkRWxlbSwgdmFsdWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHZpZXdXYXRjaGVyKHZhbHVlKSB7XG4gICAgICAgIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkICYmIHRoaXMud2lkZ2V0KSB7XG4gICAgICAgICAgICB0aGlzLndpZGdldC52aWV3ID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vXG4gICAgLy8gIE1ldGhvZHNcbiAgICAvL1xuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICBhc3luYyBibHVyU2VhcmNoKCkge1xuICAgICAgICB0aGlzLndpZGdldD8uYmx1cigpO1xuICAgIH1cbiAgICBhc3luYyBjbGVhclNlYXJjaCgpIHtcbiAgICAgICAgdGhpcy53aWRnZXQ/LmNsZWFyKCk7XG4gICAgfVxuICAgIGFzeW5jIGZvY3VzU2VhcmNoKCkge1xuICAgICAgICB0aGlzLndpZGdldD8uZm9jdXMoKTtcbiAgICB9XG4gICAgYXN5bmMgc2VhcmNoKHRlcm0pIHtcbiAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMud2lkZ2V0Py5zZWFyY2godGVybSk7XG4gICAgfVxuICAgIGFzeW5jIHN1Z2dlc3QodGVybSkge1xuICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy53aWRnZXQ/LnN1Z2dlc3QodGVybSk7XG4gICAgfVxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvL1xuICAgIC8vICBMaWZlY3ljbGVcbiAgICAvL1xuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICBhc3luYyBjb21wb25lbnREaWRMb2FkKCkge1xuICAgICAgICBjb25zdCBwYXJhbXMgPSB0aGlzLl9jcmVhdGVQYXJhbXMoKTtcbiAgICAgICAgY29uc3Qgd2lkZ2V0ID0gYXdhaXQgbmV3V2lkZ2V0c1NlYXJjaChwYXJhbXMpO1xuICAgICAgICB0aGlzLndpZGdldCA9IHdpZGdldDtcbiAgICAgICAgYXdhaXQgdGhpcy5fYWRkV2F0Y2hlcnMoKTtcbiAgICAgICAgdGhpcy5fcHJveHlFdmVudHMoKTtcbiAgICAgICAgdGhpcy5fYWRkQ29udGFpbmVyKCk7XG4gICAgICAgIHRoaXMuYXJjZ2lzU2VhcmNoUmVhZHkuZW1pdCgpO1xuICAgICAgICBjaGVja0ZvclZpZXcodGhpcyk7XG4gICAgfVxuICAgIGRpc2Nvbm5lY3RlZENhbGxiYWNrKCkge1xuICAgICAgICBvbkRpc2Nvbm5lY3RlZEhlbHBlcih0aGlzKTtcbiAgICB9XG4gICAgcmVuZGVyKCkge1xuICAgICAgICByZXR1cm4gaChcImRpdlwiLCB7IHJlZjogKGVsKSA9PiAodGhpcy5jaGlsZEVsZW0gPSBlbCkgfSk7XG4gICAgfVxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvL1xuICAgIC8vICBQcml2YXRlIEludGVyYWwgTWV0aG9kc1xuICAgIC8vXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIF9hZGRDb250YWluZXIoKSB7XG4gICAgICAgIHRoaXMud2lkZ2V0LmNvbnRhaW5lciA9IHRoaXMuY2hpbGRFbGVtO1xuICAgIH1cbiAgICBhc3luYyBfYWRkV2F0Y2hlcnMoKSB7XG4gICAgICAgIGNvbnN0IHsgd2F0Y2ggfSA9IGF3YWl0IGltcG9ydENvcmVSZWFjdGl2ZVV0aWxzKCk7XG4gICAgICAgIGFkZEhhbmRsZXModGhpcywgd2F0Y2goKCkgPT4gdGhpcy53aWRnZXQuYWN0aXZlU291cmNlLCAodmFsdWUpID0+ICh0aGlzLmFjdGl2ZVNvdXJjZSA9IHZhbHVlKSwge1xuICAgICAgICAgICAgaW5pdGlhbDogdHJ1ZSxcbiAgICAgICAgfSkpO1xuICAgICAgICBhZGRIYW5kbGVzKHRoaXMsIHdhdGNoKCgpID0+IHRoaXMud2lkZ2V0LmFjdGl2ZVNvdXJjZUluZGV4LCAodmFsdWUpID0+ICh0aGlzLmFjdGl2ZVNvdXJjZUluZGV4ID0gdmFsdWUpLCB7XG4gICAgICAgICAgICBpbml0aWFsOiB0cnVlLFxuICAgICAgICB9KSk7XG4gICAgICAgIGFkZEhhbmRsZXModGhpcywgd2F0Y2goKCkgPT4gdGhpcy53aWRnZXQuYWxsU291cmNlcywgKHZhbHVlKSA9PiAodGhpcy5hbGxTb3VyY2VzID0gdmFsdWUpLCB7XG4gICAgICAgICAgICBpbml0aWFsOiB0cnVlLFxuICAgICAgICB9KSk7XG4gICAgICAgIGFkZEhhbmRsZXModGhpcywgd2F0Y2goKCkgPT4gdGhpcy53aWRnZXQuZGVmYXVsdFNvdXJjZXMsICh2YWx1ZSkgPT4gKHRoaXMuZGVmYXVsdFNvdXJjZXMgPSB2YWx1ZSksIHtcbiAgICAgICAgICAgIGluaXRpYWw6IHRydWUsXG4gICAgICAgIH0pKTtcbiAgICAgICAgYWRkSGFuZGxlcyh0aGlzLCB3YXRjaCgoKSA9PiB0aGlzLndpZGdldC5kaXNhYmxlZCwgKHZhbHVlKSA9PiAodGhpcy5kaXNhYmxlZCA9IHZhbHVlKSwge1xuICAgICAgICAgICAgaW5pdGlhbDogdHJ1ZSxcbiAgICAgICAgfSkpO1xuICAgICAgICBhZGRIYW5kbGVzKHRoaXMsIHdhdGNoKCgpID0+IHRoaXMud2lkZ2V0LnJlc3VsdEdyYXBoaWMsICh2YWx1ZSkgPT4gKHRoaXMucmVzdWx0R3JhcGhpYyA9IHZhbHVlKSwge1xuICAgICAgICAgICAgaW5pdGlhbDogdHJ1ZSxcbiAgICAgICAgfSkpO1xuICAgICAgICBhZGRIYW5kbGVzKHRoaXMsIHdhdGNoKCgpID0+IHRoaXMud2lkZ2V0LnJlc3VsdHMsICh2YWx1ZSkgPT4gKHRoaXMucmVzdWx0cyA9IHZhbHVlKSwge1xuICAgICAgICAgICAgaW5pdGlhbDogdHJ1ZSxcbiAgICAgICAgfSkpO1xuICAgICAgICBhZGRIYW5kbGVzKHRoaXMsIHdhdGNoKCgpID0+IHRoaXMud2lkZ2V0LnNlbGVjdGVkUmVzdWx0LCAodmFsdWUpID0+ICh0aGlzLnNlbGVjdGVkUmVzdWx0ID0gdmFsdWUpLCB7XG4gICAgICAgICAgICBpbml0aWFsOiB0cnVlLFxuICAgICAgICB9KSk7XG4gICAgICAgIGFkZEhhbmRsZXModGhpcywgd2F0Y2goKCkgPT4gdGhpcy53aWRnZXQuc3VnZ2VzdGlvbnMsICh2YWx1ZSkgPT4gKHRoaXMuc3VnZ2VzdGlvbnMgPSB2YWx1ZSksIHtcbiAgICAgICAgICAgIGluaXRpYWw6IHRydWUsXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgX2NyZWF0ZVBhcmFtcygpIHtcbiAgICAgICAgY29uc3QgcGFyYW1zID0ge307XG4gICAgICAgIGlmICh0aGlzLmFsbFBsYWNlaG9sZGVyKSB7XG4gICAgICAgICAgICBwYXJhbXMuYWxsUGxhY2Vob2xkZXIgPSB0aGlzLmFsbFBsYWNlaG9sZGVyO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmF1dG9TZWxlY3QgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcGFyYW1zLmF1dG9TZWxlY3QgPSB0aGlzLmF1dG9TZWxlY3Q7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuaW5jbHVkZURlZmF1bHRTb3VyY2VzICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHBhcmFtcy5pbmNsdWRlRGVmYXVsdFNvdXJjZXMgPSB0aGlzLmluY2x1ZGVEZWZhdWx0U291cmNlcztcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5sb2NhdGlvbkVuYWJsZWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcGFyYW1zLmxvY2F0aW9uRW5hYmxlZCA9IHRoaXMubG9jYXRpb25FbmFibGVkO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm1heFJlc3VsdHMgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcGFyYW1zLm1heFJlc3VsdHMgPSB0aGlzLm1heFJlc3VsdHM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubWF4U3VnZ2VzdGlvbnMgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcGFyYW1zLm1heFN1Z2dlc3Rpb25zID0gdGhpcy5tYXhTdWdnZXN0aW9ucztcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5taW5TdWdnZXN0Q2hhcmFjdGVycyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBwYXJhbXMubWluU3VnZ2VzdENoYXJhY3RlcnMgPSB0aGlzLm1pblN1Z2dlc3RDaGFyYWN0ZXJzO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnBvcHVwRW5hYmxlZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBwYXJhbXMucG9wdXBFbmFibGVkID0gdGhpcy5wb3B1cEVuYWJsZWQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucG9wdXBUZW1wbGF0ZSkge1xuICAgICAgICAgICAgcGFyYW1zLnBvcHVwVGVtcGxhdGUgPSB0aGlzLnBvcHVwVGVtcGxhdGU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucG9ydGFsKSB7XG4gICAgICAgICAgICBwYXJhbXMucG9ydGFsID0gdGhpcy5wb3J0YWw7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucmVzdWx0R3JhcGhpY0VuYWJsZWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcGFyYW1zLnJlc3VsdEdyYXBoaWNFbmFibGVkID0gdGhpcy5yZXN1bHRHcmFwaGljRW5hYmxlZDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5zZWFyY2hBbGxFbmFibGVkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHBhcmFtcy5zZWFyY2hBbGxFbmFibGVkID0gdGhpcy5zZWFyY2hBbGxFbmFibGVkO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnNlYXJjaFRlcm0pIHtcbiAgICAgICAgICAgIHBhcmFtcy5zZWFyY2hUZXJtID0gdGhpcy5zZWFyY2hUZXJtO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnNvdXJjZXMpIHtcbiAgICAgICAgICAgIHBhcmFtcy5zb3VyY2VzID0gdGhpcy5zb3VyY2VzO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnN1Z2dlc3Rpb25zRW5hYmxlZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBwYXJhbXMuc3VnZ2VzdGlvbnNFbmFibGVkID0gdGhpcy5zdWdnZXN0aW9uc0VuYWJsZWQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMudmlldykge1xuICAgICAgICAgICAgcGFyYW1zLnZpZXcgPSB0aGlzLnZpZXc7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHBhcmFtcztcbiAgICB9XG4gICAgX3Byb3h5RXZlbnRzKCkge1xuICAgICAgICB0aGlzLndpZGdldC5vbihcInNlYXJjaC1ibHVyXCIsIChlKSA9PiB0aGlzLnNlYXJjaEJsdXIuZW1pdChlKSk7XG4gICAgICAgIHRoaXMud2lkZ2V0Lm9uKFwic2VhcmNoLWNsZWFyXCIsIChlKSA9PiB0aGlzLnNlYXJjaENsZWFyLmVtaXQoZSkpO1xuICAgICAgICB0aGlzLndpZGdldC5vbihcInNlYXJjaC1jb21wbGV0ZVwiLCAoZSkgPT4gdGhpcy5zZWFyY2hDb21wbGV0ZS5lbWl0KGUpKTtcbiAgICAgICAgdGhpcy53aWRnZXQub24oXCJzZWFyY2gtZm9jdXNcIiwgKGUpID0+IHRoaXMuc2VhcmNoRm9jdXMuZW1pdChlKSk7XG4gICAgICAgIHRoaXMud2lkZ2V0Lm9uKFwic2VhcmNoLXN0YXJ0XCIsIChlKSA9PiB0aGlzLnNlYXJjaFN0YXJ0LmVtaXQoZSkpO1xuICAgICAgICB0aGlzLndpZGdldC5vbihcInNlbGVjdC1yZXN1bHRcIiwgKGUpID0+IHRoaXMuc2VhcmNoU2VsZWN0UmVzdWx0LmVtaXQoZSkpO1xuICAgICAgICB0aGlzLndpZGdldC5vbihcInN1Z2dlc3QtY29tcGxldGVcIiwgKGUpID0+IHRoaXMuc2VhcmNoU3VnZ2VzdENvbXBsZXRlLmVtaXQoZSkpO1xuICAgICAgICB0aGlzLndpZGdldC5vbihcInN1Z2dlc3Qtc3RhcnRcIiwgKGUpID0+IHRoaXMuc2VhcmNoU3VnZ2VzdFN0YXJ0LmVtaXQoZSkpO1xuICAgIH1cbiAgICBnZXQgZWwoKSB7IHJldHVybiBnZXRFbGVtZW50KHRoaXMpOyB9XG4gICAgc3RhdGljIGdldCB3YXRjaGVycygpIHsgcmV0dXJuIHtcbiAgICAgICAgXCJyZWZlcmVuY2VFbGVtZW50XCI6IFtcInJlZmVyZW5jZUVsZW1lbnRXYXRjaGVyXCJdLFxuICAgICAgICBcImFjdGl2ZU1lbnVcIjogW1wiYWN0aXZlTWVudVdhdGNoZXJcIl0sXG4gICAgICAgIFwiYWN0aXZlU291cmNlSW5kZXhcIjogW1wiYWN0aXZlU291cmNlSW5kZXhXYXRjaGVyXCJdLFxuICAgICAgICBcImFsbFBsYWNlaG9sZGVyXCI6IFtcImFsbFBsYWNlaG9sZGVyV2F0Y2hlclwiXSxcbiAgICAgICAgXCJhdXRvU2VsZWN0XCI6IFtcImF1dG9TZWxlY3RXYXRjaGVyXCJdLFxuICAgICAgICBcImRpc2FibGVkXCI6IFtcImRpc2FibGVkV2F0Y2hlclwiXSxcbiAgICAgICAgXCJpY29uXCI6IFtcImljb25XYXRjaGVyXCJdLFxuICAgICAgICBcImluY2x1ZGVEZWZhdWx0U291cmNlc1wiOiBbXCJpbmNsdWRlRGVmYXVsdFNvdXJjZXNXYXRjaGVyXCJdLFxuICAgICAgICBcImxvY2F0aW9uRW5hYmxlZFwiOiBbXCJsb2NhdGlvbkVuYWJsZWRXYXRjaGVyXCJdLFxuICAgICAgICBcIm1heFJlc3VsdHNcIjogW1wibWF4UmVzdWx0c1dhdGNoZXJcIl0sXG4gICAgICAgIFwibWF4U3VnZ2VzdGlvbnNcIjogW1wibWF4U3VnZ2VzdGlvbnNXYXRjaGVyXCJdLFxuICAgICAgICBcIm1pblN1Z2dlc3RDaGFyYWN0ZXJzXCI6IFtcIm1pblN1Z2dlc3RDaGFyYWN0ZXJzV2F0Y2hlclwiXSxcbiAgICAgICAgXCJwb3B1cEVuYWJsZWRcIjogW1wicG9wdXBFbmFibGVkV2F0Y2hlclwiXSxcbiAgICAgICAgXCJwb3B1cFRlbXBsYXRlXCI6IFtcInBvcHVwVGVtcGxhdGVXYXRjaGVyXCJdLFxuICAgICAgICBcInBvcnRhbFwiOiBbXCJwb3J0YWxXYXRjaGVyXCJdLFxuICAgICAgICBcInJlc3VsdEdyYXBoaWNFbmFibGVkXCI6IFtcInJlc3VsdEdyYXBoaWNFbmFibGVkV2F0Y2hlclwiXSxcbiAgICAgICAgXCJzZWFyY2hBbGxFbmFibGVkXCI6IFtcInNlYXJjaEFsbEVuYWJsZWRXYXRjaGVyXCJdLFxuICAgICAgICBcInNlYXJjaFRlcm1cIjogW1wic2VhcmNoVGVybVdhdGNoZXJcIl0sXG4gICAgICAgIFwic291cmNlc1wiOiBbXCJzb3VyY2VzV2F0Y2hlclwiXSxcbiAgICAgICAgXCJzdWdnZXN0aW9uc0VuYWJsZWRcIjogW1wic3VnZ2VzdGlvbnNFbmFibGVkV2F0Y2hlclwiXSxcbiAgICAgICAgXCJwb3NpdGlvblwiOiBbXCJwb3NpdGlvbldhdGNoZXJcIl0sXG4gICAgICAgIFwidmlld1wiOiBbXCJ2aWV3V2F0Y2hlclwiXVxuICAgIH07IH1cbn07XG5BcmNnaXNTZWFyY2guc3R5bGUgPSBzZWFyY2hDc3M7XG5cbmV4cG9ydCB7IEFyY2dpc1NlYXJjaCBhcyBhcmNnaXNfc2VhcmNoIH07XG4iLCIvKiFcbiAqIEFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRXNyaSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG4gKiBTZWUgaHR0cHM6Ly9qcy5hcmNnaXMuY29tLzQuMzAvZXNyaS9jb3B5cmlnaHQudHh0IGZvciBkZXRhaWxzLlxuICogdjQuMzAuMC1uZXh0LjM3XG4gKi9cbmZ1bmN0aW9uIGNoZWNrRm9yRXhwYW5kKGVsZW1lbnQpIHtcbiAgICBjb25zdCBleHBhbmRSZWYgPSBlbGVtZW50LmVsLmNsb3Nlc3QoXCJhcmNnaXMtZXhwYW5kXCIpID8/IGVsZW1lbnQuZXhwYW5kRWxlbTtcbiAgICBpZiAoZXhwYW5kUmVmPy53aWRnZXQpIHtcbiAgICAgICAgZWxlbWVudC52aWV3ID0gZXhwYW5kUmVmLnZpZXc7XG4gICAgICAgIGV4cGFuZFJlZi53aWRnZXQuY29udGVudCA9IGVsZW1lbnQuY2hpbGRFbGVtID8/IGVsZW1lbnQuZWw7XG4gICAgICAgIC8vIFRPRE86IFVwZGF0ZSB0byBiZSBleHBhbmRJY29uID0gd2lkZ2V0Lmljb24sIG5vdCByZWFkeSB5ZXQgaW4gNC4yN25leHRcbiAgICAgICAgaWYgKCFleHBhbmRSZWYuZXhwYW5kSWNvbikge1xuICAgICAgICAgICAgZXhwYW5kUmVmLndpZGdldC5leHBhbmRJY29uID0gZWxlbWVudC53aWRnZXQgPyBlbGVtZW50LndpZGdldC5pY29uIDogZWxlbWVudD8uaWNvbjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgaWYgKGV4cGFuZFJlZikge1xuICAgICAgICBjb25zdCB3aWRnZXRIYW5kbGVyID0gKCkgPT4ge1xuICAgICAgICAgICAgZXhwYW5kUmVmLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJhcmNnaXNFeHBhbmRSZWFkeVwiLCB3aWRnZXRIYW5kbGVyLCBmYWxzZSk7XG4gICAgICAgICAgICBlbGVtZW50LnZpZXcgPSBleHBhbmRSZWYudmlldztcbiAgICAgICAgICAgIGV4cGFuZFJlZi53aWRnZXQuY29udGVudCA9IGVsZW1lbnQuY2hpbGRFbGVtID8/IGVsZW1lbnQuZWw7XG4gICAgICAgICAgICBpZiAoIWV4cGFuZFJlZi5leHBhbmRJY29uKSB7XG4gICAgICAgICAgICAgICAgZXhwYW5kUmVmLndpZGdldC5leHBhbmRJY29uID0gZWxlbWVudC53aWRnZXQgPyBlbGVtZW50LndpZGdldC5pY29uIDogZWxlbWVudD8uaWNvbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgZXhwYW5kUmVmLmFkZEV2ZW50TGlzdGVuZXIoXCJhcmNnaXNFeHBhbmRSZWFkeVwiLCB3aWRnZXRIYW5kbGVyLCBmYWxzZSk7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG59XG5cbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vXG4vLyAgUHVibGljIE1ldGhvZHNcbi8vXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5mdW5jdGlvbiBhZGRIYW5kbGVzKGVsZW1lbnQsIGhhbmRsZSkge1xuICAgIGlmIChBcnJheS5pc0FycmF5KGhhbmRsZSkpIHtcbiAgICAgICAgZWxlbWVudC5fd2F0Y2hIYW5kbGVzID0gWy4uLmVsZW1lbnQuX3dhdGNoSGFuZGxlcywgLi4uaGFuZGxlXTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGVsZW1lbnQuX3dhdGNoSGFuZGxlcy5wdXNoKGhhbmRsZSk7XG4gICAgfVxufVxuZnVuY3Rpb24gY2hlY2tGb3JWaWV3KGVsZW1lbnQpIHtcbiAgICBsZXQgaXNVc2luZ1JlZmVyZW5jZUVsZW1lbnQgPSBmYWxzZTtcbiAgICBpZiAoIWNoZWNrRm9yRXhwYW5kKGVsZW1lbnQpKSB7XG4gICAgICAgIGxldCB2aWV3UmVmID0gZWxlbWVudC5lbC5jbG9zZXN0KFwiYXJjZ2lzLW1hcFwiKSA/PyBlbGVtZW50LmVsLmNsb3Nlc3QoXCJhcmNnaXMtc2NlbmVcIik7XG4gICAgICAgIGlmICghdmlld1JlZiAmJiB0eXBlb2YgZWxlbWVudC5yZWZlcmVuY2VFbGVtZW50ID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICB2aWV3UmVmID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihlbGVtZW50LnJlZmVyZW5jZUVsZW1lbnQpO1xuICAgICAgICAgICAgaXNVc2luZ1JlZmVyZW5jZUVsZW1lbnQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh2aWV3UmVmPy52aWV3KSB7XG4gICAgICAgICAgICBlbGVtZW50LnZpZXcgPSB2aWV3UmVmLnZpZXc7XG4gICAgICAgICAgICBjb25zdCBlbCA9IGVsZW1lbnQuY2hpbGRFbGVtID8/IGVsZW1lbnQuZWw7XG4gICAgICAgICAgICBpZiAoIWlzVXNpbmdSZWZlcmVuY2VFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgZWxlbWVudC52aWV3LnVpLmFkZChlbCwgZWxlbWVudC5wb3NpdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodmlld1JlZikge1xuICAgICAgICAgICAgd2FpdEZvclZpZXdIYW5kbGVyKHZpZXdSZWYsIGVsZW1lbnQsIGlzVXNpbmdSZWZlcmVuY2VFbGVtZW50KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgY29uc3Qgdmlld1JlZiA9IGVsZW1lbnQuZWwuY2xvc2VzdChcImFyY2dpcy1tYXBcIikgPz8gZWxlbWVudC5lbC5jbG9zZXN0KFwiYXJjZ2lzLXNjZW5lXCIpO1xuICAgICAgICBpZiAodmlld1JlZj8udmlldykge1xuICAgICAgICAgICAgZWxlbWVudC52aWV3ID0gdmlld1JlZi52aWV3O1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHZpZXdSZWYpIHtcbiAgICAgICAgICAgIGNvbnN0IGhhbmRsZXIgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdmlld1JlZi5yZW1vdmVFdmVudExpc3RlbmVyKFwiYXJjZ2lzVmlld1JlYWR5Q2hhbmdlXCIsIGhhbmRsZXIsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICBlbGVtZW50LnZpZXcgPSB2aWV3UmVmLnZpZXc7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdmlld1JlZi5hZGRFdmVudExpc3RlbmVyKFwiYXJjZ2lzVmlld1JlYWR5Q2hhbmdlXCIsIGhhbmRsZXIsIGZhbHNlKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbmZ1bmN0aW9uIGlzTnVsbE9yRW1wdHlTdHJpbmcodmFsdWUpIHtcbiAgICByZXR1cm4gdmFsdWUgPT09IHVuZGVmaW5lZCB8fCB2YWx1ZSA9PT0gbnVsbCB8fCB2YWx1ZSA9PT0gXCJcIjtcbn1cbmZ1bmN0aW9uIGlzVmFsaWRJbnRlZ2VyKHZhbHVlKSB7XG4gICAgcmV0dXJuIHZhbHVlICE9IG51bGwgJiYgdmFsdWUgJSAxID09PSAwO1xufVxuZnVuY3Rpb24gaXNOb3RTYW1lQ2FtZXJhKGNhbWVyYSwgY2FtZXJhMikge1xuICAgIHJldHVybiAoY2FtZXJhMiA9PT0gdW5kZWZpbmVkIHx8XG4gICAgICAgIGNhbWVyYS5wb3NpdGlvbiAhPT0gY2FtZXJhMi5wb3NpdGlvbiB8fFxuICAgICAgICBjYW1lcmEuaGVhZGluZyAhPT0gY2FtZXJhMi5oZWFkaW5nIHx8XG4gICAgICAgIGNhbWVyYS50aWx0ICE9PSBjYW1lcmEyLnRpbHQpO1xufVxuZnVuY3Rpb24gaXNOb3RTYW1lRW52aXJvbm1lbnQoZW52aXJvbm1lbnQsIGVudmlyb25tZW50Mikge1xuICAgIHJldHVybiAoZW52aXJvbm1lbnQyID09PSB1bmRlZmluZWQgfHxcbiAgICAgICAgZW52aXJvbm1lbnQyLmF0bW9zcGhlcmVFbmFibGVkICE9PSBlbnZpcm9ubWVudC5hdG1vc3BoZXJlRW5hYmxlZCB8fFxuICAgICAgICBlbnZpcm9ubWVudDIubGlnaHRpbmcuZGF0ZSAhPT0gZW52aXJvbm1lbnQubGlnaHRpbmcuZGF0ZSB8fFxuICAgICAgICBlbnZpcm9ubWVudDIubGlnaHRpbmcuZGlyZWN0U2hhZG93c0VuYWJsZWQgIT09XG4gICAgICAgICAgICBlbnZpcm9ubWVudC5saWdodGluZy5kaXJlY3RTaGFkb3dzRW5hYmxlZCB8fFxuICAgICAgICBlbnZpcm9ubWVudDIubGlnaHRpbmcuY2FtZXJhVHJhY2tpbmdFbmFibGVkICE9PVxuICAgICAgICAgICAgZW52aXJvbm1lbnQubGlnaHRpbmcuY2FtZXJhVHJhY2tpbmdFbmFibGVkIHx8XG4gICAgICAgIGVudmlyb25tZW50Mi5saWdodGluZy5kYXRlICE9PSBlbnZpcm9ubWVudC5saWdodGluZy5kYXRlIHx8XG4gICAgICAgIGVudmlyb25tZW50Mi5saWdodGluZy5kaXNwbGF5VVRDT2Zmc2V0ICE9PVxuICAgICAgICAgICAgZW52aXJvbm1lbnQubGlnaHRpbmcuZGlzcGxheVVUQ09mZnNldCk7XG59XG5mdW5jdGlvbiBpc05vdFNhbWVWaWV3cG9pbnQodmlld3BvaW50LCB2aWV3cG9pbnQyKSB7XG4gICAgcmV0dXJuICh2aWV3cG9pbnQyID09PSB1bmRlZmluZWQgfHxcbiAgICAgICAgdmlld3BvaW50LnRhcmdldEdlb21ldHJ5ICE9PSB2aWV3cG9pbnQyLnRhcmdldEdlb21ldHJ5IHx8XG4gICAgICAgIHZpZXdwb2ludC5yb3RhdGlvbiAhPT0gdmlld3BvaW50Mi5yb3RhdGlvbiB8fFxuICAgICAgICB2aWV3cG9pbnQuc2NhbGUgIT09IHZpZXdwb2ludDIuc2NhbGUpO1xufVxuYXN5bmMgZnVuY3Rpb24gdXBkYXRlRm9yVmlldyh2aWV3U3RyKSB7XG4gICAgY29uc3Qgdmlld1JlZiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Iodmlld1N0cik7XG4gICAgcmV0dXJuIGF3YWl0IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgICAgIGlmICh2aWV3UmVmPy52aWV3ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJlc29sdmUodmlld1JlZi52aWV3KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh2aWV3UmVmKSB7XG4gICAgICAgICAgICBjb25zdCBoYW5kbGVyID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgIHZpZXdSZWYucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImFyY2dpc1ZpZXdSZWFkeUNoYW5nZVwiLCBoYW5kbGVyLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZSh2aWV3UmVmLnZpZXcpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZpZXdSZWYuYWRkRXZlbnRMaXN0ZW5lcihcImFyY2dpc1ZpZXdSZWFkeUNoYW5nZVwiLCBoYW5kbGVyLCBmYWxzZSk7XG4gICAgICAgIH1cbiAgICB9KTtcbn1cbmFzeW5jIGZ1bmN0aW9uIHJlZmVyZW5jZUVsZW1lbnRIZWxwZXIoZWxlbWVudCwgcmVmRWxlbWVudCkge1xuICAgIGlmIChyZWZFbGVtZW50ID09PSB1bmRlZmluZWQpXG4gICAgICAgIHJldHVybjtcbiAgICBlbHNlIGlmICh0eXBlb2YgcmVmRWxlbWVudCA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICBlbGVtZW50LnZpZXcgPSBhd2FpdCB1cGRhdGVGb3JWaWV3KHJlZkVsZW1lbnQpO1xuICAgIH1cbiAgICBlbHNlIGlmIChlbGVtZW50LndpZGdldCkge1xuICAgICAgICBlbGVtZW50LnZpZXcgPSByZWZFbGVtZW50LnZpZXc7XG4gICAgfVxufVxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy9cbi8vICBQcml2YXRlIE1ldGhvZHNcbi8vXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5mdW5jdGlvbiB3YWl0Rm9yVmlld0hhbmRsZXIodmlld1JlZiwgZWxlbWVudCwgaXNVc2luZ1JlZmVybmNlRWxlbWVudCkge1xuICAgIGNvbnN0IGhhbmRsZXIgPSAoKSA9PiB7XG4gICAgICAgIHZpZXdSZWYucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImFyY2dpc1ZpZXdSZWFkeUNoYW5nZVwiLCBoYW5kbGVyLCBmYWxzZSk7XG4gICAgICAgIGVsZW1lbnQudmlldyA9IHZpZXdSZWYudmlldztcbiAgICAgICAgaWYgKCFpc1VzaW5nUmVmZXJuY2VFbGVtZW50KSB7XG4gICAgICAgICAgICBlbGVtZW50LnZpZXcudWkuYWRkKGVsZW1lbnQuY2hpbGRFbGVtID8/IGVsZW1lbnQuZWwsIGVsZW1lbnQucG9zaXRpb24pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICB2aWV3UmVmLmFkZEV2ZW50TGlzdGVuZXIoXCJhcmNnaXNWaWV3UmVhZHlDaGFuZ2VcIiwgaGFuZGxlciwgZmFsc2UpO1xufVxuXG5leHBvcnQgeyBhZGRIYW5kbGVzIGFzIGEsIGlzTm90U2FtZVZpZXdwb2ludCBhcyBiLCBjaGVja0ZvclZpZXcgYXMgYywgY2hlY2tGb3JFeHBhbmQgYXMgZCwgaXNOb3RTYW1lQ2FtZXJhIGFzIGUsIGlzTm90U2FtZUVudmlyb25tZW50IGFzIGYsIGlzVmFsaWRJbnRlZ2VyIGFzIGcsIGlzTnVsbE9yRW1wdHlTdHJpbmcgYXMgaSwgcmVmZXJlbmNlRWxlbWVudEhlbHBlciBhcyByIH07XG4iLCIvKiFcbiAqIEFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRXNyaSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG4gKiBTZWUgaHR0cHM6Ly9qcy5hcmNnaXMuY29tLzQuMzAvZXNyaS9jb3B5cmlnaHQudHh0IGZvciBkZXRhaWxzLlxuICogdjQuMzAuMC1uZXh0LjM3XG4gKi9cbmZ1bmN0aW9uIG9uRGlzY29ubmVjdGVkSGVscGVyKGVsZW1lbnQpIHtcbiAgICBpZiAoZWxlbWVudC5jaGlsZEVsZW0pIHtcbiAgICAgICAgaWYgKCFlbGVtZW50LmVsLmlzQ29ubmVjdGVkKSB7XG4gICAgICAgICAgICBpZiAoZWxlbWVudC52aWV3KSB7XG4gICAgICAgICAgICAgICAgZWxlbWVudC52aWV3LnVpLnJlbW92ZShlbGVtZW50LmNoaWxkRWxlbSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChlbGVtZW50LndpZGdldD8udmlldykge1xuICAgICAgICAgICAgICAgIGVsZW1lbnQud2lkZ2V0LnZpZXcudWkucmVtb3ZlKGVsZW1lbnQuY2hpbGRFbGVtKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChlbGVtZW50Ll93YXRjaEhhbmRsZXMpIHtcbiAgICAgICAgICAgICAgICBlbGVtZW50Ll93YXRjaEhhbmRsZXMuZm9yRWFjaCgoaGFuZGxlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGhhbmRsZS5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsZW1lbnQuX3dhdGNoSGFuZGxlcyA9IFtdO1xuICAgICAgICAgICAgZWxlbWVudC53aWRnZXQ/LmRlc3Ryb3koKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICBpZiAoIWVsZW1lbnQuZWwuaXNDb25uZWN0ZWQpIHtcbiAgICAgICAgICAgICAgICBpZiAoZWxlbWVudC52aWV3KSB7XG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQudmlldy51aS5yZW1vdmUoZWxlbWVudC5lbCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGVsZW1lbnQud2lkZ2V0Py52aWV3KSB7XG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQud2lkZ2V0LnZpZXcudWkucmVtb3ZlKGVsZW1lbnQuZWwpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoZWxlbWVudC5fd2F0Y2hIYW5kbGVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuX3dhdGNoSGFuZGxlcy5mb3JFYWNoKChoYW5kbGUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZS5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsZW1lbnQuX3dhdGNoSGFuZGxlcyA9IFtdO1xuICAgICAgICAgICAgICAgIGVsZW1lbnQud2lkZ2V0Py5kZXN0cm95KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIDEwMDApO1xuICAgIH1cbn1cblxuZXhwb3J0IHsgb25EaXNjb25uZWN0ZWRIZWxwZXIgYXMgbyB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9