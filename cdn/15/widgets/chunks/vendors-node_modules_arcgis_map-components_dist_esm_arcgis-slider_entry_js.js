"use strict";
(self["webpackChunkexb_client"] = self["webpackChunkexb_client"] || []).push([["vendors-node_modules_arcgis_map-components_dist_esm_arcgis-slider_entry_js"],{

/***/ "./node_modules/@arcgis/map-components/dist/esm/arcgis-slider.entry.js":
/*!*****************************************************************************!*\
  !*** ./node_modules/@arcgis/map-components/dist/esm/arcgis-slider.entry.js ***!
  \*****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   arcgis_slider: () => (/* binding */ ArcgisSlider)
/* harmony export */ });
/* harmony import */ var _index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-6e172aac.js */ "./node_modules/@arcgis/map-components/dist/esm/index-6e172aac.js");
/* harmony import */ var _index_0bc55ca5_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./index-0bc55ca5.js */ "./node_modules/@arcgis/map-components/dist/esm/index-0bc55ca5.js");
/* harmony import */ var _component_utils_23194f7c_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./component-utils-23194f7c.js */ "./node_modules/@arcgis/map-components/dist/esm/component-utils-23194f7c.js");
/* harmony import */ var _disconnected_6cf1c100_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./disconnected-6cf1c100.js */ "./node_modules/@arcgis/map-components/dist/esm/disconnected-6cf1c100.js");
/*!
 * All material copyright Esri, All Rights Reserved, unless otherwise specified.
 * See https://js.arcgis.com/4.30/esri/copyright.txt for details.
 * v4.30.0-next.37
 */





const sliderCss = "arcgis-slider{min-width:200px;min-height:25px}";

const ArcgisSlider = class {
    constructor(hostRef) {
        (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);
        this.sliderMaxChange = (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "sliderMaxChange", 7);
        this.sliderMaxClick = (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "sliderMaxClick", 7);
        this.sliderMinChange = (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "sliderMinChange", 7);
        this.sliderMinClick = (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "sliderMinClick", 7);
        this.sliderSegmentClick = (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "sliderSegmentClick", 7);
        this.sliderSegmentDrag = (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "sliderSegmentDrag", 7);
        this.sliderThumbChange = (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "sliderThumbChange", 7);
        this.sliderThumbClick = (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "sliderThumbClick", 7);
        this.sliderThumbDrag = (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "sliderThumbDrag", 7);
        this.sliderTickClick = (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "sliderTickClick", 7);
        this.sliderTrackClick = (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "sliderTrackClick", 7);
        this.widgetReady = (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "widgetReady", 7);
        this._watchHandles = [];
        this.referenceElement = undefined;
        this.draggableSegmentsEnabled = undefined;
        this.effectiveMax = undefined;
        this.effectiveMin = undefined;
        this.effectiveSegmentElements = undefined;
        this.labelElements = undefined;
        this.labelInputsEnabled = undefined;
        this.labels = undefined;
        this.layout = "horizontal";
        this.min = undefined;
        this.max = undefined;
        this.maxLabelElement = undefined;
        this.minLabelElement = undefined;
        this.precision = undefined;
        this.rangeLabelInputsEnabled = undefined;
        this.segmentElements = undefined;
        this.snapOnClickEnabled = undefined;
        this.syncedSegmentsEnabled = undefined;
        this.thumbElements = undefined;
        this.thumbsConstrained = undefined;
        this.tickConfigs = undefined;
        this.tickElements = undefined;
        this.trackElement = undefined;
        this.steps = undefined;
        this.values = undefined;
        this.position = "bottom-left";
        this.expandable = false;
        this.widget = undefined;
    }
    draggableSegmentsEnabledWatcher(newValue) {
        if (newValue !== undefined && this.widget) {
            this.widget.draggableSegmentsEnabled = newValue;
        }
    }
    effectiveMaxWatcher(newValue) {
        if (newValue !== undefined && this.widget) {
            this.widget.effectiveMax = newValue;
        }
    }
    effectiveMinWatcher(newValue) {
        if (newValue !== undefined && this.widget) {
            this.widget.effectiveMin = newValue;
        }
    }
    layoutWatcher(newValue) {
        if (this.widget) {
            this.widget.layout = newValue;
        }
    }
    minWatcher(newValue) {
        if (newValue !== undefined && this.widget) {
            this.widget.min = newValue;
        }
    }
    maxWatcher(newValue) {
        if (newValue !== undefined && this.widget) {
            this.widget.max = newValue;
        }
    }
    precisionWatcher(newValue) {
        if (newValue !== undefined && this.widget) {
            this.widget.precision = newValue;
        }
    }
    rangeLabelInputsEnabledWatcher(newValue) {
        if (newValue !== undefined && this.widget) {
            this.widget.rangeLabelInputsEnabled = newValue;
        }
    }
    snapOnClickEnabledWatcher(newValue) {
        if (newValue !== undefined && this.widget) {
            this.widget.snapOnClickEnabled = newValue;
        }
    }
    syncedSegmentsEnabledWatcher(newValue) {
        if (newValue !== undefined && this.widget) {
            this.widget.syncedSegmentsEnabled = newValue;
        }
    }
    thumbsConstrainedWatcher(newValue) {
        if (newValue !== undefined && this.widget) {
            this.widget.thumbsConstrained = newValue;
        }
    }
    tickConfigsWatcher(newValue) {
        if (this.widget) {
            this.widget.tickConfigs = newValue;
        }
    }
    stepsWatcher(newValue) {
        if (this.widget) {
            this.widget.steps = newValue;
        }
    }
    valuesWatcher(newValue) {
        if (typeof newValue === "string") {
            this.values = newValue.split(",").map((n) => Number(n));
        }
        if (this.widget) {
            this.widget.values = this.values;
        }
    }
    //--------------------------------------------------------------------------
    //
    //  Lifecycle
    //
    //--------------------------------------------------------------------------
    async componentDidLoad() {
        const params = this._createParams();
        const widget = await (0,_index_0bc55ca5_js__WEBPACK_IMPORTED_MODULE_1__.Y)(params);
        this.widget = widget;
        await this._addWatchers();
        this.widgetReady.emit({ widget: this.widget });
        (0,_component_utils_23194f7c_js__WEBPACK_IMPORTED_MODULE_2__.c)(this);
    }
    disconnectedCallback() {
        (0,_disconnected_6cf1c100_js__WEBPACK_IMPORTED_MODULE_3__.o)(this);
    }
    render() {
        if (this.expandable) {
            return ((0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-expand", { position: this.position, ref: (el) => (this.expandElem = el) }, (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { ref: (el) => (this.childElem = el) })));
        }
        return (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { ref: (el) => (this.childElem = el) });
    }
    //--------------------------------------------------------------------------
    //
    //  Private Methods
    //
    //--------------------------------------------------------------------------
    async _addWatchers() {
        const { watch } = await (0,_index_0bc55ca5_js__WEBPACK_IMPORTED_MODULE_1__.i)();
        (0,_component_utils_23194f7c_js__WEBPACK_IMPORTED_MODULE_2__.a)(this, watch(() => this.widget.effectiveSegmentElements, (value) => (this.effectiveSegmentElements = value), {
            initial: true,
        }));
        (0,_component_utils_23194f7c_js__WEBPACK_IMPORTED_MODULE_2__.a)(this, watch(() => this.widget.labelElements, (value) => (this.labelElements = value), {
            initial: true,
        }));
        (0,_component_utils_23194f7c_js__WEBPACK_IMPORTED_MODULE_2__.a)(this, watch(() => this.widget.maxLabelElement, (value) => (this.maxLabelElement = value), {
            initial: true,
        }));
        (0,_component_utils_23194f7c_js__WEBPACK_IMPORTED_MODULE_2__.a)(this, watch(() => this.widget.minLabelElement, (value) => (this.minLabelElement = value), {
            initial: true,
        }));
        (0,_component_utils_23194f7c_js__WEBPACK_IMPORTED_MODULE_2__.a)(this, watch(() => this.widget.segmentElements, (value) => (this.segmentElements = value), {
            initial: true,
        }));
        (0,_component_utils_23194f7c_js__WEBPACK_IMPORTED_MODULE_2__.a)(this, watch(() => this.widget.thumbElements, (value) => (this.thumbElements = value), {
            initial: true,
        }));
        (0,_component_utils_23194f7c_js__WEBPACK_IMPORTED_MODULE_2__.a)(this, watch(() => this.widget.tickElements, (value) => (this.tickElements = value), {
            initial: true,
        }));
        (0,_component_utils_23194f7c_js__WEBPACK_IMPORTED_MODULE_2__.a)(this, watch(() => this.widget.trackElement, (value) => (this.trackElement = value), {
            initial: true,
        }));
    }
    _createParams() {
        const params = {
            container: this.childElem,
            layout: this.layout,
        };
        if (this.min !== undefined) {
            params.min = this.min;
        }
        if (this.max !== undefined) {
            params.max = this.max;
        }
        if (this.steps) {
            if (typeof this.steps === "string") {
                this.steps = this.steps.split(",").map((n) => Number(n));
            }
            params.steps = this.steps;
        }
        if (this.values) {
            if (typeof this.values === "string") {
                this.values = this.values.split(",").map((n) => Number(n));
            }
            params.values = this.values;
        }
        return params;
    }
    get el() { return (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.g)(this); }
    static get watchers() { return {
        "draggableSegmentsEnabled": ["draggableSegmentsEnabledWatcher"],
        "effectiveMax": ["effectiveMaxWatcher"],
        "effectiveMin": ["effectiveMinWatcher"],
        "layout": ["layoutWatcher"],
        "min": ["minWatcher"],
        "max": ["maxWatcher"],
        "precision": ["precisionWatcher"],
        "rangeLabelInputsEnabled": ["rangeLabelInputsEnabledWatcher"],
        "snapOnClickEnabled": ["snapOnClickEnabledWatcher"],
        "syncedSegmentsEnabled": ["syncedSegmentsEnabledWatcher"],
        "thumbsConstrained": ["thumbsConstrainedWatcher"],
        "tickConfigs": ["tickConfigsWatcher"],
        "steps": ["stepsWatcher"],
        "values": ["valuesWatcher"]
    }; }
};
ArcgisSlider.style = sliderCss;




/***/ }),

/***/ "./node_modules/@arcgis/map-components/dist/esm/component-utils-23194f7c.js":
/*!**********************************************************************************!*\
  !*** ./node_modules/@arcgis/map-components/dist/esm/component-utils-23194f7c.js ***!
  \**********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   a: () => (/* binding */ addHandles),
/* harmony export */   b: () => (/* binding */ isNotSameViewpoint),
/* harmony export */   c: () => (/* binding */ checkForView),
/* harmony export */   d: () => (/* binding */ checkForExpand),
/* harmony export */   e: () => (/* binding */ isNotSameCamera),
/* harmony export */   f: () => (/* binding */ isNotSameEnvironment),
/* harmony export */   g: () => (/* binding */ isValidInteger),
/* harmony export */   i: () => (/* binding */ isNullOrEmptyString),
/* harmony export */   r: () => (/* binding */ referenceElementHelper)
/* harmony export */ });
/*!
 * All material copyright Esri, All Rights Reserved, unless otherwise specified.
 * See https://js.arcgis.com/4.30/esri/copyright.txt for details.
 * v4.30.0-next.37
 */
function checkForExpand(element) {
    const expandRef = element.el.closest("arcgis-expand") ?? element.expandElem;
    if (expandRef?.widget) {
        element.view = expandRef.view;
        expandRef.widget.content = element.childElem ?? element.el;
        // TODO: Update to be expandIcon = widget.icon, not ready yet in 4.27next
        if (!expandRef.expandIcon) {
            expandRef.widget.expandIcon = element.widget ? element.widget.icon : element?.icon;
        }
        return true;
    }
    if (expandRef) {
        const widgetHandler = () => {
            expandRef.removeEventListener("arcgisExpandReady", widgetHandler, false);
            element.view = expandRef.view;
            expandRef.widget.content = element.childElem ?? element.el;
            if (!expandRef.expandIcon) {
                expandRef.widget.expandIcon = element.widget ? element.widget.icon : element?.icon;
            }
        };
        expandRef.addEventListener("arcgisExpandReady", widgetHandler, false);
        return true;
    }
    return false;
}

//--------------------------------------------------------------------------
//
//  Public Methods
//
//--------------------------------------------------------------------------
function addHandles(element, handle) {
    if (Array.isArray(handle)) {
        element._watchHandles = [...element._watchHandles, ...handle];
    }
    else {
        element._watchHandles.push(handle);
    }
}
function checkForView(element) {
    let isUsingReferenceElement = false;
    if (!checkForExpand(element)) {
        let viewRef = element.el.closest("arcgis-map") ?? element.el.closest("arcgis-scene");
        if (!viewRef && typeof element.referenceElement === "string") {
            viewRef = document.querySelector(element.referenceElement);
            isUsingReferenceElement = true;
        }
        if (viewRef?.view) {
            element.view = viewRef.view;
            const el = element.childElem ?? element.el;
            if (!isUsingReferenceElement) {
                element.view.ui.add(el, element.position);
            }
        }
        else if (viewRef) {
            waitForViewHandler(viewRef, element, isUsingReferenceElement);
        }
    }
    else {
        const viewRef = element.el.closest("arcgis-map") ?? element.el.closest("arcgis-scene");
        if (viewRef?.view) {
            element.view = viewRef.view;
        }
        else if (viewRef) {
            const handler = () => {
                viewRef.removeEventListener("arcgisViewReadyChange", handler, false);
                element.view = viewRef.view;
            };
            viewRef.addEventListener("arcgisViewReadyChange", handler, false);
        }
    }
}
function isNullOrEmptyString(value) {
    return value === undefined || value === null || value === "";
}
function isValidInteger(value) {
    return value != null && value % 1 === 0;
}
function isNotSameCamera(camera, camera2) {
    return (camera2 === undefined ||
        camera.position !== camera2.position ||
        camera.heading !== camera2.heading ||
        camera.tilt !== camera2.tilt);
}
function isNotSameEnvironment(environment, environment2) {
    return (environment2 === undefined ||
        environment2.atmosphereEnabled !== environment.atmosphereEnabled ||
        environment2.lighting.date !== environment.lighting.date ||
        environment2.lighting.directShadowsEnabled !==
            environment.lighting.directShadowsEnabled ||
        environment2.lighting.cameraTrackingEnabled !==
            environment.lighting.cameraTrackingEnabled ||
        environment2.lighting.date !== environment.lighting.date ||
        environment2.lighting.displayUTCOffset !==
            environment.lighting.displayUTCOffset);
}
function isNotSameViewpoint(viewpoint, viewpoint2) {
    return (viewpoint2 === undefined ||
        viewpoint.targetGeometry !== viewpoint2.targetGeometry ||
        viewpoint.rotation !== viewpoint2.rotation ||
        viewpoint.scale !== viewpoint2.scale);
}
async function updateForView(viewStr) {
    const viewRef = document.querySelector(viewStr);
    return await new Promise((resolve) => {
        if (viewRef?.view !== undefined) {
            resolve(viewRef.view);
        }
        else if (viewRef) {
            const handler = () => {
                viewRef.removeEventListener("arcgisViewReadyChange", handler, false);
                resolve(viewRef.view);
            };
            viewRef.addEventListener("arcgisViewReadyChange", handler, false);
        }
    });
}
async function referenceElementHelper(element, refElement) {
    if (refElement === undefined)
        return;
    else if (typeof refElement === "string") {
        element.view = await updateForView(refElement);
    }
    else if (element.widget) {
        element.view = refElement.view;
    }
}
//--------------------------------------------------------------------------
//
//  Private Methods
//
//--------------------------------------------------------------------------
function waitForViewHandler(viewRef, element, isUsingRefernceElement) {
    const handler = () => {
        viewRef.removeEventListener("arcgisViewReadyChange", handler, false);
        element.view = viewRef.view;
        if (!isUsingRefernceElement) {
            element.view.ui.add(element.childElem ?? element.el, element.position);
        }
    };
    viewRef.addEventListener("arcgisViewReadyChange", handler, false);
}




/***/ }),

/***/ "./node_modules/@arcgis/map-components/dist/esm/disconnected-6cf1c100.js":
/*!*******************************************************************************!*\
  !*** ./node_modules/@arcgis/map-components/dist/esm/disconnected-6cf1c100.js ***!
  \*******************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   o: () => (/* binding */ onDisconnectedHelper)
/* harmony export */ });
/*!
 * All material copyright Esri, All Rights Reserved, unless otherwise specified.
 * See https://js.arcgis.com/4.30/esri/copyright.txt for details.
 * v4.30.0-next.37
 */
function onDisconnectedHelper(element) {
    if (element.childElem) {
        if (!element.el.isConnected) {
            if (element.view) {
                element.view.ui.remove(element.childElem);
            }
            else if (element.widget?.view) {
                element.widget.view.ui.remove(element.childElem);
            }
            if (element._watchHandles) {
                element._watchHandles.forEach((handle) => {
                    handle.remove();
                });
            }
            element._watchHandles = [];
            element.widget?.destroy();
        }
    }
    else {
        setTimeout(() => {
            if (!element.el.isConnected) {
                if (element.view) {
                    element.view.ui.remove(element.el);
                }
                else if (element.widget?.view) {
                    element.widget.view.ui.remove(element.el);
                }
                if (element._watchHandles) {
                    element._watchHandles.forEach((handle) => {
                        handle.remove();
                    });
                }
                element._watchHandles = [];
                element.widget?.destroy();
            }
        }, 1000);
    }
}




/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2lkZ2V0cy9jaHVua3MvdmVuZG9ycy1ub2RlX21vZHVsZXNfYXJjZ2lzX21hcC1jb21wb25lbnRzX2Rpc3RfZXNtX2FyY2dpcy1zbGlkZXJfZW50cnlfanMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ2tHO0FBQ1I7QUFDUDtBQUNaOztBQUV2RSxpQ0FBaUMsZ0JBQWdCLGdCQUFnQjs7QUFFakU7QUFDQTtBQUNBLFFBQVEscURBQWdCO0FBQ3hCLCtCQUErQixxREFBVztBQUMxQyw4QkFBOEIscURBQVc7QUFDekMsK0JBQStCLHFEQUFXO0FBQzFDLDhCQUE4QixxREFBVztBQUN6QyxrQ0FBa0MscURBQVc7QUFDN0MsaUNBQWlDLHFEQUFXO0FBQzVDLGlDQUFpQyxxREFBVztBQUM1QyxnQ0FBZ0MscURBQVc7QUFDM0MsK0JBQStCLHFEQUFXO0FBQzFDLCtCQUErQixxREFBVztBQUMxQyxnQ0FBZ0MscURBQVc7QUFDM0MsMkJBQTJCLHFEQUFXO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkIscURBQWdCO0FBQzdDO0FBQ0E7QUFDQSxnQ0FBZ0MscUJBQXFCO0FBQ3JELFFBQVEsK0RBQVk7QUFDcEI7QUFDQTtBQUNBLFFBQVEsNERBQW9CO0FBQzVCO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixxREFBQyxvQkFBb0IsOERBQThELEVBQUUscURBQUMsVUFBVSxvQ0FBb0M7QUFDeEo7QUFDQSxlQUFlLHFEQUFDLFVBQVUsb0NBQW9DO0FBQzlEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLFFBQVEsUUFBUSxxREFBdUI7QUFDdkQsUUFBUSwrREFBVTtBQUNsQjtBQUNBLFNBQVM7QUFDVCxRQUFRLCtEQUFVO0FBQ2xCO0FBQ0EsU0FBUztBQUNULFFBQVEsK0RBQVU7QUFDbEI7QUFDQSxTQUFTO0FBQ1QsUUFBUSwrREFBVTtBQUNsQjtBQUNBLFNBQVM7QUFDVCxRQUFRLCtEQUFVO0FBQ2xCO0FBQ0EsU0FBUztBQUNULFFBQVEsK0RBQVU7QUFDbEI7QUFDQSxTQUFTO0FBQ1QsUUFBUSwrREFBVTtBQUNsQjtBQUNBLFNBQVM7QUFDVCxRQUFRLCtEQUFVO0FBQ2xCO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLE9BQU8scURBQVU7QUFDaEMsNEJBQTRCO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRXlDOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ3JPekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFeU47Ozs7Ozs7Ozs7Ozs7OztBQ3BKek47QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7O0FBRXFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL25vZGVfbW9kdWxlcy9AYXJjZ2lzL21hcC1jb21wb25lbnRzL2Rpc3QvZXNtL2FyY2dpcy1zbGlkZXIuZW50cnkuanMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL25vZGVfbW9kdWxlcy9AYXJjZ2lzL21hcC1jb21wb25lbnRzL2Rpc3QvZXNtL2NvbXBvbmVudC11dGlscy0yMzE5NGY3Yy5qcyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vbm9kZV9tb2R1bGVzL0BhcmNnaXMvbWFwLWNvbXBvbmVudHMvZGlzdC9lc20vZGlzY29ubmVjdGVkLTZjZjFjMTAwLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qIVxuICogQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFc3JpLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAqIFNlZSBodHRwczovL2pzLmFyY2dpcy5jb20vNC4zMC9lc3JpL2NvcHlyaWdodC50eHQgZm9yIGRldGFpbHMuXG4gKiB2NC4zMC4wLW5leHQuMzdcbiAqL1xuaW1wb3J0IHsgciBhcyByZWdpc3Rlckluc3RhbmNlLCBjIGFzIGNyZWF0ZUV2ZW50LCBoLCBnIGFzIGdldEVsZW1lbnQgfSBmcm9tICcuL2luZGV4LTZlMTcyYWFjLmpzJztcbmltcG9ydCB7IFkgYXMgbmV3V2lkZ2V0c1NsaWRlciwgaSBhcyBpbXBvcnRDb3JlUmVhY3RpdmVVdGlscyB9IGZyb20gJy4vaW5kZXgtMGJjNTVjYTUuanMnO1xuaW1wb3J0IHsgYyBhcyBjaGVja0ZvclZpZXcsIGEgYXMgYWRkSGFuZGxlcyB9IGZyb20gJy4vY29tcG9uZW50LXV0aWxzLTIzMTk0ZjdjLmpzJztcbmltcG9ydCB7IG8gYXMgb25EaXNjb25uZWN0ZWRIZWxwZXIgfSBmcm9tICcuL2Rpc2Nvbm5lY3RlZC02Y2YxYzEwMC5qcyc7XG5cbmNvbnN0IHNsaWRlckNzcyA9IFwiYXJjZ2lzLXNsaWRlcnttaW4td2lkdGg6MjAwcHg7bWluLWhlaWdodDoyNXB4fVwiO1xuXG5jb25zdCBBcmNnaXNTbGlkZXIgPSBjbGFzcyB7XG4gICAgY29uc3RydWN0b3IoaG9zdFJlZikge1xuICAgICAgICByZWdpc3Rlckluc3RhbmNlKHRoaXMsIGhvc3RSZWYpO1xuICAgICAgICB0aGlzLnNsaWRlck1heENoYW5nZSA9IGNyZWF0ZUV2ZW50KHRoaXMsIFwic2xpZGVyTWF4Q2hhbmdlXCIsIDcpO1xuICAgICAgICB0aGlzLnNsaWRlck1heENsaWNrID0gY3JlYXRlRXZlbnQodGhpcywgXCJzbGlkZXJNYXhDbGlja1wiLCA3KTtcbiAgICAgICAgdGhpcy5zbGlkZXJNaW5DaGFuZ2UgPSBjcmVhdGVFdmVudCh0aGlzLCBcInNsaWRlck1pbkNoYW5nZVwiLCA3KTtcbiAgICAgICAgdGhpcy5zbGlkZXJNaW5DbGljayA9IGNyZWF0ZUV2ZW50KHRoaXMsIFwic2xpZGVyTWluQ2xpY2tcIiwgNyk7XG4gICAgICAgIHRoaXMuc2xpZGVyU2VnbWVudENsaWNrID0gY3JlYXRlRXZlbnQodGhpcywgXCJzbGlkZXJTZWdtZW50Q2xpY2tcIiwgNyk7XG4gICAgICAgIHRoaXMuc2xpZGVyU2VnbWVudERyYWcgPSBjcmVhdGVFdmVudCh0aGlzLCBcInNsaWRlclNlZ21lbnREcmFnXCIsIDcpO1xuICAgICAgICB0aGlzLnNsaWRlclRodW1iQ2hhbmdlID0gY3JlYXRlRXZlbnQodGhpcywgXCJzbGlkZXJUaHVtYkNoYW5nZVwiLCA3KTtcbiAgICAgICAgdGhpcy5zbGlkZXJUaHVtYkNsaWNrID0gY3JlYXRlRXZlbnQodGhpcywgXCJzbGlkZXJUaHVtYkNsaWNrXCIsIDcpO1xuICAgICAgICB0aGlzLnNsaWRlclRodW1iRHJhZyA9IGNyZWF0ZUV2ZW50KHRoaXMsIFwic2xpZGVyVGh1bWJEcmFnXCIsIDcpO1xuICAgICAgICB0aGlzLnNsaWRlclRpY2tDbGljayA9IGNyZWF0ZUV2ZW50KHRoaXMsIFwic2xpZGVyVGlja0NsaWNrXCIsIDcpO1xuICAgICAgICB0aGlzLnNsaWRlclRyYWNrQ2xpY2sgPSBjcmVhdGVFdmVudCh0aGlzLCBcInNsaWRlclRyYWNrQ2xpY2tcIiwgNyk7XG4gICAgICAgIHRoaXMud2lkZ2V0UmVhZHkgPSBjcmVhdGVFdmVudCh0aGlzLCBcIndpZGdldFJlYWR5XCIsIDcpO1xuICAgICAgICB0aGlzLl93YXRjaEhhbmRsZXMgPSBbXTtcbiAgICAgICAgdGhpcy5yZWZlcmVuY2VFbGVtZW50ID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLmRyYWdnYWJsZVNlZ21lbnRzRW5hYmxlZCA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5lZmZlY3RpdmVNYXggPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuZWZmZWN0aXZlTWluID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLmVmZmVjdGl2ZVNlZ21lbnRFbGVtZW50cyA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5sYWJlbEVsZW1lbnRzID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLmxhYmVsSW5wdXRzRW5hYmxlZCA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5sYWJlbHMgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMubGF5b3V0ID0gXCJob3Jpem9udGFsXCI7XG4gICAgICAgIHRoaXMubWluID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLm1heCA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5tYXhMYWJlbEVsZW1lbnQgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMubWluTGFiZWxFbGVtZW50ID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLnByZWNpc2lvbiA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5yYW5nZUxhYmVsSW5wdXRzRW5hYmxlZCA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5zZWdtZW50RWxlbWVudHMgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuc25hcE9uQ2xpY2tFbmFibGVkID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLnN5bmNlZFNlZ21lbnRzRW5hYmxlZCA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy50aHVtYkVsZW1lbnRzID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLnRodW1ic0NvbnN0cmFpbmVkID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLnRpY2tDb25maWdzID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLnRpY2tFbGVtZW50cyA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy50cmFja0VsZW1lbnQgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuc3RlcHMgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMudmFsdWVzID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLnBvc2l0aW9uID0gXCJib3R0b20tbGVmdFwiO1xuICAgICAgICB0aGlzLmV4cGFuZGFibGUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy53aWRnZXQgPSB1bmRlZmluZWQ7XG4gICAgfVxuICAgIGRyYWdnYWJsZVNlZ21lbnRzRW5hYmxlZFdhdGNoZXIobmV3VmFsdWUpIHtcbiAgICAgICAgaWYgKG5ld1ZhbHVlICE9PSB1bmRlZmluZWQgJiYgdGhpcy53aWRnZXQpIHtcbiAgICAgICAgICAgIHRoaXMud2lkZ2V0LmRyYWdnYWJsZVNlZ21lbnRzRW5hYmxlZCA9IG5ld1ZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVmZmVjdGl2ZU1heFdhdGNoZXIobmV3VmFsdWUpIHtcbiAgICAgICAgaWYgKG5ld1ZhbHVlICE9PSB1bmRlZmluZWQgJiYgdGhpcy53aWRnZXQpIHtcbiAgICAgICAgICAgIHRoaXMud2lkZ2V0LmVmZmVjdGl2ZU1heCA9IG5ld1ZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVmZmVjdGl2ZU1pbldhdGNoZXIobmV3VmFsdWUpIHtcbiAgICAgICAgaWYgKG5ld1ZhbHVlICE9PSB1bmRlZmluZWQgJiYgdGhpcy53aWRnZXQpIHtcbiAgICAgICAgICAgIHRoaXMud2lkZ2V0LmVmZmVjdGl2ZU1pbiA9IG5ld1ZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGxheW91dFdhdGNoZXIobmV3VmFsdWUpIHtcbiAgICAgICAgaWYgKHRoaXMud2lkZ2V0KSB7XG4gICAgICAgICAgICB0aGlzLndpZGdldC5sYXlvdXQgPSBuZXdWYWx1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBtaW5XYXRjaGVyKG5ld1ZhbHVlKSB7XG4gICAgICAgIGlmIChuZXdWYWx1ZSAhPT0gdW5kZWZpbmVkICYmIHRoaXMud2lkZ2V0KSB7XG4gICAgICAgICAgICB0aGlzLndpZGdldC5taW4gPSBuZXdWYWx1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBtYXhXYXRjaGVyKG5ld1ZhbHVlKSB7XG4gICAgICAgIGlmIChuZXdWYWx1ZSAhPT0gdW5kZWZpbmVkICYmIHRoaXMud2lkZ2V0KSB7XG4gICAgICAgICAgICB0aGlzLndpZGdldC5tYXggPSBuZXdWYWx1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBwcmVjaXNpb25XYXRjaGVyKG5ld1ZhbHVlKSB7XG4gICAgICAgIGlmIChuZXdWYWx1ZSAhPT0gdW5kZWZpbmVkICYmIHRoaXMud2lkZ2V0KSB7XG4gICAgICAgICAgICB0aGlzLndpZGdldC5wcmVjaXNpb24gPSBuZXdWYWx1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByYW5nZUxhYmVsSW5wdXRzRW5hYmxlZFdhdGNoZXIobmV3VmFsdWUpIHtcbiAgICAgICAgaWYgKG5ld1ZhbHVlICE9PSB1bmRlZmluZWQgJiYgdGhpcy53aWRnZXQpIHtcbiAgICAgICAgICAgIHRoaXMud2lkZ2V0LnJhbmdlTGFiZWxJbnB1dHNFbmFibGVkID0gbmV3VmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc25hcE9uQ2xpY2tFbmFibGVkV2F0Y2hlcihuZXdWYWx1ZSkge1xuICAgICAgICBpZiAobmV3VmFsdWUgIT09IHVuZGVmaW5lZCAmJiB0aGlzLndpZGdldCkge1xuICAgICAgICAgICAgdGhpcy53aWRnZXQuc25hcE9uQ2xpY2tFbmFibGVkID0gbmV3VmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3luY2VkU2VnbWVudHNFbmFibGVkV2F0Y2hlcihuZXdWYWx1ZSkge1xuICAgICAgICBpZiAobmV3VmFsdWUgIT09IHVuZGVmaW5lZCAmJiB0aGlzLndpZGdldCkge1xuICAgICAgICAgICAgdGhpcy53aWRnZXQuc3luY2VkU2VnbWVudHNFbmFibGVkID0gbmV3VmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdGh1bWJzQ29uc3RyYWluZWRXYXRjaGVyKG5ld1ZhbHVlKSB7XG4gICAgICAgIGlmIChuZXdWYWx1ZSAhPT0gdW5kZWZpbmVkICYmIHRoaXMud2lkZ2V0KSB7XG4gICAgICAgICAgICB0aGlzLndpZGdldC50aHVtYnNDb25zdHJhaW5lZCA9IG5ld1ZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHRpY2tDb25maWdzV2F0Y2hlcihuZXdWYWx1ZSkge1xuICAgICAgICBpZiAodGhpcy53aWRnZXQpIHtcbiAgICAgICAgICAgIHRoaXMud2lkZ2V0LnRpY2tDb25maWdzID0gbmV3VmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RlcHNXYXRjaGVyKG5ld1ZhbHVlKSB7XG4gICAgICAgIGlmICh0aGlzLndpZGdldCkge1xuICAgICAgICAgICAgdGhpcy53aWRnZXQuc3RlcHMgPSBuZXdWYWx1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB2YWx1ZXNXYXRjaGVyKG5ld1ZhbHVlKSB7XG4gICAgICAgIGlmICh0eXBlb2YgbmV3VmFsdWUgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgIHRoaXMudmFsdWVzID0gbmV3VmFsdWUuc3BsaXQoXCIsXCIpLm1hcCgobikgPT4gTnVtYmVyKG4pKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy53aWRnZXQpIHtcbiAgICAgICAgICAgIHRoaXMud2lkZ2V0LnZhbHVlcyA9IHRoaXMudmFsdWVzO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvL1xuICAgIC8vICBMaWZlY3ljbGVcbiAgICAvL1xuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICBhc3luYyBjb21wb25lbnREaWRMb2FkKCkge1xuICAgICAgICBjb25zdCBwYXJhbXMgPSB0aGlzLl9jcmVhdGVQYXJhbXMoKTtcbiAgICAgICAgY29uc3Qgd2lkZ2V0ID0gYXdhaXQgbmV3V2lkZ2V0c1NsaWRlcihwYXJhbXMpO1xuICAgICAgICB0aGlzLndpZGdldCA9IHdpZGdldDtcbiAgICAgICAgYXdhaXQgdGhpcy5fYWRkV2F0Y2hlcnMoKTtcbiAgICAgICAgdGhpcy53aWRnZXRSZWFkeS5lbWl0KHsgd2lkZ2V0OiB0aGlzLndpZGdldCB9KTtcbiAgICAgICAgY2hlY2tGb3JWaWV3KHRoaXMpO1xuICAgIH1cbiAgICBkaXNjb25uZWN0ZWRDYWxsYmFjaygpIHtcbiAgICAgICAgb25EaXNjb25uZWN0ZWRIZWxwZXIodGhpcyk7XG4gICAgfVxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgaWYgKHRoaXMuZXhwYW5kYWJsZSkge1xuICAgICAgICAgICAgcmV0dXJuIChoKFwiYXJjZ2lzLWV4cGFuZFwiLCB7IHBvc2l0aW9uOiB0aGlzLnBvc2l0aW9uLCByZWY6IChlbCkgPT4gKHRoaXMuZXhwYW5kRWxlbSA9IGVsKSB9LCBoKFwiZGl2XCIsIHsgcmVmOiAoZWwpID0+ICh0aGlzLmNoaWxkRWxlbSA9IGVsKSB9KSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBoKFwiZGl2XCIsIHsgcmVmOiAoZWwpID0+ICh0aGlzLmNoaWxkRWxlbSA9IGVsKSB9KTtcbiAgICB9XG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vXG4gICAgLy8gIFByaXZhdGUgTWV0aG9kc1xuICAgIC8vXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIGFzeW5jIF9hZGRXYXRjaGVycygpIHtcbiAgICAgICAgY29uc3QgeyB3YXRjaCB9ID0gYXdhaXQgaW1wb3J0Q29yZVJlYWN0aXZlVXRpbHMoKTtcbiAgICAgICAgYWRkSGFuZGxlcyh0aGlzLCB3YXRjaCgoKSA9PiB0aGlzLndpZGdldC5lZmZlY3RpdmVTZWdtZW50RWxlbWVudHMsICh2YWx1ZSkgPT4gKHRoaXMuZWZmZWN0aXZlU2VnbWVudEVsZW1lbnRzID0gdmFsdWUpLCB7XG4gICAgICAgICAgICBpbml0aWFsOiB0cnVlLFxuICAgICAgICB9KSk7XG4gICAgICAgIGFkZEhhbmRsZXModGhpcywgd2F0Y2goKCkgPT4gdGhpcy53aWRnZXQubGFiZWxFbGVtZW50cywgKHZhbHVlKSA9PiAodGhpcy5sYWJlbEVsZW1lbnRzID0gdmFsdWUpLCB7XG4gICAgICAgICAgICBpbml0aWFsOiB0cnVlLFxuICAgICAgICB9KSk7XG4gICAgICAgIGFkZEhhbmRsZXModGhpcywgd2F0Y2goKCkgPT4gdGhpcy53aWRnZXQubWF4TGFiZWxFbGVtZW50LCAodmFsdWUpID0+ICh0aGlzLm1heExhYmVsRWxlbWVudCA9IHZhbHVlKSwge1xuICAgICAgICAgICAgaW5pdGlhbDogdHJ1ZSxcbiAgICAgICAgfSkpO1xuICAgICAgICBhZGRIYW5kbGVzKHRoaXMsIHdhdGNoKCgpID0+IHRoaXMud2lkZ2V0Lm1pbkxhYmVsRWxlbWVudCwgKHZhbHVlKSA9PiAodGhpcy5taW5MYWJlbEVsZW1lbnQgPSB2YWx1ZSksIHtcbiAgICAgICAgICAgIGluaXRpYWw6IHRydWUsXG4gICAgICAgIH0pKTtcbiAgICAgICAgYWRkSGFuZGxlcyh0aGlzLCB3YXRjaCgoKSA9PiB0aGlzLndpZGdldC5zZWdtZW50RWxlbWVudHMsICh2YWx1ZSkgPT4gKHRoaXMuc2VnbWVudEVsZW1lbnRzID0gdmFsdWUpLCB7XG4gICAgICAgICAgICBpbml0aWFsOiB0cnVlLFxuICAgICAgICB9KSk7XG4gICAgICAgIGFkZEhhbmRsZXModGhpcywgd2F0Y2goKCkgPT4gdGhpcy53aWRnZXQudGh1bWJFbGVtZW50cywgKHZhbHVlKSA9PiAodGhpcy50aHVtYkVsZW1lbnRzID0gdmFsdWUpLCB7XG4gICAgICAgICAgICBpbml0aWFsOiB0cnVlLFxuICAgICAgICB9KSk7XG4gICAgICAgIGFkZEhhbmRsZXModGhpcywgd2F0Y2goKCkgPT4gdGhpcy53aWRnZXQudGlja0VsZW1lbnRzLCAodmFsdWUpID0+ICh0aGlzLnRpY2tFbGVtZW50cyA9IHZhbHVlKSwge1xuICAgICAgICAgICAgaW5pdGlhbDogdHJ1ZSxcbiAgICAgICAgfSkpO1xuICAgICAgICBhZGRIYW5kbGVzKHRoaXMsIHdhdGNoKCgpID0+IHRoaXMud2lkZ2V0LnRyYWNrRWxlbWVudCwgKHZhbHVlKSA9PiAodGhpcy50cmFja0VsZW1lbnQgPSB2YWx1ZSksIHtcbiAgICAgICAgICAgIGluaXRpYWw6IHRydWUsXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgX2NyZWF0ZVBhcmFtcygpIHtcbiAgICAgICAgY29uc3QgcGFyYW1zID0ge1xuICAgICAgICAgICAgY29udGFpbmVyOiB0aGlzLmNoaWxkRWxlbSxcbiAgICAgICAgICAgIGxheW91dDogdGhpcy5sYXlvdXQsXG4gICAgICAgIH07XG4gICAgICAgIGlmICh0aGlzLm1pbiAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBwYXJhbXMubWluID0gdGhpcy5taW47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubWF4ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHBhcmFtcy5tYXggPSB0aGlzLm1heDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5zdGVwcykge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiB0aGlzLnN0ZXBzID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zdGVwcyA9IHRoaXMuc3RlcHMuc3BsaXQoXCIsXCIpLm1hcCgobikgPT4gTnVtYmVyKG4pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHBhcmFtcy5zdGVwcyA9IHRoaXMuc3RlcHM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMudmFsdWVzKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHRoaXMudmFsdWVzID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICAgICAgdGhpcy52YWx1ZXMgPSB0aGlzLnZhbHVlcy5zcGxpdChcIixcIikubWFwKChuKSA9PiBOdW1iZXIobikpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcGFyYW1zLnZhbHVlcyA9IHRoaXMudmFsdWVzO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwYXJhbXM7XG4gICAgfVxuICAgIGdldCBlbCgpIHsgcmV0dXJuIGdldEVsZW1lbnQodGhpcyk7IH1cbiAgICBzdGF0aWMgZ2V0IHdhdGNoZXJzKCkgeyByZXR1cm4ge1xuICAgICAgICBcImRyYWdnYWJsZVNlZ21lbnRzRW5hYmxlZFwiOiBbXCJkcmFnZ2FibGVTZWdtZW50c0VuYWJsZWRXYXRjaGVyXCJdLFxuICAgICAgICBcImVmZmVjdGl2ZU1heFwiOiBbXCJlZmZlY3RpdmVNYXhXYXRjaGVyXCJdLFxuICAgICAgICBcImVmZmVjdGl2ZU1pblwiOiBbXCJlZmZlY3RpdmVNaW5XYXRjaGVyXCJdLFxuICAgICAgICBcImxheW91dFwiOiBbXCJsYXlvdXRXYXRjaGVyXCJdLFxuICAgICAgICBcIm1pblwiOiBbXCJtaW5XYXRjaGVyXCJdLFxuICAgICAgICBcIm1heFwiOiBbXCJtYXhXYXRjaGVyXCJdLFxuICAgICAgICBcInByZWNpc2lvblwiOiBbXCJwcmVjaXNpb25XYXRjaGVyXCJdLFxuICAgICAgICBcInJhbmdlTGFiZWxJbnB1dHNFbmFibGVkXCI6IFtcInJhbmdlTGFiZWxJbnB1dHNFbmFibGVkV2F0Y2hlclwiXSxcbiAgICAgICAgXCJzbmFwT25DbGlja0VuYWJsZWRcIjogW1wic25hcE9uQ2xpY2tFbmFibGVkV2F0Y2hlclwiXSxcbiAgICAgICAgXCJzeW5jZWRTZWdtZW50c0VuYWJsZWRcIjogW1wic3luY2VkU2VnbWVudHNFbmFibGVkV2F0Y2hlclwiXSxcbiAgICAgICAgXCJ0aHVtYnNDb25zdHJhaW5lZFwiOiBbXCJ0aHVtYnNDb25zdHJhaW5lZFdhdGNoZXJcIl0sXG4gICAgICAgIFwidGlja0NvbmZpZ3NcIjogW1widGlja0NvbmZpZ3NXYXRjaGVyXCJdLFxuICAgICAgICBcInN0ZXBzXCI6IFtcInN0ZXBzV2F0Y2hlclwiXSxcbiAgICAgICAgXCJ2YWx1ZXNcIjogW1widmFsdWVzV2F0Y2hlclwiXVxuICAgIH07IH1cbn07XG5BcmNnaXNTbGlkZXIuc3R5bGUgPSBzbGlkZXJDc3M7XG5cbmV4cG9ydCB7IEFyY2dpc1NsaWRlciBhcyBhcmNnaXNfc2xpZGVyIH07XG4iLCIvKiFcbiAqIEFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRXNyaSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG4gKiBTZWUgaHR0cHM6Ly9qcy5hcmNnaXMuY29tLzQuMzAvZXNyaS9jb3B5cmlnaHQudHh0IGZvciBkZXRhaWxzLlxuICogdjQuMzAuMC1uZXh0LjM3XG4gKi9cbmZ1bmN0aW9uIGNoZWNrRm9yRXhwYW5kKGVsZW1lbnQpIHtcbiAgICBjb25zdCBleHBhbmRSZWYgPSBlbGVtZW50LmVsLmNsb3Nlc3QoXCJhcmNnaXMtZXhwYW5kXCIpID8/IGVsZW1lbnQuZXhwYW5kRWxlbTtcbiAgICBpZiAoZXhwYW5kUmVmPy53aWRnZXQpIHtcbiAgICAgICAgZWxlbWVudC52aWV3ID0gZXhwYW5kUmVmLnZpZXc7XG4gICAgICAgIGV4cGFuZFJlZi53aWRnZXQuY29udGVudCA9IGVsZW1lbnQuY2hpbGRFbGVtID8/IGVsZW1lbnQuZWw7XG4gICAgICAgIC8vIFRPRE86IFVwZGF0ZSB0byBiZSBleHBhbmRJY29uID0gd2lkZ2V0Lmljb24sIG5vdCByZWFkeSB5ZXQgaW4gNC4yN25leHRcbiAgICAgICAgaWYgKCFleHBhbmRSZWYuZXhwYW5kSWNvbikge1xuICAgICAgICAgICAgZXhwYW5kUmVmLndpZGdldC5leHBhbmRJY29uID0gZWxlbWVudC53aWRnZXQgPyBlbGVtZW50LndpZGdldC5pY29uIDogZWxlbWVudD8uaWNvbjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgaWYgKGV4cGFuZFJlZikge1xuICAgICAgICBjb25zdCB3aWRnZXRIYW5kbGVyID0gKCkgPT4ge1xuICAgICAgICAgICAgZXhwYW5kUmVmLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJhcmNnaXNFeHBhbmRSZWFkeVwiLCB3aWRnZXRIYW5kbGVyLCBmYWxzZSk7XG4gICAgICAgICAgICBlbGVtZW50LnZpZXcgPSBleHBhbmRSZWYudmlldztcbiAgICAgICAgICAgIGV4cGFuZFJlZi53aWRnZXQuY29udGVudCA9IGVsZW1lbnQuY2hpbGRFbGVtID8/IGVsZW1lbnQuZWw7XG4gICAgICAgICAgICBpZiAoIWV4cGFuZFJlZi5leHBhbmRJY29uKSB7XG4gICAgICAgICAgICAgICAgZXhwYW5kUmVmLndpZGdldC5leHBhbmRJY29uID0gZWxlbWVudC53aWRnZXQgPyBlbGVtZW50LndpZGdldC5pY29uIDogZWxlbWVudD8uaWNvbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgZXhwYW5kUmVmLmFkZEV2ZW50TGlzdGVuZXIoXCJhcmNnaXNFeHBhbmRSZWFkeVwiLCB3aWRnZXRIYW5kbGVyLCBmYWxzZSk7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG59XG5cbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vXG4vLyAgUHVibGljIE1ldGhvZHNcbi8vXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5mdW5jdGlvbiBhZGRIYW5kbGVzKGVsZW1lbnQsIGhhbmRsZSkge1xuICAgIGlmIChBcnJheS5pc0FycmF5KGhhbmRsZSkpIHtcbiAgICAgICAgZWxlbWVudC5fd2F0Y2hIYW5kbGVzID0gWy4uLmVsZW1lbnQuX3dhdGNoSGFuZGxlcywgLi4uaGFuZGxlXTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGVsZW1lbnQuX3dhdGNoSGFuZGxlcy5wdXNoKGhhbmRsZSk7XG4gICAgfVxufVxuZnVuY3Rpb24gY2hlY2tGb3JWaWV3KGVsZW1lbnQpIHtcbiAgICBsZXQgaXNVc2luZ1JlZmVyZW5jZUVsZW1lbnQgPSBmYWxzZTtcbiAgICBpZiAoIWNoZWNrRm9yRXhwYW5kKGVsZW1lbnQpKSB7XG4gICAgICAgIGxldCB2aWV3UmVmID0gZWxlbWVudC5lbC5jbG9zZXN0KFwiYXJjZ2lzLW1hcFwiKSA/PyBlbGVtZW50LmVsLmNsb3Nlc3QoXCJhcmNnaXMtc2NlbmVcIik7XG4gICAgICAgIGlmICghdmlld1JlZiAmJiB0eXBlb2YgZWxlbWVudC5yZWZlcmVuY2VFbGVtZW50ID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICB2aWV3UmVmID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihlbGVtZW50LnJlZmVyZW5jZUVsZW1lbnQpO1xuICAgICAgICAgICAgaXNVc2luZ1JlZmVyZW5jZUVsZW1lbnQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh2aWV3UmVmPy52aWV3KSB7XG4gICAgICAgICAgICBlbGVtZW50LnZpZXcgPSB2aWV3UmVmLnZpZXc7XG4gICAgICAgICAgICBjb25zdCBlbCA9IGVsZW1lbnQuY2hpbGRFbGVtID8/IGVsZW1lbnQuZWw7XG4gICAgICAgICAgICBpZiAoIWlzVXNpbmdSZWZlcmVuY2VFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgZWxlbWVudC52aWV3LnVpLmFkZChlbCwgZWxlbWVudC5wb3NpdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodmlld1JlZikge1xuICAgICAgICAgICAgd2FpdEZvclZpZXdIYW5kbGVyKHZpZXdSZWYsIGVsZW1lbnQsIGlzVXNpbmdSZWZlcmVuY2VFbGVtZW50KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgY29uc3Qgdmlld1JlZiA9IGVsZW1lbnQuZWwuY2xvc2VzdChcImFyY2dpcy1tYXBcIikgPz8gZWxlbWVudC5lbC5jbG9zZXN0KFwiYXJjZ2lzLXNjZW5lXCIpO1xuICAgICAgICBpZiAodmlld1JlZj8udmlldykge1xuICAgICAgICAgICAgZWxlbWVudC52aWV3ID0gdmlld1JlZi52aWV3O1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHZpZXdSZWYpIHtcbiAgICAgICAgICAgIGNvbnN0IGhhbmRsZXIgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdmlld1JlZi5yZW1vdmVFdmVudExpc3RlbmVyKFwiYXJjZ2lzVmlld1JlYWR5Q2hhbmdlXCIsIGhhbmRsZXIsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICBlbGVtZW50LnZpZXcgPSB2aWV3UmVmLnZpZXc7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdmlld1JlZi5hZGRFdmVudExpc3RlbmVyKFwiYXJjZ2lzVmlld1JlYWR5Q2hhbmdlXCIsIGhhbmRsZXIsIGZhbHNlKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbmZ1bmN0aW9uIGlzTnVsbE9yRW1wdHlTdHJpbmcodmFsdWUpIHtcbiAgICByZXR1cm4gdmFsdWUgPT09IHVuZGVmaW5lZCB8fCB2YWx1ZSA9PT0gbnVsbCB8fCB2YWx1ZSA9PT0gXCJcIjtcbn1cbmZ1bmN0aW9uIGlzVmFsaWRJbnRlZ2VyKHZhbHVlKSB7XG4gICAgcmV0dXJuIHZhbHVlICE9IG51bGwgJiYgdmFsdWUgJSAxID09PSAwO1xufVxuZnVuY3Rpb24gaXNOb3RTYW1lQ2FtZXJhKGNhbWVyYSwgY2FtZXJhMikge1xuICAgIHJldHVybiAoY2FtZXJhMiA9PT0gdW5kZWZpbmVkIHx8XG4gICAgICAgIGNhbWVyYS5wb3NpdGlvbiAhPT0gY2FtZXJhMi5wb3NpdGlvbiB8fFxuICAgICAgICBjYW1lcmEuaGVhZGluZyAhPT0gY2FtZXJhMi5oZWFkaW5nIHx8XG4gICAgICAgIGNhbWVyYS50aWx0ICE9PSBjYW1lcmEyLnRpbHQpO1xufVxuZnVuY3Rpb24gaXNOb3RTYW1lRW52aXJvbm1lbnQoZW52aXJvbm1lbnQsIGVudmlyb25tZW50Mikge1xuICAgIHJldHVybiAoZW52aXJvbm1lbnQyID09PSB1bmRlZmluZWQgfHxcbiAgICAgICAgZW52aXJvbm1lbnQyLmF0bW9zcGhlcmVFbmFibGVkICE9PSBlbnZpcm9ubWVudC5hdG1vc3BoZXJlRW5hYmxlZCB8fFxuICAgICAgICBlbnZpcm9ubWVudDIubGlnaHRpbmcuZGF0ZSAhPT0gZW52aXJvbm1lbnQubGlnaHRpbmcuZGF0ZSB8fFxuICAgICAgICBlbnZpcm9ubWVudDIubGlnaHRpbmcuZGlyZWN0U2hhZG93c0VuYWJsZWQgIT09XG4gICAgICAgICAgICBlbnZpcm9ubWVudC5saWdodGluZy5kaXJlY3RTaGFkb3dzRW5hYmxlZCB8fFxuICAgICAgICBlbnZpcm9ubWVudDIubGlnaHRpbmcuY2FtZXJhVHJhY2tpbmdFbmFibGVkICE9PVxuICAgICAgICAgICAgZW52aXJvbm1lbnQubGlnaHRpbmcuY2FtZXJhVHJhY2tpbmdFbmFibGVkIHx8XG4gICAgICAgIGVudmlyb25tZW50Mi5saWdodGluZy5kYXRlICE9PSBlbnZpcm9ubWVudC5saWdodGluZy5kYXRlIHx8XG4gICAgICAgIGVudmlyb25tZW50Mi5saWdodGluZy5kaXNwbGF5VVRDT2Zmc2V0ICE9PVxuICAgICAgICAgICAgZW52aXJvbm1lbnQubGlnaHRpbmcuZGlzcGxheVVUQ09mZnNldCk7XG59XG5mdW5jdGlvbiBpc05vdFNhbWVWaWV3cG9pbnQodmlld3BvaW50LCB2aWV3cG9pbnQyKSB7XG4gICAgcmV0dXJuICh2aWV3cG9pbnQyID09PSB1bmRlZmluZWQgfHxcbiAgICAgICAgdmlld3BvaW50LnRhcmdldEdlb21ldHJ5ICE9PSB2aWV3cG9pbnQyLnRhcmdldEdlb21ldHJ5IHx8XG4gICAgICAgIHZpZXdwb2ludC5yb3RhdGlvbiAhPT0gdmlld3BvaW50Mi5yb3RhdGlvbiB8fFxuICAgICAgICB2aWV3cG9pbnQuc2NhbGUgIT09IHZpZXdwb2ludDIuc2NhbGUpO1xufVxuYXN5bmMgZnVuY3Rpb24gdXBkYXRlRm9yVmlldyh2aWV3U3RyKSB7XG4gICAgY29uc3Qgdmlld1JlZiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Iodmlld1N0cik7XG4gICAgcmV0dXJuIGF3YWl0IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgICAgIGlmICh2aWV3UmVmPy52aWV3ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJlc29sdmUodmlld1JlZi52aWV3KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh2aWV3UmVmKSB7XG4gICAgICAgICAgICBjb25zdCBoYW5kbGVyID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgIHZpZXdSZWYucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImFyY2dpc1ZpZXdSZWFkeUNoYW5nZVwiLCBoYW5kbGVyLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZSh2aWV3UmVmLnZpZXcpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZpZXdSZWYuYWRkRXZlbnRMaXN0ZW5lcihcImFyY2dpc1ZpZXdSZWFkeUNoYW5nZVwiLCBoYW5kbGVyLCBmYWxzZSk7XG4gICAgICAgIH1cbiAgICB9KTtcbn1cbmFzeW5jIGZ1bmN0aW9uIHJlZmVyZW5jZUVsZW1lbnRIZWxwZXIoZWxlbWVudCwgcmVmRWxlbWVudCkge1xuICAgIGlmIChyZWZFbGVtZW50ID09PSB1bmRlZmluZWQpXG4gICAgICAgIHJldHVybjtcbiAgICBlbHNlIGlmICh0eXBlb2YgcmVmRWxlbWVudCA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICBlbGVtZW50LnZpZXcgPSBhd2FpdCB1cGRhdGVGb3JWaWV3KHJlZkVsZW1lbnQpO1xuICAgIH1cbiAgICBlbHNlIGlmIChlbGVtZW50LndpZGdldCkge1xuICAgICAgICBlbGVtZW50LnZpZXcgPSByZWZFbGVtZW50LnZpZXc7XG4gICAgfVxufVxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy9cbi8vICBQcml2YXRlIE1ldGhvZHNcbi8vXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5mdW5jdGlvbiB3YWl0Rm9yVmlld0hhbmRsZXIodmlld1JlZiwgZWxlbWVudCwgaXNVc2luZ1JlZmVybmNlRWxlbWVudCkge1xuICAgIGNvbnN0IGhhbmRsZXIgPSAoKSA9PiB7XG4gICAgICAgIHZpZXdSZWYucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImFyY2dpc1ZpZXdSZWFkeUNoYW5nZVwiLCBoYW5kbGVyLCBmYWxzZSk7XG4gICAgICAgIGVsZW1lbnQudmlldyA9IHZpZXdSZWYudmlldztcbiAgICAgICAgaWYgKCFpc1VzaW5nUmVmZXJuY2VFbGVtZW50KSB7XG4gICAgICAgICAgICBlbGVtZW50LnZpZXcudWkuYWRkKGVsZW1lbnQuY2hpbGRFbGVtID8/IGVsZW1lbnQuZWwsIGVsZW1lbnQucG9zaXRpb24pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICB2aWV3UmVmLmFkZEV2ZW50TGlzdGVuZXIoXCJhcmNnaXNWaWV3UmVhZHlDaGFuZ2VcIiwgaGFuZGxlciwgZmFsc2UpO1xufVxuXG5leHBvcnQgeyBhZGRIYW5kbGVzIGFzIGEsIGlzTm90U2FtZVZpZXdwb2ludCBhcyBiLCBjaGVja0ZvclZpZXcgYXMgYywgY2hlY2tGb3JFeHBhbmQgYXMgZCwgaXNOb3RTYW1lQ2FtZXJhIGFzIGUsIGlzTm90U2FtZUVudmlyb25tZW50IGFzIGYsIGlzVmFsaWRJbnRlZ2VyIGFzIGcsIGlzTnVsbE9yRW1wdHlTdHJpbmcgYXMgaSwgcmVmZXJlbmNlRWxlbWVudEhlbHBlciBhcyByIH07XG4iLCIvKiFcbiAqIEFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRXNyaSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG4gKiBTZWUgaHR0cHM6Ly9qcy5hcmNnaXMuY29tLzQuMzAvZXNyaS9jb3B5cmlnaHQudHh0IGZvciBkZXRhaWxzLlxuICogdjQuMzAuMC1uZXh0LjM3XG4gKi9cbmZ1bmN0aW9uIG9uRGlzY29ubmVjdGVkSGVscGVyKGVsZW1lbnQpIHtcbiAgICBpZiAoZWxlbWVudC5jaGlsZEVsZW0pIHtcbiAgICAgICAgaWYgKCFlbGVtZW50LmVsLmlzQ29ubmVjdGVkKSB7XG4gICAgICAgICAgICBpZiAoZWxlbWVudC52aWV3KSB7XG4gICAgICAgICAgICAgICAgZWxlbWVudC52aWV3LnVpLnJlbW92ZShlbGVtZW50LmNoaWxkRWxlbSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChlbGVtZW50LndpZGdldD8udmlldykge1xuICAgICAgICAgICAgICAgIGVsZW1lbnQud2lkZ2V0LnZpZXcudWkucmVtb3ZlKGVsZW1lbnQuY2hpbGRFbGVtKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChlbGVtZW50Ll93YXRjaEhhbmRsZXMpIHtcbiAgICAgICAgICAgICAgICBlbGVtZW50Ll93YXRjaEhhbmRsZXMuZm9yRWFjaCgoaGFuZGxlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGhhbmRsZS5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsZW1lbnQuX3dhdGNoSGFuZGxlcyA9IFtdO1xuICAgICAgICAgICAgZWxlbWVudC53aWRnZXQ/LmRlc3Ryb3koKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICBpZiAoIWVsZW1lbnQuZWwuaXNDb25uZWN0ZWQpIHtcbiAgICAgICAgICAgICAgICBpZiAoZWxlbWVudC52aWV3KSB7XG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQudmlldy51aS5yZW1vdmUoZWxlbWVudC5lbCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGVsZW1lbnQud2lkZ2V0Py52aWV3KSB7XG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQud2lkZ2V0LnZpZXcudWkucmVtb3ZlKGVsZW1lbnQuZWwpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoZWxlbWVudC5fd2F0Y2hIYW5kbGVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuX3dhdGNoSGFuZGxlcy5mb3JFYWNoKChoYW5kbGUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZS5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsZW1lbnQuX3dhdGNoSGFuZGxlcyA9IFtdO1xuICAgICAgICAgICAgICAgIGVsZW1lbnQud2lkZ2V0Py5kZXN0cm95KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIDEwMDApO1xuICAgIH1cbn1cblxuZXhwb3J0IHsgb25EaXNjb25uZWN0ZWRIZWxwZXIgYXMgbyB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9