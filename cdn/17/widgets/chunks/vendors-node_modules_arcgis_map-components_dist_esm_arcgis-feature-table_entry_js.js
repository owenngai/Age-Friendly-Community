"use strict";
(self["webpackChunkexb_client"] = self["webpackChunkexb_client"] || []).push([["vendors-node_modules_arcgis_map-components_dist_esm_arcgis-feature-table_entry_js"],{

/***/ "./node_modules/@arcgis/map-components/dist/esm/arcgis-feature-table.entry.js":
/*!************************************************************************************!*\
  !*** ./node_modules/@arcgis/map-components/dist/esm/arcgis-feature-table.entry.js ***!
  \************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   arcgis_feature_table: () => (/* binding */ ArcgisFeatureTable)
/* harmony export */ });
/* harmony import */ var _index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-6e172aac.js */ "./node_modules/@arcgis/map-components/dist/esm/index-6e172aac.js");
/* harmony import */ var _index_0bc55ca5_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./index-0bc55ca5.js */ "./node_modules/@arcgis/map-components/dist/esm/index-0bc55ca5.js");
/* harmony import */ var _component_utils_23194f7c_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./component-utils-23194f7c.js */ "./node_modules/@arcgis/map-components/dist/esm/component-utils-23194f7c.js");
/* harmony import */ var _disconnected_6cf1c100_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./disconnected-6cf1c100.js */ "./node_modules/@arcgis/map-components/dist/esm/disconnected-6cf1c100.js");
/*!
 * All material copyright Esri, All Rights Reserved, unless otherwise specified.
 * See https://js.arcgis.com/4.30/esri/copyright.txt for details.
 * v4.30.0-next.37
 */





const featureTableCss = ".arcgis-feature-table{width:100%;height:100%}";

const ArcgisFeatureTable = class {
    constructor(hostRef) {
        (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);
        this.arcgisFeatureTableReady = (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "arcgisFeatureTableReady", 7);
        this.featureTableSelectionChange = (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "featureTableSelectionChange", 7);
        this._watchHandles = [];
        this.referenceElement = undefined;
        this.activeFilters = undefined;
        this.activeSortOrders = [];
        this.attachmentsEnabled = false;
        this.autoRefreshEnabled = true;
        this.columnReorderingEnabled = true;
        this.columns = undefined;
        this.editingEnabled = false;
        this.filterGeometry = undefined;
        this.hiddenFields = true;
        this.highlightEnabled = true;
        this.highlightIds = undefined;
        this.layer = undefined;
        this.menuConfig = undefined;
        this.multiSortEnabled = false;
        this.pageSize = 50;
        this.returnGeometryEnabled = false;
        this.state = undefined;
        this.tableTemplate = undefined;
        this.timeZone = undefined;
        this.itemId = undefined;
        this.url = undefined;
        this.visibleElementsHeader = true;
        this.visibleElementsMenu = true;
        this.visibleElementsSelectionColumn = true;
        this.visibleElementsColumnMenus = true;
        this.visibleElementsMenuItemsClearSelection = true;
        this.visibleElementsMenuItemsDeleteSelection = true;
        this.visibleElementsMenuItemsRefreshData = true;
        this.visibleElementsMenuItemsSelectedRecordsShowAllToggle = true;
        this.visibleElementsMenuItemsToggleColumns = true;
        this.visibleElementsMenuItemsZoomToSelection = true;
        this.view = undefined;
        this.widget = undefined;
    }
    referenceElementWatcher(value) {
        void (0,_component_utils_23194f7c_js__WEBPACK_IMPORTED_MODULE_2__.r)(this, value);
    }
    attachmentsEnabledWatcher(value) {
        if (value !== undefined && this.widget) {
            this.widget.attachmentsEnabled = value;
        }
    }
    autoRefreshEnabledWatcher(value) {
        if (value !== undefined && this.widget) {
            this.widget.autoRefreshEnabled = value;
        }
    }
    columnReorderingEnabledWatcher(value) {
        if (value !== undefined && this.widget) {
            this.widget.columnReorderingEnabled = value;
        }
    }
    editingEnabledWatcher(value) {
        if (value !== undefined && this.widget) {
            this.widget.editingEnabled = value;
        }
    }
    filterGeometryWatcher(value) {
        if (value && this.widget) {
            this.widget.filterGeometry = value;
        }
    }
    hiddenFieldsWatcher(value) {
        if (value && this.widget) {
            this.widget.hiddenFields = value;
        }
    }
    highlightEnabledWatcher(value) {
        if (value !== undefined && this.widget) {
            this.widget.highlightEnabled = value;
        }
    }
    highlightIdsWatcher(value) {
        if (value && this.widget) {
            this.widget.highlightIds = value;
        }
    }
    layerWatcher(value) {
        if (value && this.widget) {
            this.widget.layer = value;
        }
        else if (!value) {
            this.widget.layer = null;
        }
    }
    menuConfigWatcher(value) {
        if (value && this.widget) {
            this.widget.menuConfig = value;
        }
    }
    multiSortEnabledWatcher(value) {
        if (value !== undefined && this.widget) {
            this.widget.multiSortEnabled = value;
        }
    }
    pageSizeWatcher(value) {
        if (value !== undefined && this.widget) {
            this.widget.pageSize = value;
        }
    }
    returnGeometryEnabledWatcher(value) {
        if (value !== undefined && this.widget) {
            this.widget.returnGeometryEnabled = value;
        }
    }
    tableTemplateWatcher(value) {
        if (value && this.widget) {
            this.widget.tableTemplate = value;
        }
    }
    timeZoneWatcher(value) {
        if (this.widget) {
            this.widget.timeZone = value;
        }
    }
    async itemIdWatcher(value, old) {
        if ((0,_component_utils_23194f7c_js__WEBPACK_IMPORTED_MODULE_2__.i)(value)) {
            this.layer = null;
        }
        else if (value && value !== old) {
            const layer = await (0,_index_0bc55ca5_js__WEBPACK_IMPORTED_MODULE_1__.z)({
                portalItem: {
                    id: value,
                },
            });
            this.layer = layer;
        }
    }
    async urlWatcher(value, old) {
        if (value && value !== old) {
            const layer = await (0,_index_0bc55ca5_js__WEBPACK_IMPORTED_MODULE_1__.z)({ url: value });
            this.layer = layer;
        }
    }
    visibleElementsHeaderWatcher(value) {
        if (this.widget) {
            this.widget.visibleElements = {
                ...this.widget.visibleElements,
                header: value,
            };
        }
    }
    visibleElementsMenuWatcher(value) {
        if (this.widget) {
            this.widget.visibleElements = {
                ...this.widget.visibleElements,
                menu: value,
            };
        }
    }
    visibleElementsSelectionColumnWatcher(value) {
        if (this.widget) {
            this.widget.visibleElements = {
                ...this.widget.visibleElements,
                selectionColumn: value,
            };
        }
    }
    visibleElementsColumnMenusWatcher(value) {
        if (this.widget) {
            this.widget.visibleElements = {
                ...this.widget.visibleElements,
                columnMenus: value,
            };
        }
    }
    visibleElementsMenuItemsClearSelectionWatcher(value) {
        if (this.widget) {
            this.widget.visibleElements = {
                ...this.widget.visibleElements,
                menuItems: {
                    ...this.widget.visibleElements.menuItems,
                    clearSelection: value,
                },
            };
        }
    }
    visibleElementsMenuItemsDeleteSelectionWatcher(value) {
        if (this.widget) {
            this.widget.visibleElements = {
                ...this.widget.visibleElements,
                menuItems: {
                    ...this.widget.visibleElements.menuItems,
                    deleteSelection: value,
                },
            };
        }
    }
    visibleElementsMenuItemsRefreshDataWatcher(value) {
        if (this.widget) {
            this.widget.visibleElements = {
                ...this.widget.visibleElements,
                menuItems: {
                    ...this.widget.visibleElements.menuItems,
                    refreshData: value,
                },
            };
        }
    }
    visibleElementsMenuItemsSelectedRecordsShowAllToggleWatcher(value) {
        if (this.widget) {
            this.widget.visibleElements = {
                ...this.widget.visibleElements,
                menuItems: {
                    ...this.widget.visibleElements.menuItems,
                    selectedRecordsShowAllToggle: value,
                },
            };
        }
    }
    visibleElementsMenuItemsToggleColumnsWatcher(value) {
        if (this.widget) {
            this.widget.visibleElements = {
                ...this.widget.visibleElements,
                menuItems: {
                    ...this.widget.visibleElements.menuItems,
                    toggleColumns: value,
                },
            };
        }
    }
    visibleElementsMenuItemsZoomToSelectionWatcher(value) {
        if (this.widget) {
            this.widget.visibleElements = {
                ...this.widget.visibleElements,
                menuItems: {
                    ...this.widget.visibleElements.menuItems,
                    zoomToSelection: value,
                },
            };
        }
    }
    viewWatcher(value) {
        if (value !== undefined && this.widget) {
            this.widget.view = value;
        }
    }
    //--------------------------------------------------------------------------
    //
    //  Methods
    //
    //--------------------------------------------------------------------------
    async clearSelectionFilter() {
        this.widget?.clearSelectionFilter();
    }
    async deleteSelection(showWarningPrompt) {
        await this.widget?.deleteSelection(showWarningPrompt);
    }
    async filterBySelection() {
        this.widget?.filterBySelection();
    }
    async findColumn(fieldName) {
        return this.widget?.findColumn(fieldName);
    }
    async hideColumn(fieldName) {
        this.widget?.hideColumn(fieldName);
    }
    async refresh() {
        await this.widget?.refresh();
    }
    async scrollToIndex(index) {
        this.widget?.scrollToIndex(index);
    }
    async showAllColumns() {
        this.widget?.showAllColumns();
    }
    async showColumn(fieldName) {
        this.widget?.showColumn(fieldName);
    }
    async sortColumn(path, direction) {
        this.widget?.sortColumn(path, direction);
    }
    async zoomToSelection() {
        this.widget?.zoomToSelection();
    }
    //--------------------------------------------------------------------------
    //
    //  Lifecycle
    //
    //--------------------------------------------------------------------------
    async componentDidLoad() {
        const params = await this._createParams();
        const widget = await (0,_index_0bc55ca5_js__WEBPACK_IMPORTED_MODULE_1__.A)(params);
        this.widget = widget;
        await this._addWatchers();
        this._proxyEvents();
        this._addContainer();
        this.arcgisFeatureTableReady.emit();
        (0,_component_utils_23194f7c_js__WEBPACK_IMPORTED_MODULE_2__.c)(this);
    }
    disconnectedCallback() {
        (0,_disconnected_6cf1c100_js__WEBPACK_IMPORTED_MODULE_3__.o)(this);
    }
    render() {
        return (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "arcgis-feature-table", ref: (el) => (this.childElem = el) });
    }
    //--------------------------------------------------------------------------
    //
    //  Private Methods
    //
    //--------------------------------------------------------------------------
    _addContainer() {
        this.widget.container = this.childElem;
    }
    async _addWatchers() {
        const { watch } = await (0,_index_0bc55ca5_js__WEBPACK_IMPORTED_MODULE_1__.i)();
        (0,_component_utils_23194f7c_js__WEBPACK_IMPORTED_MODULE_2__.a)(this, watch(() => this.widget.activeFilters, (value) => (this.activeFilters = value), {
            initial: true,
        }));
        (0,_component_utils_23194f7c_js__WEBPACK_IMPORTED_MODULE_2__.a)(this, watch(() => this.widget.activeSortOrders, (value) => (this.activeSortOrders = value), {
            initial: true,
        }));
        (0,_component_utils_23194f7c_js__WEBPACK_IMPORTED_MODULE_2__.a)(this, watch(() => this.widget.columns, (value) => (this.columns = value), {
            initial: true,
        }));
        (0,_component_utils_23194f7c_js__WEBPACK_IMPORTED_MODULE_2__.a)(this, watch(() => this.widget.state, (value) => (this.state = value), {
            initial: true,
        }));
    }
    async _createParams() {
        const params = {};
        params.visibleElements = {
            header: this.visibleElementsHeader,
            menu: this.visibleElementsMenu,
            selectionColumn: this.visibleElementsSelectionColumn,
            columnMenus: this.visibleElementsColumnMenus,
            menuItems: {
                clearSelection: this.visibleElementsMenuItemsClearSelection,
                deleteSelection: this.visibleElementsMenuItemsDeleteSelection,
                refreshData: this.visibleElementsMenuItemsRefreshData,
                selectedRecordsShowAllToggle: this.visibleElementsMenuItemsSelectedRecordsShowAllToggle,
                toggleColumns: this.visibleElementsMenuItemsToggleColumns,
                zoomToSelection: this.visibleElementsMenuItemsZoomToSelection,
            },
        };
        if (this.view) {
            params.view = this.view;
        }
        if (this.attachmentsEnabled !== undefined) {
            params.attachmentsEnabled = this.attachmentsEnabled;
        }
        if (this.autoRefreshEnabled !== undefined) {
            params.autoRefreshEnabled = this.autoRefreshEnabled;
        }
        if (this.columnReorderingEnabled !== undefined) {
            params.columnReorderingEnabled = this.columnReorderingEnabled;
        }
        if (this.editingEnabled !== undefined) {
            params.editingEnabled = this.editingEnabled;
        }
        if (this.filterGeometry !== undefined) {
            params.filterGeometry = this.filterGeometry;
        }
        if (this.hiddenFields !== undefined) {
            params.hiddenFields = this.hiddenFields;
        }
        if (this.highlightEnabled !== undefined) {
            params.highlightEnabled = this.highlightEnabled;
        }
        if (this.highlightIds !== undefined) {
            params.highlightIds = this.highlightIds;
        }
        if (this.menuConfig !== undefined) {
            params.menuConfig = this.menuConfig;
        }
        if (this.multiSortEnabled !== undefined) {
            params.multiSortEnabled = this.multiSortEnabled;
        }
        if (this.pageSize !== undefined) {
            params.pageSize = this.pageSize;
        }
        if (this.tableTemplate !== undefined) {
            params.tableTemplate = this.tableTemplate;
        }
        if (this.timeZone !== undefined) {
            params.timeZone = this.timeZone;
        }
        // Handle loading a layer, url, or itemId
        if (this.layer !== undefined) {
            params.layer = this.layer;
        }
        else if (this.url) {
            params.layer = await (0,_index_0bc55ca5_js__WEBPACK_IMPORTED_MODULE_1__.z)({ url: this.url });
        }
        else if (this.itemId) {
            params.layer = await (0,_index_0bc55ca5_js__WEBPACK_IMPORTED_MODULE_1__.z)({
                portalItem: {
                    id: this.itemId,
                },
            });
        }
        return params;
    }
    _proxyEvents() {
        this.widget?.highlightIds.on("change", (e) => this.featureTableSelectionChange.emit(e));
    }
    get el() { return (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.g)(this); }
    static get watchers() { return {
        "referenceElement": ["referenceElementWatcher"],
        "attachmentsEnabled": ["attachmentsEnabledWatcher"],
        "autoRefreshEnabled": ["autoRefreshEnabledWatcher"],
        "columnReorderingEnabled": ["columnReorderingEnabledWatcher"],
        "editingEnabled": ["editingEnabledWatcher"],
        "filterGeometry": ["filterGeometryWatcher"],
        "hiddenFields": ["hiddenFieldsWatcher"],
        "highlightEnabled": ["highlightEnabledWatcher"],
        "highlightIds": ["highlightIdsWatcher"],
        "layer": ["layerWatcher"],
        "menuConfig": ["menuConfigWatcher"],
        "multiSortEnabled": ["multiSortEnabledWatcher"],
        "pageSize": ["pageSizeWatcher"],
        "returnGeometryEnabled": ["returnGeometryEnabledWatcher"],
        "tableTemplate": ["tableTemplateWatcher"],
        "timeZone": ["timeZoneWatcher"],
        "itemId": ["itemIdWatcher"],
        "url": ["urlWatcher"],
        "visibleElementsHeader": ["visibleElementsHeaderWatcher"],
        "visibleElementsMenu": ["visibleElementsMenuWatcher"],
        "visibleElementsSelectionColumn": ["visibleElementsSelectionColumnWatcher"],
        "visibleElementsColumnMenus": ["visibleElementsColumnMenusWatcher"],
        "visibleElementsMenuItemsClearSelection": ["visibleElementsMenuItemsClearSelectionWatcher"],
        "visibleElementsMenuItemsDeleteSelection": ["visibleElementsMenuItemsDeleteSelectionWatcher"],
        "visibleElementsMenuItemsRefreshData": ["visibleElementsMenuItemsRefreshDataWatcher"],
        "visibleElementsMenuItemsSelectedRecordsShowAllToggle": ["visibleElementsMenuItemsSelectedRecordsShowAllToggleWatcher"],
        "visibleElementsMenuItemsToggleColumns": ["visibleElementsMenuItemsToggleColumnsWatcher"],
        "visibleElementsMenuItemsZoomToSelection": ["visibleElementsMenuItemsZoomToSelectionWatcher"],
        "view": ["viewWatcher"]
    }; }
};
ArcgisFeatureTable.style = featureTableCss;




/***/ }),

/***/ "./node_modules/@arcgis/map-components/dist/esm/component-utils-23194f7c.js":
/*!**********************************************************************************!*\
  !*** ./node_modules/@arcgis/map-components/dist/esm/component-utils-23194f7c.js ***!
  \**********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   a: () => (/* binding */ addHandles),
/* harmony export */   b: () => (/* binding */ isNotSameViewpoint),
/* harmony export */   c: () => (/* binding */ checkForView),
/* harmony export */   d: () => (/* binding */ checkForExpand),
/* harmony export */   e: () => (/* binding */ isNotSameCamera),
/* harmony export */   f: () => (/* binding */ isNotSameEnvironment),
/* harmony export */   g: () => (/* binding */ isValidInteger),
/* harmony export */   i: () => (/* binding */ isNullOrEmptyString),
/* harmony export */   r: () => (/* binding */ referenceElementHelper)
/* harmony export */ });
/*!
 * All material copyright Esri, All Rights Reserved, unless otherwise specified.
 * See https://js.arcgis.com/4.30/esri/copyright.txt for details.
 * v4.30.0-next.37
 */
function checkForExpand(element) {
    const expandRef = element.el.closest("arcgis-expand") ?? element.expandElem;
    if (expandRef?.widget) {
        element.view = expandRef.view;
        expandRef.widget.content = element.childElem ?? element.el;
        // TODO: Update to be expandIcon = widget.icon, not ready yet in 4.27next
        if (!expandRef.expandIcon) {
            expandRef.widget.expandIcon = element.widget ? element.widget.icon : element?.icon;
        }
        return true;
    }
    if (expandRef) {
        const widgetHandler = () => {
            expandRef.removeEventListener("arcgisExpandReady", widgetHandler, false);
            element.view = expandRef.view;
            expandRef.widget.content = element.childElem ?? element.el;
            if (!expandRef.expandIcon) {
                expandRef.widget.expandIcon = element.widget ? element.widget.icon : element?.icon;
            }
        };
        expandRef.addEventListener("arcgisExpandReady", widgetHandler, false);
        return true;
    }
    return false;
}

//--------------------------------------------------------------------------
//
//  Public Methods
//
//--------------------------------------------------------------------------
function addHandles(element, handle) {
    if (Array.isArray(handle)) {
        element._watchHandles = [...element._watchHandles, ...handle];
    }
    else {
        element._watchHandles.push(handle);
    }
}
function checkForView(element) {
    let isUsingReferenceElement = false;
    if (!checkForExpand(element)) {
        let viewRef = element.el.closest("arcgis-map") ?? element.el.closest("arcgis-scene");
        if (!viewRef && typeof element.referenceElement === "string") {
            viewRef = document.querySelector(element.referenceElement);
            isUsingReferenceElement = true;
        }
        if (viewRef?.view) {
            element.view = viewRef.view;
            const el = element.childElem ?? element.el;
            if (!isUsingReferenceElement) {
                element.view.ui.add(el, element.position);
            }
        }
        else if (viewRef) {
            waitForViewHandler(viewRef, element, isUsingReferenceElement);
        }
    }
    else {
        const viewRef = element.el.closest("arcgis-map") ?? element.el.closest("arcgis-scene");
        if (viewRef?.view) {
            element.view = viewRef.view;
        }
        else if (viewRef) {
            const handler = () => {
                viewRef.removeEventListener("arcgisViewReadyChange", handler, false);
                element.view = viewRef.view;
            };
            viewRef.addEventListener("arcgisViewReadyChange", handler, false);
        }
    }
}
function isNullOrEmptyString(value) {
    return value === undefined || value === null || value === "";
}
function isValidInteger(value) {
    return value != null && value % 1 === 0;
}
function isNotSameCamera(camera, camera2) {
    return (camera2 === undefined ||
        camera.position !== camera2.position ||
        camera.heading !== camera2.heading ||
        camera.tilt !== camera2.tilt);
}
function isNotSameEnvironment(environment, environment2) {
    return (environment2 === undefined ||
        environment2.atmosphereEnabled !== environment.atmosphereEnabled ||
        environment2.lighting.date !== environment.lighting.date ||
        environment2.lighting.directShadowsEnabled !==
            environment.lighting.directShadowsEnabled ||
        environment2.lighting.cameraTrackingEnabled !==
            environment.lighting.cameraTrackingEnabled ||
        environment2.lighting.date !== environment.lighting.date ||
        environment2.lighting.displayUTCOffset !==
            environment.lighting.displayUTCOffset);
}
function isNotSameViewpoint(viewpoint, viewpoint2) {
    return (viewpoint2 === undefined ||
        viewpoint.targetGeometry !== viewpoint2.targetGeometry ||
        viewpoint.rotation !== viewpoint2.rotation ||
        viewpoint.scale !== viewpoint2.scale);
}
async function updateForView(viewStr) {
    const viewRef = document.querySelector(viewStr);
    return await new Promise((resolve) => {
        if (viewRef?.view !== undefined) {
            resolve(viewRef.view);
        }
        else if (viewRef) {
            const handler = () => {
                viewRef.removeEventListener("arcgisViewReadyChange", handler, false);
                resolve(viewRef.view);
            };
            viewRef.addEventListener("arcgisViewReadyChange", handler, false);
        }
    });
}
async function referenceElementHelper(element, refElement) {
    if (refElement === undefined)
        return;
    else if (typeof refElement === "string") {
        element.view = await updateForView(refElement);
    }
    else if (element.widget) {
        element.view = refElement.view;
    }
}
//--------------------------------------------------------------------------
//
//  Private Methods
//
//--------------------------------------------------------------------------
function waitForViewHandler(viewRef, element, isUsingRefernceElement) {
    const handler = () => {
        viewRef.removeEventListener("arcgisViewReadyChange", handler, false);
        element.view = viewRef.view;
        if (!isUsingRefernceElement) {
            element.view.ui.add(element.childElem ?? element.el, element.position);
        }
    };
    viewRef.addEventListener("arcgisViewReadyChange", handler, false);
}




/***/ }),

/***/ "./node_modules/@arcgis/map-components/dist/esm/disconnected-6cf1c100.js":
/*!*******************************************************************************!*\
  !*** ./node_modules/@arcgis/map-components/dist/esm/disconnected-6cf1c100.js ***!
  \*******************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   o: () => (/* binding */ onDisconnectedHelper)
/* harmony export */ });
/*!
 * All material copyright Esri, All Rights Reserved, unless otherwise specified.
 * See https://js.arcgis.com/4.30/esri/copyright.txt for details.
 * v4.30.0-next.37
 */
function onDisconnectedHelper(element) {
    if (element.childElem) {
        if (!element.el.isConnected) {
            if (element.view) {
                element.view.ui.remove(element.childElem);
            }
            else if (element.widget?.view) {
                element.widget.view.ui.remove(element.childElem);
            }
            if (element._watchHandles) {
                element._watchHandles.forEach((handle) => {
                    handle.remove();
                });
            }
            element._watchHandles = [];
            element.widget?.destroy();
        }
    }
    else {
        setTimeout(() => {
            if (!element.el.isConnected) {
                if (element.view) {
                    element.view.ui.remove(element.el);
                }
                else if (element.widget?.view) {
                    element.widget.view.ui.remove(element.el);
                }
                if (element._watchHandles) {
                    element._watchHandles.forEach((handle) => {
                        handle.remove();
                    });
                }
                element._watchHandles = [];
                element.widget?.destroy();
            }
        }, 1000);
    }
}




/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2lkZ2V0cy9jaHVua3MvdmVuZG9ycy1ub2RlX21vZHVsZXNfYXJjZ2lzX21hcC1jb21wb25lbnRzX2Rpc3RfZXNtX2FyY2dpcy1mZWF0dXJlLXRhYmxlX2VudHJ5X2pzLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNrRztBQUMwQjtBQUNjO0FBQ25FOztBQUV2RSwrQ0FBK0MsV0FBVyxZQUFZOztBQUV0RTtBQUNBO0FBQ0EsUUFBUSxxREFBZ0I7QUFDeEIsdUNBQXVDLHFEQUFXO0FBQ2xELDJDQUEyQyxxREFBVztBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsK0RBQXNCO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLCtEQUFtQjtBQUMvQjtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0MscURBQXFCO0FBQ3JEO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakIsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0MscURBQXFCLEdBQUcsWUFBWTtBQUNwRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QixxREFBc0I7QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsK0RBQVk7QUFDcEI7QUFDQTtBQUNBLFFBQVEsNERBQW9CO0FBQzVCO0FBQ0E7QUFDQSxlQUFlLHFEQUFDLFVBQVUsbUVBQW1FO0FBQzdGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLFFBQVEsUUFBUSxxREFBdUI7QUFDdkQsUUFBUSwrREFBVTtBQUNsQjtBQUNBLFNBQVM7QUFDVCxRQUFRLCtEQUFVO0FBQ2xCO0FBQ0EsU0FBUztBQUNULFFBQVEsK0RBQVU7QUFDbEI7QUFDQSxTQUFTO0FBQ1QsUUFBUSwrREFBVTtBQUNsQjtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDLHFEQUFxQixHQUFHLGVBQWU7QUFDeEU7QUFDQTtBQUNBLGlDQUFpQyxxREFBcUI7QUFDdEQ7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxPQUFPLHFEQUFVO0FBQ2hDLDRCQUE0QjtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVzRDs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNsY3REO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRXlOOzs7Ozs7Ozs7Ozs7Ozs7QUNwSnpOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBOztBQUVxQyIsInNvdXJjZXMiOlsid2VicGFjazovL2V4Yi1jbGllbnQvLi9ub2RlX21vZHVsZXMvQGFyY2dpcy9tYXAtY29tcG9uZW50cy9kaXN0L2VzbS9hcmNnaXMtZmVhdHVyZS10YWJsZS5lbnRyeS5qcyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vbm9kZV9tb2R1bGVzL0BhcmNnaXMvbWFwLWNvbXBvbmVudHMvZGlzdC9lc20vY29tcG9uZW50LXV0aWxzLTIzMTk0ZjdjLmpzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9ub2RlX21vZHVsZXMvQGFyY2dpcy9tYXAtY29tcG9uZW50cy9kaXN0L2VzbS9kaXNjb25uZWN0ZWQtNmNmMWMxMDAuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyohXG4gKiBBbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVzcmksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuICogU2VlIGh0dHBzOi8vanMuYXJjZ2lzLmNvbS80LjMwL2VzcmkvY29weXJpZ2h0LnR4dCBmb3IgZGV0YWlscy5cbiAqIHY0LjMwLjAtbmV4dC4zN1xuICovXG5pbXBvcnQgeyByIGFzIHJlZ2lzdGVySW5zdGFuY2UsIGMgYXMgY3JlYXRlRXZlbnQsIGgsIGcgYXMgZ2V0RWxlbWVudCB9IGZyb20gJy4vaW5kZXgtNmUxNzJhYWMuanMnO1xuaW1wb3J0IHsgeiBhcyBuZXdMYXllcnNGZWF0dXJlTGF5ZXIsIEEgYXMgbmV3V2lkZ2V0c0ZlYXR1cmVUYWJsZSwgaSBhcyBpbXBvcnRDb3JlUmVhY3RpdmVVdGlscyB9IGZyb20gJy4vaW5kZXgtMGJjNTVjYTUuanMnO1xuaW1wb3J0IHsgciBhcyByZWZlcmVuY2VFbGVtZW50SGVscGVyLCBpIGFzIGlzTnVsbE9yRW1wdHlTdHJpbmcsIGMgYXMgY2hlY2tGb3JWaWV3LCBhIGFzIGFkZEhhbmRsZXMgfSBmcm9tICcuL2NvbXBvbmVudC11dGlscy0yMzE5NGY3Yy5qcyc7XG5pbXBvcnQgeyBvIGFzIG9uRGlzY29ubmVjdGVkSGVscGVyIH0gZnJvbSAnLi9kaXNjb25uZWN0ZWQtNmNmMWMxMDAuanMnO1xuXG5jb25zdCBmZWF0dXJlVGFibGVDc3MgPSBcIi5hcmNnaXMtZmVhdHVyZS10YWJsZXt3aWR0aDoxMDAlO2hlaWdodDoxMDAlfVwiO1xuXG5jb25zdCBBcmNnaXNGZWF0dXJlVGFibGUgPSBjbGFzcyB7XG4gICAgY29uc3RydWN0b3IoaG9zdFJlZikge1xuICAgICAgICByZWdpc3Rlckluc3RhbmNlKHRoaXMsIGhvc3RSZWYpO1xuICAgICAgICB0aGlzLmFyY2dpc0ZlYXR1cmVUYWJsZVJlYWR5ID0gY3JlYXRlRXZlbnQodGhpcywgXCJhcmNnaXNGZWF0dXJlVGFibGVSZWFkeVwiLCA3KTtcbiAgICAgICAgdGhpcy5mZWF0dXJlVGFibGVTZWxlY3Rpb25DaGFuZ2UgPSBjcmVhdGVFdmVudCh0aGlzLCBcImZlYXR1cmVUYWJsZVNlbGVjdGlvbkNoYW5nZVwiLCA3KTtcbiAgICAgICAgdGhpcy5fd2F0Y2hIYW5kbGVzID0gW107XG4gICAgICAgIHRoaXMucmVmZXJlbmNlRWxlbWVudCA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5hY3RpdmVGaWx0ZXJzID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLmFjdGl2ZVNvcnRPcmRlcnMgPSBbXTtcbiAgICAgICAgdGhpcy5hdHRhY2htZW50c0VuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5hdXRvUmVmcmVzaEVuYWJsZWQgPSB0cnVlO1xuICAgICAgICB0aGlzLmNvbHVtblJlb3JkZXJpbmdFbmFibGVkID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5jb2x1bW5zID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLmVkaXRpbmdFbmFibGVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuZmlsdGVyR2VvbWV0cnkgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuaGlkZGVuRmllbGRzID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5oaWdobGlnaHRFbmFibGVkID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5oaWdobGlnaHRJZHMgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMubGF5ZXIgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMubWVudUNvbmZpZyA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5tdWx0aVNvcnRFbmFibGVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMucGFnZVNpemUgPSA1MDtcbiAgICAgICAgdGhpcy5yZXR1cm5HZW9tZXRyeUVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5zdGF0ZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy50YWJsZVRlbXBsYXRlID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLnRpbWVab25lID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLml0ZW1JZCA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy51cmwgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMudmlzaWJsZUVsZW1lbnRzSGVhZGVyID0gdHJ1ZTtcbiAgICAgICAgdGhpcy52aXNpYmxlRWxlbWVudHNNZW51ID0gdHJ1ZTtcbiAgICAgICAgdGhpcy52aXNpYmxlRWxlbWVudHNTZWxlY3Rpb25Db2x1bW4gPSB0cnVlO1xuICAgICAgICB0aGlzLnZpc2libGVFbGVtZW50c0NvbHVtbk1lbnVzID0gdHJ1ZTtcbiAgICAgICAgdGhpcy52aXNpYmxlRWxlbWVudHNNZW51SXRlbXNDbGVhclNlbGVjdGlvbiA9IHRydWU7XG4gICAgICAgIHRoaXMudmlzaWJsZUVsZW1lbnRzTWVudUl0ZW1zRGVsZXRlU2VsZWN0aW9uID0gdHJ1ZTtcbiAgICAgICAgdGhpcy52aXNpYmxlRWxlbWVudHNNZW51SXRlbXNSZWZyZXNoRGF0YSA9IHRydWU7XG4gICAgICAgIHRoaXMudmlzaWJsZUVsZW1lbnRzTWVudUl0ZW1zU2VsZWN0ZWRSZWNvcmRzU2hvd0FsbFRvZ2dsZSA9IHRydWU7XG4gICAgICAgIHRoaXMudmlzaWJsZUVsZW1lbnRzTWVudUl0ZW1zVG9nZ2xlQ29sdW1ucyA9IHRydWU7XG4gICAgICAgIHRoaXMudmlzaWJsZUVsZW1lbnRzTWVudUl0ZW1zWm9vbVRvU2VsZWN0aW9uID0gdHJ1ZTtcbiAgICAgICAgdGhpcy52aWV3ID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLndpZGdldCA9IHVuZGVmaW5lZDtcbiAgICB9XG4gICAgcmVmZXJlbmNlRWxlbWVudFdhdGNoZXIodmFsdWUpIHtcbiAgICAgICAgdm9pZCByZWZlcmVuY2VFbGVtZW50SGVscGVyKHRoaXMsIHZhbHVlKTtcbiAgICB9XG4gICAgYXR0YWNobWVudHNFbmFibGVkV2F0Y2hlcih2YWx1ZSkge1xuICAgICAgICBpZiAodmFsdWUgIT09IHVuZGVmaW5lZCAmJiB0aGlzLndpZGdldCkge1xuICAgICAgICAgICAgdGhpcy53aWRnZXQuYXR0YWNobWVudHNFbmFibGVkID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgYXV0b1JlZnJlc2hFbmFibGVkV2F0Y2hlcih2YWx1ZSkge1xuICAgICAgICBpZiAodmFsdWUgIT09IHVuZGVmaW5lZCAmJiB0aGlzLndpZGdldCkge1xuICAgICAgICAgICAgdGhpcy53aWRnZXQuYXV0b1JlZnJlc2hFbmFibGVkID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY29sdW1uUmVvcmRlcmluZ0VuYWJsZWRXYXRjaGVyKHZhbHVlKSB7XG4gICAgICAgIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkICYmIHRoaXMud2lkZ2V0KSB7XG4gICAgICAgICAgICB0aGlzLndpZGdldC5jb2x1bW5SZW9yZGVyaW5nRW5hYmxlZCA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVkaXRpbmdFbmFibGVkV2F0Y2hlcih2YWx1ZSkge1xuICAgICAgICBpZiAodmFsdWUgIT09IHVuZGVmaW5lZCAmJiB0aGlzLndpZGdldCkge1xuICAgICAgICAgICAgdGhpcy53aWRnZXQuZWRpdGluZ0VuYWJsZWQgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBmaWx0ZXJHZW9tZXRyeVdhdGNoZXIodmFsdWUpIHtcbiAgICAgICAgaWYgKHZhbHVlICYmIHRoaXMud2lkZ2V0KSB7XG4gICAgICAgICAgICB0aGlzLndpZGdldC5maWx0ZXJHZW9tZXRyeSA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGhpZGRlbkZpZWxkc1dhdGNoZXIodmFsdWUpIHtcbiAgICAgICAgaWYgKHZhbHVlICYmIHRoaXMud2lkZ2V0KSB7XG4gICAgICAgICAgICB0aGlzLndpZGdldC5oaWRkZW5GaWVsZHMgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBoaWdobGlnaHRFbmFibGVkV2F0Y2hlcih2YWx1ZSkge1xuICAgICAgICBpZiAodmFsdWUgIT09IHVuZGVmaW5lZCAmJiB0aGlzLndpZGdldCkge1xuICAgICAgICAgICAgdGhpcy53aWRnZXQuaGlnaGxpZ2h0RW5hYmxlZCA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGhpZ2hsaWdodElkc1dhdGNoZXIodmFsdWUpIHtcbiAgICAgICAgaWYgKHZhbHVlICYmIHRoaXMud2lkZ2V0KSB7XG4gICAgICAgICAgICB0aGlzLndpZGdldC5oaWdobGlnaHRJZHMgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBsYXllcldhdGNoZXIodmFsdWUpIHtcbiAgICAgICAgaWYgKHZhbHVlICYmIHRoaXMud2lkZ2V0KSB7XG4gICAgICAgICAgICB0aGlzLndpZGdldC5sYXllciA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKCF2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy53aWRnZXQubGF5ZXIgPSBudWxsO1xuICAgICAgICB9XG4gICAgfVxuICAgIG1lbnVDb25maWdXYXRjaGVyKHZhbHVlKSB7XG4gICAgICAgIGlmICh2YWx1ZSAmJiB0aGlzLndpZGdldCkge1xuICAgICAgICAgICAgdGhpcy53aWRnZXQubWVudUNvbmZpZyA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIG11bHRpU29ydEVuYWJsZWRXYXRjaGVyKHZhbHVlKSB7XG4gICAgICAgIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkICYmIHRoaXMud2lkZ2V0KSB7XG4gICAgICAgICAgICB0aGlzLndpZGdldC5tdWx0aVNvcnRFbmFibGVkID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcGFnZVNpemVXYXRjaGVyKHZhbHVlKSB7XG4gICAgICAgIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkICYmIHRoaXMud2lkZ2V0KSB7XG4gICAgICAgICAgICB0aGlzLndpZGdldC5wYWdlU2l6ZSA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybkdlb21ldHJ5RW5hYmxlZFdhdGNoZXIodmFsdWUpIHtcbiAgICAgICAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQgJiYgdGhpcy53aWRnZXQpIHtcbiAgICAgICAgICAgIHRoaXMud2lkZ2V0LnJldHVybkdlb21ldHJ5RW5hYmxlZCA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHRhYmxlVGVtcGxhdGVXYXRjaGVyKHZhbHVlKSB7XG4gICAgICAgIGlmICh2YWx1ZSAmJiB0aGlzLndpZGdldCkge1xuICAgICAgICAgICAgdGhpcy53aWRnZXQudGFibGVUZW1wbGF0ZSA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHRpbWVab25lV2F0Y2hlcih2YWx1ZSkge1xuICAgICAgICBpZiAodGhpcy53aWRnZXQpIHtcbiAgICAgICAgICAgIHRoaXMud2lkZ2V0LnRpbWVab25lID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgYXN5bmMgaXRlbUlkV2F0Y2hlcih2YWx1ZSwgb2xkKSB7XG4gICAgICAgIGlmIChpc051bGxPckVtcHR5U3RyaW5nKHZhbHVlKSkge1xuICAgICAgICAgICAgdGhpcy5sYXllciA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodmFsdWUgJiYgdmFsdWUgIT09IG9sZCkge1xuICAgICAgICAgICAgY29uc3QgbGF5ZXIgPSBhd2FpdCBuZXdMYXllcnNGZWF0dXJlTGF5ZXIoe1xuICAgICAgICAgICAgICAgIHBvcnRhbEl0ZW06IHtcbiAgICAgICAgICAgICAgICAgICAgaWQ6IHZhbHVlLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMubGF5ZXIgPSBsYXllcjtcbiAgICAgICAgfVxuICAgIH1cbiAgICBhc3luYyB1cmxXYXRjaGVyKHZhbHVlLCBvbGQpIHtcbiAgICAgICAgaWYgKHZhbHVlICYmIHZhbHVlICE9PSBvbGQpIHtcbiAgICAgICAgICAgIGNvbnN0IGxheWVyID0gYXdhaXQgbmV3TGF5ZXJzRmVhdHVyZUxheWVyKHsgdXJsOiB2YWx1ZSB9KTtcbiAgICAgICAgICAgIHRoaXMubGF5ZXIgPSBsYXllcjtcbiAgICAgICAgfVxuICAgIH1cbiAgICB2aXNpYmxlRWxlbWVudHNIZWFkZXJXYXRjaGVyKHZhbHVlKSB7XG4gICAgICAgIGlmICh0aGlzLndpZGdldCkge1xuICAgICAgICAgICAgdGhpcy53aWRnZXQudmlzaWJsZUVsZW1lbnRzID0ge1xuICAgICAgICAgICAgICAgIC4uLnRoaXMud2lkZ2V0LnZpc2libGVFbGVtZW50cyxcbiAgICAgICAgICAgICAgICBoZWFkZXI6IHZhbHVlLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB2aXNpYmxlRWxlbWVudHNNZW51V2F0Y2hlcih2YWx1ZSkge1xuICAgICAgICBpZiAodGhpcy53aWRnZXQpIHtcbiAgICAgICAgICAgIHRoaXMud2lkZ2V0LnZpc2libGVFbGVtZW50cyA9IHtcbiAgICAgICAgICAgICAgICAuLi50aGlzLndpZGdldC52aXNpYmxlRWxlbWVudHMsXG4gICAgICAgICAgICAgICAgbWVudTogdmFsdWUsXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuICAgIHZpc2libGVFbGVtZW50c1NlbGVjdGlvbkNvbHVtbldhdGNoZXIodmFsdWUpIHtcbiAgICAgICAgaWYgKHRoaXMud2lkZ2V0KSB7XG4gICAgICAgICAgICB0aGlzLndpZGdldC52aXNpYmxlRWxlbWVudHMgPSB7XG4gICAgICAgICAgICAgICAgLi4udGhpcy53aWRnZXQudmlzaWJsZUVsZW1lbnRzLFxuICAgICAgICAgICAgICAgIHNlbGVjdGlvbkNvbHVtbjogdmFsdWUsXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuICAgIHZpc2libGVFbGVtZW50c0NvbHVtbk1lbnVzV2F0Y2hlcih2YWx1ZSkge1xuICAgICAgICBpZiAodGhpcy53aWRnZXQpIHtcbiAgICAgICAgICAgIHRoaXMud2lkZ2V0LnZpc2libGVFbGVtZW50cyA9IHtcbiAgICAgICAgICAgICAgICAuLi50aGlzLndpZGdldC52aXNpYmxlRWxlbWVudHMsXG4gICAgICAgICAgICAgICAgY29sdW1uTWVudXM6IHZhbHVlLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB2aXNpYmxlRWxlbWVudHNNZW51SXRlbXNDbGVhclNlbGVjdGlvbldhdGNoZXIodmFsdWUpIHtcbiAgICAgICAgaWYgKHRoaXMud2lkZ2V0KSB7XG4gICAgICAgICAgICB0aGlzLndpZGdldC52aXNpYmxlRWxlbWVudHMgPSB7XG4gICAgICAgICAgICAgICAgLi4udGhpcy53aWRnZXQudmlzaWJsZUVsZW1lbnRzLFxuICAgICAgICAgICAgICAgIG1lbnVJdGVtczoge1xuICAgICAgICAgICAgICAgICAgICAuLi50aGlzLndpZGdldC52aXNpYmxlRWxlbWVudHMubWVudUl0ZW1zLFxuICAgICAgICAgICAgICAgICAgICBjbGVhclNlbGVjdGlvbjogdmFsdWUsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG4gICAgdmlzaWJsZUVsZW1lbnRzTWVudUl0ZW1zRGVsZXRlU2VsZWN0aW9uV2F0Y2hlcih2YWx1ZSkge1xuICAgICAgICBpZiAodGhpcy53aWRnZXQpIHtcbiAgICAgICAgICAgIHRoaXMud2lkZ2V0LnZpc2libGVFbGVtZW50cyA9IHtcbiAgICAgICAgICAgICAgICAuLi50aGlzLndpZGdldC52aXNpYmxlRWxlbWVudHMsXG4gICAgICAgICAgICAgICAgbWVudUl0ZW1zOiB7XG4gICAgICAgICAgICAgICAgICAgIC4uLnRoaXMud2lkZ2V0LnZpc2libGVFbGVtZW50cy5tZW51SXRlbXMsXG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZVNlbGVjdGlvbjogdmFsdWUsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG4gICAgdmlzaWJsZUVsZW1lbnRzTWVudUl0ZW1zUmVmcmVzaERhdGFXYXRjaGVyKHZhbHVlKSB7XG4gICAgICAgIGlmICh0aGlzLndpZGdldCkge1xuICAgICAgICAgICAgdGhpcy53aWRnZXQudmlzaWJsZUVsZW1lbnRzID0ge1xuICAgICAgICAgICAgICAgIC4uLnRoaXMud2lkZ2V0LnZpc2libGVFbGVtZW50cyxcbiAgICAgICAgICAgICAgICBtZW51SXRlbXM6IHtcbiAgICAgICAgICAgICAgICAgICAgLi4udGhpcy53aWRnZXQudmlzaWJsZUVsZW1lbnRzLm1lbnVJdGVtcyxcbiAgICAgICAgICAgICAgICAgICAgcmVmcmVzaERhdGE6IHZhbHVlLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuICAgIHZpc2libGVFbGVtZW50c01lbnVJdGVtc1NlbGVjdGVkUmVjb3Jkc1Nob3dBbGxUb2dnbGVXYXRjaGVyKHZhbHVlKSB7XG4gICAgICAgIGlmICh0aGlzLndpZGdldCkge1xuICAgICAgICAgICAgdGhpcy53aWRnZXQudmlzaWJsZUVsZW1lbnRzID0ge1xuICAgICAgICAgICAgICAgIC4uLnRoaXMud2lkZ2V0LnZpc2libGVFbGVtZW50cyxcbiAgICAgICAgICAgICAgICBtZW51SXRlbXM6IHtcbiAgICAgICAgICAgICAgICAgICAgLi4udGhpcy53aWRnZXQudmlzaWJsZUVsZW1lbnRzLm1lbnVJdGVtcyxcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRSZWNvcmRzU2hvd0FsbFRvZ2dsZTogdmFsdWUsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG4gICAgdmlzaWJsZUVsZW1lbnRzTWVudUl0ZW1zVG9nZ2xlQ29sdW1uc1dhdGNoZXIodmFsdWUpIHtcbiAgICAgICAgaWYgKHRoaXMud2lkZ2V0KSB7XG4gICAgICAgICAgICB0aGlzLndpZGdldC52aXNpYmxlRWxlbWVudHMgPSB7XG4gICAgICAgICAgICAgICAgLi4udGhpcy53aWRnZXQudmlzaWJsZUVsZW1lbnRzLFxuICAgICAgICAgICAgICAgIG1lbnVJdGVtczoge1xuICAgICAgICAgICAgICAgICAgICAuLi50aGlzLndpZGdldC52aXNpYmxlRWxlbWVudHMubWVudUl0ZW1zLFxuICAgICAgICAgICAgICAgICAgICB0b2dnbGVDb2x1bW5zOiB2YWx1ZSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB2aXNpYmxlRWxlbWVudHNNZW51SXRlbXNab29tVG9TZWxlY3Rpb25XYXRjaGVyKHZhbHVlKSB7XG4gICAgICAgIGlmICh0aGlzLndpZGdldCkge1xuICAgICAgICAgICAgdGhpcy53aWRnZXQudmlzaWJsZUVsZW1lbnRzID0ge1xuICAgICAgICAgICAgICAgIC4uLnRoaXMud2lkZ2V0LnZpc2libGVFbGVtZW50cyxcbiAgICAgICAgICAgICAgICBtZW51SXRlbXM6IHtcbiAgICAgICAgICAgICAgICAgICAgLi4udGhpcy53aWRnZXQudmlzaWJsZUVsZW1lbnRzLm1lbnVJdGVtcyxcbiAgICAgICAgICAgICAgICAgICAgem9vbVRvU2VsZWN0aW9uOiB2YWx1ZSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB2aWV3V2F0Y2hlcih2YWx1ZSkge1xuICAgICAgICBpZiAodmFsdWUgIT09IHVuZGVmaW5lZCAmJiB0aGlzLndpZGdldCkge1xuICAgICAgICAgICAgdGhpcy53aWRnZXQudmlldyA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvL1xuICAgIC8vICBNZXRob2RzXG4gICAgLy9cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgYXN5bmMgY2xlYXJTZWxlY3Rpb25GaWx0ZXIoKSB7XG4gICAgICAgIHRoaXMud2lkZ2V0Py5jbGVhclNlbGVjdGlvbkZpbHRlcigpO1xuICAgIH1cbiAgICBhc3luYyBkZWxldGVTZWxlY3Rpb24oc2hvd1dhcm5pbmdQcm9tcHQpIHtcbiAgICAgICAgYXdhaXQgdGhpcy53aWRnZXQ/LmRlbGV0ZVNlbGVjdGlvbihzaG93V2FybmluZ1Byb21wdCk7XG4gICAgfVxuICAgIGFzeW5jIGZpbHRlckJ5U2VsZWN0aW9uKCkge1xuICAgICAgICB0aGlzLndpZGdldD8uZmlsdGVyQnlTZWxlY3Rpb24oKTtcbiAgICB9XG4gICAgYXN5bmMgZmluZENvbHVtbihmaWVsZE5hbWUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMud2lkZ2V0Py5maW5kQ29sdW1uKGZpZWxkTmFtZSk7XG4gICAgfVxuICAgIGFzeW5jIGhpZGVDb2x1bW4oZmllbGROYW1lKSB7XG4gICAgICAgIHRoaXMud2lkZ2V0Py5oaWRlQ29sdW1uKGZpZWxkTmFtZSk7XG4gICAgfVxuICAgIGFzeW5jIHJlZnJlc2goKSB7XG4gICAgICAgIGF3YWl0IHRoaXMud2lkZ2V0Py5yZWZyZXNoKCk7XG4gICAgfVxuICAgIGFzeW5jIHNjcm9sbFRvSW5kZXgoaW5kZXgpIHtcbiAgICAgICAgdGhpcy53aWRnZXQ/LnNjcm9sbFRvSW5kZXgoaW5kZXgpO1xuICAgIH1cbiAgICBhc3luYyBzaG93QWxsQ29sdW1ucygpIHtcbiAgICAgICAgdGhpcy53aWRnZXQ/LnNob3dBbGxDb2x1bW5zKCk7XG4gICAgfVxuICAgIGFzeW5jIHNob3dDb2x1bW4oZmllbGROYW1lKSB7XG4gICAgICAgIHRoaXMud2lkZ2V0Py5zaG93Q29sdW1uKGZpZWxkTmFtZSk7XG4gICAgfVxuICAgIGFzeW5jIHNvcnRDb2x1bW4ocGF0aCwgZGlyZWN0aW9uKSB7XG4gICAgICAgIHRoaXMud2lkZ2V0Py5zb3J0Q29sdW1uKHBhdGgsIGRpcmVjdGlvbik7XG4gICAgfVxuICAgIGFzeW5jIHpvb21Ub1NlbGVjdGlvbigpIHtcbiAgICAgICAgdGhpcy53aWRnZXQ/Lnpvb21Ub1NlbGVjdGlvbigpO1xuICAgIH1cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy9cbiAgICAvLyAgTGlmZWN5Y2xlXG4gICAgLy9cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgYXN5bmMgY29tcG9uZW50RGlkTG9hZCgpIHtcbiAgICAgICAgY29uc3QgcGFyYW1zID0gYXdhaXQgdGhpcy5fY3JlYXRlUGFyYW1zKCk7XG4gICAgICAgIGNvbnN0IHdpZGdldCA9IGF3YWl0IG5ld1dpZGdldHNGZWF0dXJlVGFibGUocGFyYW1zKTtcbiAgICAgICAgdGhpcy53aWRnZXQgPSB3aWRnZXQ7XG4gICAgICAgIGF3YWl0IHRoaXMuX2FkZFdhdGNoZXJzKCk7XG4gICAgICAgIHRoaXMuX3Byb3h5RXZlbnRzKCk7XG4gICAgICAgIHRoaXMuX2FkZENvbnRhaW5lcigpO1xuICAgICAgICB0aGlzLmFyY2dpc0ZlYXR1cmVUYWJsZVJlYWR5LmVtaXQoKTtcbiAgICAgICAgY2hlY2tGb3JWaWV3KHRoaXMpO1xuICAgIH1cbiAgICBkaXNjb25uZWN0ZWRDYWxsYmFjaygpIHtcbiAgICAgICAgb25EaXNjb25uZWN0ZWRIZWxwZXIodGhpcyk7XG4gICAgfVxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgcmV0dXJuIGgoXCJkaXZcIiwgeyBjbGFzczogXCJhcmNnaXMtZmVhdHVyZS10YWJsZVwiLCByZWY6IChlbCkgPT4gKHRoaXMuY2hpbGRFbGVtID0gZWwpIH0pO1xuICAgIH1cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy9cbiAgICAvLyAgUHJpdmF0ZSBNZXRob2RzXG4gICAgLy9cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgX2FkZENvbnRhaW5lcigpIHtcbiAgICAgICAgdGhpcy53aWRnZXQuY29udGFpbmVyID0gdGhpcy5jaGlsZEVsZW07XG4gICAgfVxuICAgIGFzeW5jIF9hZGRXYXRjaGVycygpIHtcbiAgICAgICAgY29uc3QgeyB3YXRjaCB9ID0gYXdhaXQgaW1wb3J0Q29yZVJlYWN0aXZlVXRpbHMoKTtcbiAgICAgICAgYWRkSGFuZGxlcyh0aGlzLCB3YXRjaCgoKSA9PiB0aGlzLndpZGdldC5hY3RpdmVGaWx0ZXJzLCAodmFsdWUpID0+ICh0aGlzLmFjdGl2ZUZpbHRlcnMgPSB2YWx1ZSksIHtcbiAgICAgICAgICAgIGluaXRpYWw6IHRydWUsXG4gICAgICAgIH0pKTtcbiAgICAgICAgYWRkSGFuZGxlcyh0aGlzLCB3YXRjaCgoKSA9PiB0aGlzLndpZGdldC5hY3RpdmVTb3J0T3JkZXJzLCAodmFsdWUpID0+ICh0aGlzLmFjdGl2ZVNvcnRPcmRlcnMgPSB2YWx1ZSksIHtcbiAgICAgICAgICAgIGluaXRpYWw6IHRydWUsXG4gICAgICAgIH0pKTtcbiAgICAgICAgYWRkSGFuZGxlcyh0aGlzLCB3YXRjaCgoKSA9PiB0aGlzLndpZGdldC5jb2x1bW5zLCAodmFsdWUpID0+ICh0aGlzLmNvbHVtbnMgPSB2YWx1ZSksIHtcbiAgICAgICAgICAgIGluaXRpYWw6IHRydWUsXG4gICAgICAgIH0pKTtcbiAgICAgICAgYWRkSGFuZGxlcyh0aGlzLCB3YXRjaCgoKSA9PiB0aGlzLndpZGdldC5zdGF0ZSwgKHZhbHVlKSA9PiAodGhpcy5zdGF0ZSA9IHZhbHVlKSwge1xuICAgICAgICAgICAgaW5pdGlhbDogdHJ1ZSxcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBhc3luYyBfY3JlYXRlUGFyYW1zKCkge1xuICAgICAgICBjb25zdCBwYXJhbXMgPSB7fTtcbiAgICAgICAgcGFyYW1zLnZpc2libGVFbGVtZW50cyA9IHtcbiAgICAgICAgICAgIGhlYWRlcjogdGhpcy52aXNpYmxlRWxlbWVudHNIZWFkZXIsXG4gICAgICAgICAgICBtZW51OiB0aGlzLnZpc2libGVFbGVtZW50c01lbnUsXG4gICAgICAgICAgICBzZWxlY3Rpb25Db2x1bW46IHRoaXMudmlzaWJsZUVsZW1lbnRzU2VsZWN0aW9uQ29sdW1uLFxuICAgICAgICAgICAgY29sdW1uTWVudXM6IHRoaXMudmlzaWJsZUVsZW1lbnRzQ29sdW1uTWVudXMsXG4gICAgICAgICAgICBtZW51SXRlbXM6IHtcbiAgICAgICAgICAgICAgICBjbGVhclNlbGVjdGlvbjogdGhpcy52aXNpYmxlRWxlbWVudHNNZW51SXRlbXNDbGVhclNlbGVjdGlvbixcbiAgICAgICAgICAgICAgICBkZWxldGVTZWxlY3Rpb246IHRoaXMudmlzaWJsZUVsZW1lbnRzTWVudUl0ZW1zRGVsZXRlU2VsZWN0aW9uLFxuICAgICAgICAgICAgICAgIHJlZnJlc2hEYXRhOiB0aGlzLnZpc2libGVFbGVtZW50c01lbnVJdGVtc1JlZnJlc2hEYXRhLFxuICAgICAgICAgICAgICAgIHNlbGVjdGVkUmVjb3Jkc1Nob3dBbGxUb2dnbGU6IHRoaXMudmlzaWJsZUVsZW1lbnRzTWVudUl0ZW1zU2VsZWN0ZWRSZWNvcmRzU2hvd0FsbFRvZ2dsZSxcbiAgICAgICAgICAgICAgICB0b2dnbGVDb2x1bW5zOiB0aGlzLnZpc2libGVFbGVtZW50c01lbnVJdGVtc1RvZ2dsZUNvbHVtbnMsXG4gICAgICAgICAgICAgICAgem9vbVRvU2VsZWN0aW9uOiB0aGlzLnZpc2libGVFbGVtZW50c01lbnVJdGVtc1pvb21Ub1NlbGVjdGlvbixcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH07XG4gICAgICAgIGlmICh0aGlzLnZpZXcpIHtcbiAgICAgICAgICAgIHBhcmFtcy52aWV3ID0gdGhpcy52aWV3O1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmF0dGFjaG1lbnRzRW5hYmxlZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBwYXJhbXMuYXR0YWNobWVudHNFbmFibGVkID0gdGhpcy5hdHRhY2htZW50c0VuYWJsZWQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuYXV0b1JlZnJlc2hFbmFibGVkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHBhcmFtcy5hdXRvUmVmcmVzaEVuYWJsZWQgPSB0aGlzLmF1dG9SZWZyZXNoRW5hYmxlZDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5jb2x1bW5SZW9yZGVyaW5nRW5hYmxlZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBwYXJhbXMuY29sdW1uUmVvcmRlcmluZ0VuYWJsZWQgPSB0aGlzLmNvbHVtblJlb3JkZXJpbmdFbmFibGVkO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmVkaXRpbmdFbmFibGVkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHBhcmFtcy5lZGl0aW5nRW5hYmxlZCA9IHRoaXMuZWRpdGluZ0VuYWJsZWQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuZmlsdGVyR2VvbWV0cnkgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcGFyYW1zLmZpbHRlckdlb21ldHJ5ID0gdGhpcy5maWx0ZXJHZW9tZXRyeTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5oaWRkZW5GaWVsZHMgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcGFyYW1zLmhpZGRlbkZpZWxkcyA9IHRoaXMuaGlkZGVuRmllbGRzO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmhpZ2hsaWdodEVuYWJsZWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcGFyYW1zLmhpZ2hsaWdodEVuYWJsZWQgPSB0aGlzLmhpZ2hsaWdodEVuYWJsZWQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuaGlnaGxpZ2h0SWRzICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHBhcmFtcy5oaWdobGlnaHRJZHMgPSB0aGlzLmhpZ2hsaWdodElkcztcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5tZW51Q29uZmlnICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHBhcmFtcy5tZW51Q29uZmlnID0gdGhpcy5tZW51Q29uZmlnO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm11bHRpU29ydEVuYWJsZWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcGFyYW1zLm11bHRpU29ydEVuYWJsZWQgPSB0aGlzLm11bHRpU29ydEVuYWJsZWQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucGFnZVNpemUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcGFyYW1zLnBhZ2VTaXplID0gdGhpcy5wYWdlU2l6ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy50YWJsZVRlbXBsYXRlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHBhcmFtcy50YWJsZVRlbXBsYXRlID0gdGhpcy50YWJsZVRlbXBsYXRlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnRpbWVab25lICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHBhcmFtcy50aW1lWm9uZSA9IHRoaXMudGltZVpvbmU7XG4gICAgICAgIH1cbiAgICAgICAgLy8gSGFuZGxlIGxvYWRpbmcgYSBsYXllciwgdXJsLCBvciBpdGVtSWRcbiAgICAgICAgaWYgKHRoaXMubGF5ZXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcGFyYW1zLmxheWVyID0gdGhpcy5sYXllcjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLnVybCkge1xuICAgICAgICAgICAgcGFyYW1zLmxheWVyID0gYXdhaXQgbmV3TGF5ZXJzRmVhdHVyZUxheWVyKHsgdXJsOiB0aGlzLnVybCB9KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLml0ZW1JZCkge1xuICAgICAgICAgICAgcGFyYW1zLmxheWVyID0gYXdhaXQgbmV3TGF5ZXJzRmVhdHVyZUxheWVyKHtcbiAgICAgICAgICAgICAgICBwb3J0YWxJdGVtOiB7XG4gICAgICAgICAgICAgICAgICAgIGlkOiB0aGlzLml0ZW1JZCxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHBhcmFtcztcbiAgICB9XG4gICAgX3Byb3h5RXZlbnRzKCkge1xuICAgICAgICB0aGlzLndpZGdldD8uaGlnaGxpZ2h0SWRzLm9uKFwiY2hhbmdlXCIsIChlKSA9PiB0aGlzLmZlYXR1cmVUYWJsZVNlbGVjdGlvbkNoYW5nZS5lbWl0KGUpKTtcbiAgICB9XG4gICAgZ2V0IGVsKCkgeyByZXR1cm4gZ2V0RWxlbWVudCh0aGlzKTsgfVxuICAgIHN0YXRpYyBnZXQgd2F0Y2hlcnMoKSB7IHJldHVybiB7XG4gICAgICAgIFwicmVmZXJlbmNlRWxlbWVudFwiOiBbXCJyZWZlcmVuY2VFbGVtZW50V2F0Y2hlclwiXSxcbiAgICAgICAgXCJhdHRhY2htZW50c0VuYWJsZWRcIjogW1wiYXR0YWNobWVudHNFbmFibGVkV2F0Y2hlclwiXSxcbiAgICAgICAgXCJhdXRvUmVmcmVzaEVuYWJsZWRcIjogW1wiYXV0b1JlZnJlc2hFbmFibGVkV2F0Y2hlclwiXSxcbiAgICAgICAgXCJjb2x1bW5SZW9yZGVyaW5nRW5hYmxlZFwiOiBbXCJjb2x1bW5SZW9yZGVyaW5nRW5hYmxlZFdhdGNoZXJcIl0sXG4gICAgICAgIFwiZWRpdGluZ0VuYWJsZWRcIjogW1wiZWRpdGluZ0VuYWJsZWRXYXRjaGVyXCJdLFxuICAgICAgICBcImZpbHRlckdlb21ldHJ5XCI6IFtcImZpbHRlckdlb21ldHJ5V2F0Y2hlclwiXSxcbiAgICAgICAgXCJoaWRkZW5GaWVsZHNcIjogW1wiaGlkZGVuRmllbGRzV2F0Y2hlclwiXSxcbiAgICAgICAgXCJoaWdobGlnaHRFbmFibGVkXCI6IFtcImhpZ2hsaWdodEVuYWJsZWRXYXRjaGVyXCJdLFxuICAgICAgICBcImhpZ2hsaWdodElkc1wiOiBbXCJoaWdobGlnaHRJZHNXYXRjaGVyXCJdLFxuICAgICAgICBcImxheWVyXCI6IFtcImxheWVyV2F0Y2hlclwiXSxcbiAgICAgICAgXCJtZW51Q29uZmlnXCI6IFtcIm1lbnVDb25maWdXYXRjaGVyXCJdLFxuICAgICAgICBcIm11bHRpU29ydEVuYWJsZWRcIjogW1wibXVsdGlTb3J0RW5hYmxlZFdhdGNoZXJcIl0sXG4gICAgICAgIFwicGFnZVNpemVcIjogW1wicGFnZVNpemVXYXRjaGVyXCJdLFxuICAgICAgICBcInJldHVybkdlb21ldHJ5RW5hYmxlZFwiOiBbXCJyZXR1cm5HZW9tZXRyeUVuYWJsZWRXYXRjaGVyXCJdLFxuICAgICAgICBcInRhYmxlVGVtcGxhdGVcIjogW1widGFibGVUZW1wbGF0ZVdhdGNoZXJcIl0sXG4gICAgICAgIFwidGltZVpvbmVcIjogW1widGltZVpvbmVXYXRjaGVyXCJdLFxuICAgICAgICBcIml0ZW1JZFwiOiBbXCJpdGVtSWRXYXRjaGVyXCJdLFxuICAgICAgICBcInVybFwiOiBbXCJ1cmxXYXRjaGVyXCJdLFxuICAgICAgICBcInZpc2libGVFbGVtZW50c0hlYWRlclwiOiBbXCJ2aXNpYmxlRWxlbWVudHNIZWFkZXJXYXRjaGVyXCJdLFxuICAgICAgICBcInZpc2libGVFbGVtZW50c01lbnVcIjogW1widmlzaWJsZUVsZW1lbnRzTWVudVdhdGNoZXJcIl0sXG4gICAgICAgIFwidmlzaWJsZUVsZW1lbnRzU2VsZWN0aW9uQ29sdW1uXCI6IFtcInZpc2libGVFbGVtZW50c1NlbGVjdGlvbkNvbHVtbldhdGNoZXJcIl0sXG4gICAgICAgIFwidmlzaWJsZUVsZW1lbnRzQ29sdW1uTWVudXNcIjogW1widmlzaWJsZUVsZW1lbnRzQ29sdW1uTWVudXNXYXRjaGVyXCJdLFxuICAgICAgICBcInZpc2libGVFbGVtZW50c01lbnVJdGVtc0NsZWFyU2VsZWN0aW9uXCI6IFtcInZpc2libGVFbGVtZW50c01lbnVJdGVtc0NsZWFyU2VsZWN0aW9uV2F0Y2hlclwiXSxcbiAgICAgICAgXCJ2aXNpYmxlRWxlbWVudHNNZW51SXRlbXNEZWxldGVTZWxlY3Rpb25cIjogW1widmlzaWJsZUVsZW1lbnRzTWVudUl0ZW1zRGVsZXRlU2VsZWN0aW9uV2F0Y2hlclwiXSxcbiAgICAgICAgXCJ2aXNpYmxlRWxlbWVudHNNZW51SXRlbXNSZWZyZXNoRGF0YVwiOiBbXCJ2aXNpYmxlRWxlbWVudHNNZW51SXRlbXNSZWZyZXNoRGF0YVdhdGNoZXJcIl0sXG4gICAgICAgIFwidmlzaWJsZUVsZW1lbnRzTWVudUl0ZW1zU2VsZWN0ZWRSZWNvcmRzU2hvd0FsbFRvZ2dsZVwiOiBbXCJ2aXNpYmxlRWxlbWVudHNNZW51SXRlbXNTZWxlY3RlZFJlY29yZHNTaG93QWxsVG9nZ2xlV2F0Y2hlclwiXSxcbiAgICAgICAgXCJ2aXNpYmxlRWxlbWVudHNNZW51SXRlbXNUb2dnbGVDb2x1bW5zXCI6IFtcInZpc2libGVFbGVtZW50c01lbnVJdGVtc1RvZ2dsZUNvbHVtbnNXYXRjaGVyXCJdLFxuICAgICAgICBcInZpc2libGVFbGVtZW50c01lbnVJdGVtc1pvb21Ub1NlbGVjdGlvblwiOiBbXCJ2aXNpYmxlRWxlbWVudHNNZW51SXRlbXNab29tVG9TZWxlY3Rpb25XYXRjaGVyXCJdLFxuICAgICAgICBcInZpZXdcIjogW1widmlld1dhdGNoZXJcIl1cbiAgICB9OyB9XG59O1xuQXJjZ2lzRmVhdHVyZVRhYmxlLnN0eWxlID0gZmVhdHVyZVRhYmxlQ3NzO1xuXG5leHBvcnQgeyBBcmNnaXNGZWF0dXJlVGFibGUgYXMgYXJjZ2lzX2ZlYXR1cmVfdGFibGUgfTtcbiIsIi8qIVxuICogQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFc3JpLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAqIFNlZSBodHRwczovL2pzLmFyY2dpcy5jb20vNC4zMC9lc3JpL2NvcHlyaWdodC50eHQgZm9yIGRldGFpbHMuXG4gKiB2NC4zMC4wLW5leHQuMzdcbiAqL1xuZnVuY3Rpb24gY2hlY2tGb3JFeHBhbmQoZWxlbWVudCkge1xuICAgIGNvbnN0IGV4cGFuZFJlZiA9IGVsZW1lbnQuZWwuY2xvc2VzdChcImFyY2dpcy1leHBhbmRcIikgPz8gZWxlbWVudC5leHBhbmRFbGVtO1xuICAgIGlmIChleHBhbmRSZWY/LndpZGdldCkge1xuICAgICAgICBlbGVtZW50LnZpZXcgPSBleHBhbmRSZWYudmlldztcbiAgICAgICAgZXhwYW5kUmVmLndpZGdldC5jb250ZW50ID0gZWxlbWVudC5jaGlsZEVsZW0gPz8gZWxlbWVudC5lbDtcbiAgICAgICAgLy8gVE9ETzogVXBkYXRlIHRvIGJlIGV4cGFuZEljb24gPSB3aWRnZXQuaWNvbiwgbm90IHJlYWR5IHlldCBpbiA0LjI3bmV4dFxuICAgICAgICBpZiAoIWV4cGFuZFJlZi5leHBhbmRJY29uKSB7XG4gICAgICAgICAgICBleHBhbmRSZWYud2lkZ2V0LmV4cGFuZEljb24gPSBlbGVtZW50LndpZGdldCA/IGVsZW1lbnQud2lkZ2V0Lmljb24gOiBlbGVtZW50Py5pY29uO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICBpZiAoZXhwYW5kUmVmKSB7XG4gICAgICAgIGNvbnN0IHdpZGdldEhhbmRsZXIgPSAoKSA9PiB7XG4gICAgICAgICAgICBleHBhbmRSZWYucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImFyY2dpc0V4cGFuZFJlYWR5XCIsIHdpZGdldEhhbmRsZXIsIGZhbHNlKTtcbiAgICAgICAgICAgIGVsZW1lbnQudmlldyA9IGV4cGFuZFJlZi52aWV3O1xuICAgICAgICAgICAgZXhwYW5kUmVmLndpZGdldC5jb250ZW50ID0gZWxlbWVudC5jaGlsZEVsZW0gPz8gZWxlbWVudC5lbDtcbiAgICAgICAgICAgIGlmICghZXhwYW5kUmVmLmV4cGFuZEljb24pIHtcbiAgICAgICAgICAgICAgICBleHBhbmRSZWYud2lkZ2V0LmV4cGFuZEljb24gPSBlbGVtZW50LndpZGdldCA/IGVsZW1lbnQud2lkZ2V0Lmljb24gOiBlbGVtZW50Py5pY29uO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBleHBhbmRSZWYuYWRkRXZlbnRMaXN0ZW5lcihcImFyY2dpc0V4cGFuZFJlYWR5XCIsIHdpZGdldEhhbmRsZXIsIGZhbHNlKTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbn1cblxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy9cbi8vICBQdWJsaWMgTWV0aG9kc1xuLy9cbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbmZ1bmN0aW9uIGFkZEhhbmRsZXMoZWxlbWVudCwgaGFuZGxlKSB7XG4gICAgaWYgKEFycmF5LmlzQXJyYXkoaGFuZGxlKSkge1xuICAgICAgICBlbGVtZW50Ll93YXRjaEhhbmRsZXMgPSBbLi4uZWxlbWVudC5fd2F0Y2hIYW5kbGVzLCAuLi5oYW5kbGVdO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgZWxlbWVudC5fd2F0Y2hIYW5kbGVzLnB1c2goaGFuZGxlKTtcbiAgICB9XG59XG5mdW5jdGlvbiBjaGVja0ZvclZpZXcoZWxlbWVudCkge1xuICAgIGxldCBpc1VzaW5nUmVmZXJlbmNlRWxlbWVudCA9IGZhbHNlO1xuICAgIGlmICghY2hlY2tGb3JFeHBhbmQoZWxlbWVudCkpIHtcbiAgICAgICAgbGV0IHZpZXdSZWYgPSBlbGVtZW50LmVsLmNsb3Nlc3QoXCJhcmNnaXMtbWFwXCIpID8/IGVsZW1lbnQuZWwuY2xvc2VzdChcImFyY2dpcy1zY2VuZVwiKTtcbiAgICAgICAgaWYgKCF2aWV3UmVmICYmIHR5cGVvZiBlbGVtZW50LnJlZmVyZW5jZUVsZW1lbnQgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgIHZpZXdSZWYgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGVsZW1lbnQucmVmZXJlbmNlRWxlbWVudCk7XG4gICAgICAgICAgICBpc1VzaW5nUmVmZXJlbmNlRWxlbWVudCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHZpZXdSZWY/LnZpZXcpIHtcbiAgICAgICAgICAgIGVsZW1lbnQudmlldyA9IHZpZXdSZWYudmlldztcbiAgICAgICAgICAgIGNvbnN0IGVsID0gZWxlbWVudC5jaGlsZEVsZW0gPz8gZWxlbWVudC5lbDtcbiAgICAgICAgICAgIGlmICghaXNVc2luZ1JlZmVyZW5jZUVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICBlbGVtZW50LnZpZXcudWkuYWRkKGVsLCBlbGVtZW50LnBvc2l0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh2aWV3UmVmKSB7XG4gICAgICAgICAgICB3YWl0Rm9yVmlld0hhbmRsZXIodmlld1JlZiwgZWxlbWVudCwgaXNVc2luZ1JlZmVyZW5jZUVsZW1lbnQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBjb25zdCB2aWV3UmVmID0gZWxlbWVudC5lbC5jbG9zZXN0KFwiYXJjZ2lzLW1hcFwiKSA/PyBlbGVtZW50LmVsLmNsb3Nlc3QoXCJhcmNnaXMtc2NlbmVcIik7XG4gICAgICAgIGlmICh2aWV3UmVmPy52aWV3KSB7XG4gICAgICAgICAgICBlbGVtZW50LnZpZXcgPSB2aWV3UmVmLnZpZXc7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodmlld1JlZikge1xuICAgICAgICAgICAgY29uc3QgaGFuZGxlciA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICB2aWV3UmVmLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJhcmNnaXNWaWV3UmVhZHlDaGFuZ2VcIiwgaGFuZGxlciwgZmFsc2UpO1xuICAgICAgICAgICAgICAgIGVsZW1lbnQudmlldyA9IHZpZXdSZWYudmlldztcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2aWV3UmVmLmFkZEV2ZW50TGlzdGVuZXIoXCJhcmNnaXNWaWV3UmVhZHlDaGFuZ2VcIiwgaGFuZGxlciwgZmFsc2UpO1xuICAgICAgICB9XG4gICAgfVxufVxuZnVuY3Rpb24gaXNOdWxsT3JFbXB0eVN0cmluZyh2YWx1ZSkge1xuICAgIHJldHVybiB2YWx1ZSA9PT0gdW5kZWZpbmVkIHx8IHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSBcIlwiO1xufVxuZnVuY3Rpb24gaXNWYWxpZEludGVnZXIodmFsdWUpIHtcbiAgICByZXR1cm4gdmFsdWUgIT0gbnVsbCAmJiB2YWx1ZSAlIDEgPT09IDA7XG59XG5mdW5jdGlvbiBpc05vdFNhbWVDYW1lcmEoY2FtZXJhLCBjYW1lcmEyKSB7XG4gICAgcmV0dXJuIChjYW1lcmEyID09PSB1bmRlZmluZWQgfHxcbiAgICAgICAgY2FtZXJhLnBvc2l0aW9uICE9PSBjYW1lcmEyLnBvc2l0aW9uIHx8XG4gICAgICAgIGNhbWVyYS5oZWFkaW5nICE9PSBjYW1lcmEyLmhlYWRpbmcgfHxcbiAgICAgICAgY2FtZXJhLnRpbHQgIT09IGNhbWVyYTIudGlsdCk7XG59XG5mdW5jdGlvbiBpc05vdFNhbWVFbnZpcm9ubWVudChlbnZpcm9ubWVudCwgZW52aXJvbm1lbnQyKSB7XG4gICAgcmV0dXJuIChlbnZpcm9ubWVudDIgPT09IHVuZGVmaW5lZCB8fFxuICAgICAgICBlbnZpcm9ubWVudDIuYXRtb3NwaGVyZUVuYWJsZWQgIT09IGVudmlyb25tZW50LmF0bW9zcGhlcmVFbmFibGVkIHx8XG4gICAgICAgIGVudmlyb25tZW50Mi5saWdodGluZy5kYXRlICE9PSBlbnZpcm9ubWVudC5saWdodGluZy5kYXRlIHx8XG4gICAgICAgIGVudmlyb25tZW50Mi5saWdodGluZy5kaXJlY3RTaGFkb3dzRW5hYmxlZCAhPT1cbiAgICAgICAgICAgIGVudmlyb25tZW50LmxpZ2h0aW5nLmRpcmVjdFNoYWRvd3NFbmFibGVkIHx8XG4gICAgICAgIGVudmlyb25tZW50Mi5saWdodGluZy5jYW1lcmFUcmFja2luZ0VuYWJsZWQgIT09XG4gICAgICAgICAgICBlbnZpcm9ubWVudC5saWdodGluZy5jYW1lcmFUcmFja2luZ0VuYWJsZWQgfHxcbiAgICAgICAgZW52aXJvbm1lbnQyLmxpZ2h0aW5nLmRhdGUgIT09IGVudmlyb25tZW50LmxpZ2h0aW5nLmRhdGUgfHxcbiAgICAgICAgZW52aXJvbm1lbnQyLmxpZ2h0aW5nLmRpc3BsYXlVVENPZmZzZXQgIT09XG4gICAgICAgICAgICBlbnZpcm9ubWVudC5saWdodGluZy5kaXNwbGF5VVRDT2Zmc2V0KTtcbn1cbmZ1bmN0aW9uIGlzTm90U2FtZVZpZXdwb2ludCh2aWV3cG9pbnQsIHZpZXdwb2ludDIpIHtcbiAgICByZXR1cm4gKHZpZXdwb2ludDIgPT09IHVuZGVmaW5lZCB8fFxuICAgICAgICB2aWV3cG9pbnQudGFyZ2V0R2VvbWV0cnkgIT09IHZpZXdwb2ludDIudGFyZ2V0R2VvbWV0cnkgfHxcbiAgICAgICAgdmlld3BvaW50LnJvdGF0aW9uICE9PSB2aWV3cG9pbnQyLnJvdGF0aW9uIHx8XG4gICAgICAgIHZpZXdwb2ludC5zY2FsZSAhPT0gdmlld3BvaW50Mi5zY2FsZSk7XG59XG5hc3luYyBmdW5jdGlvbiB1cGRhdGVGb3JWaWV3KHZpZXdTdHIpIHtcbiAgICBjb25zdCB2aWV3UmVmID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih2aWV3U3RyKTtcbiAgICByZXR1cm4gYXdhaXQgbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcbiAgICAgICAgaWYgKHZpZXdSZWY/LnZpZXcgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmVzb2x2ZSh2aWV3UmVmLnZpZXcpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHZpZXdSZWYpIHtcbiAgICAgICAgICAgIGNvbnN0IGhhbmRsZXIgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdmlld1JlZi5yZW1vdmVFdmVudExpc3RlbmVyKFwiYXJjZ2lzVmlld1JlYWR5Q2hhbmdlXCIsIGhhbmRsZXIsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICByZXNvbHZlKHZpZXdSZWYudmlldyk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdmlld1JlZi5hZGRFdmVudExpc3RlbmVyKFwiYXJjZ2lzVmlld1JlYWR5Q2hhbmdlXCIsIGhhbmRsZXIsIGZhbHNlKTtcbiAgICAgICAgfVxuICAgIH0pO1xufVxuYXN5bmMgZnVuY3Rpb24gcmVmZXJlbmNlRWxlbWVudEhlbHBlcihlbGVtZW50LCByZWZFbGVtZW50KSB7XG4gICAgaWYgKHJlZkVsZW1lbnQgPT09IHVuZGVmaW5lZClcbiAgICAgICAgcmV0dXJuO1xuICAgIGVsc2UgaWYgKHR5cGVvZiByZWZFbGVtZW50ID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgIGVsZW1lbnQudmlldyA9IGF3YWl0IHVwZGF0ZUZvclZpZXcocmVmRWxlbWVudCk7XG4gICAgfVxuICAgIGVsc2UgaWYgKGVsZW1lbnQud2lkZ2V0KSB7XG4gICAgICAgIGVsZW1lbnQudmlldyA9IHJlZkVsZW1lbnQudmlldztcbiAgICB9XG59XG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vL1xuLy8gIFByaXZhdGUgTWV0aG9kc1xuLy9cbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbmZ1bmN0aW9uIHdhaXRGb3JWaWV3SGFuZGxlcih2aWV3UmVmLCBlbGVtZW50LCBpc1VzaW5nUmVmZXJuY2VFbGVtZW50KSB7XG4gICAgY29uc3QgaGFuZGxlciA9ICgpID0+IHtcbiAgICAgICAgdmlld1JlZi5yZW1vdmVFdmVudExpc3RlbmVyKFwiYXJjZ2lzVmlld1JlYWR5Q2hhbmdlXCIsIGhhbmRsZXIsIGZhbHNlKTtcbiAgICAgICAgZWxlbWVudC52aWV3ID0gdmlld1JlZi52aWV3O1xuICAgICAgICBpZiAoIWlzVXNpbmdSZWZlcm5jZUVsZW1lbnQpIHtcbiAgICAgICAgICAgIGVsZW1lbnQudmlldy51aS5hZGQoZWxlbWVudC5jaGlsZEVsZW0gPz8gZWxlbWVudC5lbCwgZWxlbWVudC5wb3NpdGlvbik7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHZpZXdSZWYuYWRkRXZlbnRMaXN0ZW5lcihcImFyY2dpc1ZpZXdSZWFkeUNoYW5nZVwiLCBoYW5kbGVyLCBmYWxzZSk7XG59XG5cbmV4cG9ydCB7IGFkZEhhbmRsZXMgYXMgYSwgaXNOb3RTYW1lVmlld3BvaW50IGFzIGIsIGNoZWNrRm9yVmlldyBhcyBjLCBjaGVja0ZvckV4cGFuZCBhcyBkLCBpc05vdFNhbWVDYW1lcmEgYXMgZSwgaXNOb3RTYW1lRW52aXJvbm1lbnQgYXMgZiwgaXNWYWxpZEludGVnZXIgYXMgZywgaXNOdWxsT3JFbXB0eVN0cmluZyBhcyBpLCByZWZlcmVuY2VFbGVtZW50SGVscGVyIGFzIHIgfTtcbiIsIi8qIVxuICogQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFc3JpLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAqIFNlZSBodHRwczovL2pzLmFyY2dpcy5jb20vNC4zMC9lc3JpL2NvcHlyaWdodC50eHQgZm9yIGRldGFpbHMuXG4gKiB2NC4zMC4wLW5leHQuMzdcbiAqL1xuZnVuY3Rpb24gb25EaXNjb25uZWN0ZWRIZWxwZXIoZWxlbWVudCkge1xuICAgIGlmIChlbGVtZW50LmNoaWxkRWxlbSkge1xuICAgICAgICBpZiAoIWVsZW1lbnQuZWwuaXNDb25uZWN0ZWQpIHtcbiAgICAgICAgICAgIGlmIChlbGVtZW50LnZpZXcpIHtcbiAgICAgICAgICAgICAgICBlbGVtZW50LnZpZXcudWkucmVtb3ZlKGVsZW1lbnQuY2hpbGRFbGVtKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGVsZW1lbnQud2lkZ2V0Py52aWV3KSB7XG4gICAgICAgICAgICAgICAgZWxlbWVudC53aWRnZXQudmlldy51aS5yZW1vdmUoZWxlbWVudC5jaGlsZEVsZW0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGVsZW1lbnQuX3dhdGNoSGFuZGxlcykge1xuICAgICAgICAgICAgICAgIGVsZW1lbnQuX3dhdGNoSGFuZGxlcy5mb3JFYWNoKChoYW5kbGUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxlbWVudC5fd2F0Y2hIYW5kbGVzID0gW107XG4gICAgICAgICAgICBlbGVtZW50LndpZGdldD8uZGVzdHJveSgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIGlmICghZWxlbWVudC5lbC5pc0Nvbm5lY3RlZCkge1xuICAgICAgICAgICAgICAgIGlmIChlbGVtZW50LnZpZXcpIHtcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC52aWV3LnVpLnJlbW92ZShlbGVtZW50LmVsKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoZWxlbWVudC53aWRnZXQ/LnZpZXcpIHtcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC53aWRnZXQudmlldy51aS5yZW1vdmUoZWxlbWVudC5lbCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChlbGVtZW50Ll93YXRjaEhhbmRsZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5fd2F0Y2hIYW5kbGVzLmZvckVhY2goKGhhbmRsZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxlbWVudC5fd2F0Y2hIYW5kbGVzID0gW107XG4gICAgICAgICAgICAgICAgZWxlbWVudC53aWRnZXQ/LmRlc3Ryb3koKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwgMTAwMCk7XG4gICAgfVxufVxuXG5leHBvcnQgeyBvbkRpc2Nvbm5lY3RlZEhlbHBlciBhcyBvIH07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=