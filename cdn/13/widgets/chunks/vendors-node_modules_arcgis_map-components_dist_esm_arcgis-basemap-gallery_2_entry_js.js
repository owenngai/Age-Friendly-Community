"use strict";
(self["webpackChunkexb_client"] = self["webpackChunkexb_client"] || []).push([["vendors-node_modules_arcgis_map-components_dist_esm_arcgis-basemap-gallery_2_entry_js"],{

/***/ "./node_modules/@arcgis/map-components/dist/esm/arcgis-basemap-gallery_2.entry.js":
/*!****************************************************************************************!*\
  !*** ./node_modules/@arcgis/map-components/dist/esm/arcgis-basemap-gallery_2.entry.js ***!
  \****************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   arcgis_basemap_gallery: () => (/* binding */ ArcgisBasemapGallery),
/* harmony export */   arcgis_map: () => (/* binding */ ArcgisMap)
/* harmony export */ });
/* harmony import */ var _index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-6e172aac.js */ "./node_modules/@arcgis/map-components/dist/esm/index-6e172aac.js");
/* harmony import */ var _index_0bc55ca5_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./index-0bc55ca5.js */ "./node_modules/@arcgis/map-components/dist/esm/index-0bc55ca5.js");
/* harmony import */ var _component_utils_23194f7c_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./component-utils-23194f7c.js */ "./node_modules/@arcgis/map-components/dist/esm/component-utils-23194f7c.js");
/* harmony import */ var _disconnected_6cf1c100_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./disconnected-6cf1c100.js */ "./node_modules/@arcgis/map-components/dist/esm/disconnected-6cf1c100.js");
/*!
 * All material copyright Esri, All Rights Reserved, unless otherwise specified.
 * See https://js.arcgis.com/4.30/esri/copyright.txt for details.
 * v4.30.0-next.37
 */





const basemapGalleryCss = "";

const ArcgisBasemapGallery = class {
    constructor(hostRef) {
        (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);
        this.arcgisBasemapGalleryReady = (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "arcgisBasemapGalleryReady", 7);
        this.arcgisPropertyChange = (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "arcgisPropertyChange", 7);
        this._watchHandles = [];
        this.referenceElement = undefined;
        this.activeBasemap = undefined;
        this.disabled = false;
        this.icon = undefined;
        this.source = undefined;
        this.position = "bottom-left";
        this.view = undefined;
        this.widget = undefined;
    }
    referenceElementWatcher(value) {
        void (0,_component_utils_23194f7c_js__WEBPACK_IMPORTED_MODULE_2__.r)(this, value);
    }
    disabledWatcher(value, old) {
        if (this.widget && value !== old) {
            this.widget.disabled = value;
        }
    }
    iconWatcher(value) {
        if (this.widget) {
            this.widget.icon = value;
        }
    }
    sourceWatcher(value) {
        if (this.widget) {
            this.widget.source = value;
        }
    }
    positionWatcher(value) {
        if (value !== undefined && this.widget) {
            this.view.ui.move(this.childElem, value);
        }
    }
    viewWatcher(value) {
        if (value !== undefined && this.widget) {
            this.widget.view = value;
        }
    }
    //--------------------------------------------------------------------------
    //
    //  Lifecycle
    //
    //--------------------------------------------------------------------------
    async componentDidLoad() {
        const params = this._createParams();
        const widget = await (0,_index_0bc55ca5_js__WEBPACK_IMPORTED_MODULE_1__.n)(params);
        this.widget = widget;
        await this._addWatchers();
        this._addContainer();
        this.arcgisBasemapGalleryReady.emit();
        (0,_component_utils_23194f7c_js__WEBPACK_IMPORTED_MODULE_2__.c)(this);
    }
    disconnectedCallback() {
        (0,_disconnected_6cf1c100_js__WEBPACK_IMPORTED_MODULE_3__.o)(this);
    }
    render() {
        return (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { ref: (el) => (this.childElem = el) });
    }
    //--------------------------------------------------------------------------
    //
    //  Private Interal Methods
    //
    //--------------------------------------------------------------------------
    _addContainer() {
        this.widget.container = this.childElem;
    }
    async _addWatchers() {
        const { watch } = await (0,_index_0bc55ca5_js__WEBPACK_IMPORTED_MODULE_1__.i)();
        (0,_component_utils_23194f7c_js__WEBPACK_IMPORTED_MODULE_2__.a)(this, [
            watch(() => this.widget.source, () => (this.source = this.widget.source), {
                initial: true,
            }),
            watch(() => this.widget.activeBasemap, (basemap) => {
                this.activeBasemap = basemap;
                this.arcgisPropertyChange.emit({ name: "activeBasemap" });
            }, {
                initial: true,
            }),
            watch(() => this.widget.disabled, (value) => (this.disabled = value)),
        ]);
    }
    _createParams() {
        const params = {};
        if (this.icon) {
            params.icon = this.icon;
        }
        if (this.source) {
            params.source = this.source;
        }
        if (this.view) {
            params.view = this.view;
        }
        return params;
    }
    get el() { return (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.g)(this); }
    static get watchers() { return {
        "referenceElement": ["referenceElementWatcher"],
        "disabled": ["disabledWatcher"],
        "icon": ["iconWatcher"],
        "source": ["sourceWatcher"],
        "position": ["positionWatcher"],
        "view": ["viewWatcher"]
    }; }
};
ArcgisBasemapGallery.style = basemapGalleryCss;

const mapCss = ".arcgis-map{padding:0;margin:0;height:100%;width:100%}";

const ArcgisMap = class {
    constructor(hostRef) {
        (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);
        this.arcgisViewReadyChange = (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "arcgisViewReadyChange", 7);
        this.arcgisViewChange = (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "arcgisViewChange", 7);
        this.arcgisViewClick = (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "arcgisViewClick", 7);
        this.arcgisViewDoubleClick = (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "arcgisViewDoubleClick", 7);
        this.arcgisViewDrag = (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "arcgisViewDrag", 7);
        this.arcgisViewHold = (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "arcgisViewHold", 7);
        this.arcgisViewImmediateClick = (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "arcgisViewImmediateClick", 7);
        this.arcgisViewImmediateDoubleClick = (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "arcgisViewImmediateDoubleClick", 7);
        this.arcgisViewKeyDown = (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "arcgisViewKeyDown", 7);
        this.arcgisViewKeyUp = (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "arcgisViewKeyUp", 7);
        this.arcgisViewLayerviewCreate = (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "arcgisViewLayerviewCreate", 7);
        this.arcgisViewLayerviewCreateError = (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "arcgisViewLayerviewCreateError", 7);
        this.arcgisViewLayerviewDestroy = (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "arcgisViewLayerviewDestroy", 7);
        this.arcgisViewMouseWheel = (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "arcgisViewMouseWheel", 7);
        this.arcgisViewPointerDown = (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "arcgisViewPointerDown", 7);
        this.arcgisViewPointerEnter = (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "arcgisViewPointerEnter", 7);
        this.arcgisViewPointerLeave = (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "arcgisViewPointerLeave", 7);
        this.arcgisViewPointerMove = (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "arcgisViewPointerMove", 7);
        this.arcgisViewPointerUp = (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "arcgisViewPointerUp", 7);
        this._watchHandles = [];
        this.allLayerViews = undefined;
        this.background = undefined;
        this.basemapView = undefined;
        this.basemap = undefined;
        this.center = undefined;
        this.constraints = undefined;
        this.destroyDisabled = false;
        this.extent = undefined;
        this.fatalError = undefined;
        this.floors = undefined;
        this.gamepad = undefined;
        this.graphics = undefined;
        this.highlightOptions = undefined;
        this.interacting = false;
        this.itemId = undefined;
        this.layerViews = undefined;
        this.magnifier = undefined;
        this.map = undefined;
        this.navigating = false;
        this.navigation = undefined;
        this.padding = undefined;
        this.popup = undefined;
        this.popupEnabled = true;
        this.ready = false;
        this.resizeAlign = undefined;
        this.resolution = undefined;
        this.rotation = 0;
        this.scale = undefined;
        this.spatialReference = undefined;
        this.stationary = undefined;
        this.suspended = true;
        this.theme = undefined;
        this.timeExtent = undefined;
        this.timeZone = "system";
        this.toMap = undefined;
        this.toScreen = undefined;
        this.updating = false;
        this.viewpoint = undefined;
        this.zoom = undefined;
        this.view = undefined;
    }
    backgroundWatcher(value) {
        if (this.view) {
            this.background = value;
        }
    }
    basemapWatcher(value) {
        if (typeof value === "string" && this.view?.map && !(0,_component_utils_23194f7c_js__WEBPACK_IMPORTED_MODULE_2__.i)(value)) {
            this.view.map.basemap = value;
        }
        else if (this.view?.map) {
            this.view.map.basemap = value;
        }
    }
    centerWatcher(value, old) {
        if (value !== old && this.view) {
            if (typeof value === "string") {
                // check if center is string
                const center = value.split(",").map((x) => Number(x));
                if (center[0] !== this.view.center.longitude && center[1] !== this.view.center.latitude) {
                    this.view.center = center;
                }
            }
            else if (Array.isArray(value)) {
                // array
                if (value[0] !== this.view.center.longitude && value[1] !== this.view.center.latitude) {
                    this.view.center = value;
                }
            }
            else if (!this.view.center.equals(value)) {
                // finally a point
                this.view.center = value;
            }
        }
    }
    constraintsWatcher(value) {
        if (this.view) {
            this.view.constraints = value;
        }
    }
    extentWatcher(value) {
        if (this.view && value && !this.view.extent.equals(value)) {
            this.view.extent = value;
        }
    }
    floorsWatcher(value) {
        if (this.view) {
            this.view.floors = value;
        }
    }
    graphicsWatcher(value) {
        if (this.view) {
            this.view.graphics = value;
        }
    }
    highlightOptionsWatcher(value) {
        if (this.view) {
            this.view.highlightOptions = value;
        }
    }
    itemIdWatcher(value, old) {
        // NOTE: there is an issue when users set the value to undefined.
        // https://github.com/ionic-team/stencil/issues/2814
        // If user sets `itemid` to `undefined`, Stencil 2 will log the following warning:
        // `The state/prop "${propName}" changed during rendering.`
        // `This can potentially lead to infinite-loops and other bugs.`
        //
        // It appears consumer setting the value to null does not cause this warning.
        // In Stencil 4, if a user sets property to undefined, will trigger change, but
        // will not remove attribute from DOM.
        if (value !== old) {
            if (this.view?.map) {
                void this._updateMap();
            }
            else {
                void this._loadMap();
            }
        }
    }
    mapWatcher(value) {
        if (this.view) {
            this.view.map = value;
        }
    }
    navigationWatcher(value) {
        if (this.view) {
            this.view.navigation = value;
        }
    }
    paddingWatcher(value) {
        if (this.view) {
            this.view.padding = value;
        }
    }
    popupWatcher(value) {
        if (this.view) {
            this.view.popup = value;
        }
    }
    popupEnabledWatcher(value, old) {
        if (value !== old && this.view) {
            this.view.popupEnabled = value;
        }
    }
    resizeAlignWatcher(value) {
        if (this.view) {
            this.view.resizeAlign = value;
        }
    }
    rotationWatcher(value) {
        if (this.view && this.view.rotation !== value) {
            this.view.rotation = value;
        }
    }
    scaleWatcher(value, old) {
        if (!this.view?.interacting && value != null && value !== old) {
            this.view.scale = value;
        }
    }
    spatialReferenceWatcher(value) {
        if (this.view && value && !this.view.spatialReference.equals(value)) {
            this.view.spatialReference = value;
        }
    }
    themeWatcher(value) {
        if (this.view) {
            this.view.theme = value;
        }
    }
    timeExtentWatcher(value) {
        if (this.view) {
            this.view.timeExtent = value;
        }
    }
    timeZoneWatcher(value) {
        if (this.view) {
            this.view.timeZone = value;
        }
    }
    viewpointWatcher(value) {
        if (this.view && (0,_component_utils_23194f7c_js__WEBPACK_IMPORTED_MODULE_2__.b)(this.view.viewpoint, value)) {
            this.view.viewpoint = value;
        }
    }
    zoomWatcher(value, old) {
        if (!this.view?.interacting && value != null && value !== old) {
            this.view.zoom = value;
        }
    }
    //--------------------------------------------------------------------------
    //
    //  Methods
    //
    //--------------------------------------------------------------------------
    /**
     * Closes the popup.
     */
    async closePopup() {
        this.view?.closePopup();
    }
    /**
     * Destroys the view, and any associated resources, including its map, popup, and UI elements.
     */
    async destroy() {
        if (this.destroyDisabled) {
            this._clearWatchHandles();
            this.view.destroy();
        }
    }
    /**
     * Sets the view to a given target.
     */
    async goTo(target, options) {
        return (await this.view?.goTo(target, options));
    }
    /**
     * Returns hit test results from each layer that intersects the specified screen coordinates.
     */
    async hitTest(screenPoint, options) {
        return await this.view?.hitTest(screenPoint, options);
    }
    /**
     * Opens the popup at the given location with content defined either explicitly with content or driven
     * from the PopupTemplate of input features.
     */
    async openPopup(options) {
        return void this.view?.openPopup(options);
    }
    /**
     * Create a screenshot of the current view.
     */
    async takeScreenshot(options) {
        return await this.view?.takeScreenshot(options);
    }
    /**
     * Call this method to clear any fatal errors resulting from a lost WebGL context.
     */
    async tryFatalErrorRecovery() {
        this.view?.tryFatalErrorRecovery();
    }
    /**
     * Gets the LayerView created on the view for the given layer.
     */
    async whenLayerView(layer) {
        return await this.view?.whenLayerView(layer);
    }
    //--------------------------------------------------------------------------
    //
    //  Lifecycle
    //
    //--------------------------------------------------------------------------
    async componentWillLoad() {
        if (!this.view) {
            await this._loadMap();
        }
    }
    componentDidRender() {
        if (this.view && !this.view.container) {
            this.view.container = this.el;
        }
    }
    componentDidLoad() {
        this._proxyEvents();
    }
    disconnectedCallback() {
        void this.destroy();
    }
    render() {
        return (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "arcgis-map", ref: (el) => (this.el = el) });
    }
    //--------------------------------------------------------------------------
    //
    //  Private Methods
    //
    //--------------------------------------------------------------------------
    _clearWatchHandles() {
        this._watchHandles.forEach((handle) => handle.remove());
        this._watchHandles = [];
    }
    async _addWatchers() {
        const { watch, when } = await (0,_index_0bc55ca5_js__WEBPACK_IMPORTED_MODULE_1__.i)();
        (0,_component_utils_23194f7c_js__WEBPACK_IMPORTED_MODULE_2__.a)(this, [
            // watch for stationary and emit arcgisViewChange event
            watch(() => this.view.stationary, () => {
                this.stationary = this.view.stationary;
                this.interacting = this.view.interacting;
                this.navigating = this.view.navigating;
                this.arcgisViewChange.emit();
            }, {
                initial: true,
            }),
            // when view stationary is true, update these props:
            // zoom, scale, center, rotation, extent, camera, viewpoint
            when(() => this.view.stationary, () => {
                this.center = this.view.center;
                this.extent = this.view.extent;
                this.scale = this.view.scale;
                this.viewpoint = this.view.viewpoint;
                this.zoom = this.view.zoom;
                this.spatialReference = this.view.spatialReference;
            }),
            // watchers for other props to update component
            watch(() => this.view.allLayerViews, () => {
                this.allLayerViews = this.view.allLayerViews;
            }, {
                initial: true,
            }),
            watch(() => this.view.map?.basemap, () => {
                this.basemap = this.view.map?.basemap;
            }, {
                initial: true,
            }),
            watch(() => this.view.fatalError, () => {
                this.fatalError = this.view.fatalError;
            }, {
                initial: true,
            }),
            watch(() => this.view.input.gamepad, () => {
                this.gamepad = this.view.input.gamepad;
            }, {
                initial: true,
            }),
            watch(() => this.view.graphics, () => {
                this.graphics = this.view.graphics;
            }, {
                initial: true,
            }),
            watch(() => this.view.layerViews, () => {
                this.layerViews = this.view.layerViews;
            }, {
                initial: true,
            }),
            watch(() => this.view.navigation, () => {
                this.navigation = this.view.navigation;
            }, {
                initial: true,
            }),
            watch(() => this.view.map, () => {
                this.map = this.view.map;
            }, {
                initial: true,
            }),
            watch(() => this.view.popup, () => {
                this.popup = this.view.popup;
            }, {
                initial: true,
            }),
            watch(() => this.view.resolution, () => {
                this.resolution = this.view.resolution;
            }, {
                initial: true,
            }),
            watch(() => this.view.rotation, () => {
                this.rotation = this.view.rotation;
            }, {
                initial: true,
            }),
            watch(() => this.view.suspended, () => {
                this.suspended = this.view.suspended;
            }, {
                initial: true,
            }),
            watch(() => this.view.updating, () => {
                this.updating = this.view.updating;
            }, {
                initial: true,
            }),
            // watch for ready and emit arcgisViewReadyChange event
            watch(() => this.view.ready, () => {
                this.ready = this.view.ready;
                this.arcgisViewReadyChange.emit();
            }, {
                initial: true,
            }),
        ]);
    }
    async _createMap() {
        const mapParams = {};
        if (this.itemId) {
            mapParams.portalItem = await this._createPortalItem();
        }
        if (this.basemap) {
            mapParams.basemap = this.basemap;
        }
        else if ((0,_component_utils_23194f7c_js__WEBPACK_IMPORTED_MODULE_2__.i)(this.itemId)) {
            mapParams.basemap = "topo-vector";
        }
        const map = await (0,_index_0bc55ca5_js__WEBPACK_IMPORTED_MODULE_1__.a)(mapParams);
        return map;
    }
    async _createPortalItem() {
        const itemProps = {};
        if (this.itemId) {
            itemProps.id = this.itemId;
        }
        return itemProps;
    }
    _createViewParams() {
        const params = {};
        if (this.background) {
            params.background = this.background;
        }
        if (this.center) {
            if (typeof this.center === "string") {
                params.center = this.center.split(",").map((x) => Number(x));
            }
            else {
                params.center = this.center;
            }
        }
        if (this.constraints) {
            params.constraints = this.constraints;
        }
        if (this.extent) {
            params.extent = this.extent;
        }
        if (this.floors) {
            params.floors = this.floors;
        }
        if (this.graphics) {
            params.graphics = this.graphics;
        }
        if (this.highlightOptions) {
            params.highlightOptions = this.highlightOptions;
        }
        if (this.map) {
            params.map = this.map;
        }
        if (this.navigation) {
            params.navigation = this.navigation;
        }
        if (this.padding) {
            params.padding = this.padding;
        }
        if (this.popup) {
            params.popup = this.popup;
        }
        if (this.popupEnabled !== undefined) {
            params.popupEnabled = this.popupEnabled;
        }
        if (this.rotation !== undefined) {
            params.rotation = this.rotation;
        }
        if (this.scale !== undefined) {
            params.scale = this.scale;
        }
        if (this.spatialReference) {
            params.spatialReference = this.spatialReference;
        }
        if (this.theme) {
            params.theme = this.theme;
        }
        if (this.timeExtent) {
            params.timeExtent = this.timeExtent;
        }
        if (this.timeZone) {
            params.timeZone = this.timeZone;
        }
        if (this.viewpoint) {
            params.viewpoint = this.viewpoint;
        }
        if (this.zoom !== undefined) {
            params.zoom = this.zoom;
        }
        return params;
    }
    async _loadMap() {
        this.map || (this.map = await this._createMap());
        const params = this._createViewParams();
        const view = await (0,_index_0bc55ca5_js__WEBPACK_IMPORTED_MODULE_1__.b)({
            ...params,
        });
        this.view = view;
        return void view.when(async () => {
            // proxy view functions
            this.toMap = view.toMap.bind(view);
            this.toScreen = view.toScreen.bind(view);
            await this._addWatchers();
        });
    }
    _proxyEvents() {
        (0,_component_utils_23194f7c_js__WEBPACK_IMPORTED_MODULE_2__.a)(this, [
            this.view.on("click", (event) => {
                this.arcgisViewClick.emit(event);
            }),
            this.view.on("double-click", (event) => {
                this.arcgisViewDoubleClick.emit(event);
            }),
            this.view.on("drag", (event) => {
                this.arcgisViewDrag.emit(event);
            }),
            this.view.on("hold", (event) => {
                this.arcgisViewHold.emit(event);
            }),
            this.view.on("immediate-click", (event) => {
                this.arcgisViewImmediateClick.emit(event);
            }),
            this.view.on("immediate-double-click", (event) => {
                this.arcgisViewImmediateDoubleClick.emit(event);
            }),
            this.view.on("key-down", (event) => {
                this.arcgisViewKeyDown.emit(event);
            }),
            this.view.on("key-up", (event) => {
                this.arcgisViewKeyUp.emit(event);
            }),
            this.view.on("layerview-create", (event) => {
                this.arcgisViewLayerviewCreate.emit(event);
            }),
            this.view.on("layerview-create-error", (event) => {
                this.arcgisViewLayerviewCreateError.emit(event);
            }),
            this.view.on("layerview-destroy", (event) => {
                this.arcgisViewLayerviewDestroy.emit(event);
            }),
            this.view.on("mouse-wheel", (event) => {
                this.arcgisViewMouseWheel.emit(event);
            }),
            this.view.on("pointer-down", (event) => {
                this.arcgisViewPointerDown.emit(event);
            }),
            this.view.on("pointer-enter", (event) => {
                this.arcgisViewPointerEnter.emit(event);
            }),
            this.view.on("pointer-leave", (event) => {
                this.arcgisViewPointerLeave.emit(event);
            }),
            this.view.on("pointer-move", (event) => {
                this.arcgisViewPointerMove.emit(event);
            }),
            this.view.on("pointer-up", (event) => {
                this.arcgisViewPointerUp.emit(event);
            }),
        ]);
    }
    async _updateMap() {
        if (this.view?.map) {
            this.view.map.destroy();
            const map = await this._createMap();
            this.view.map = map;
        }
    }
    get _hostElement() { return (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.g)(this); }
    static get watchers() { return {
        "background": ["backgroundWatcher"],
        "basemap": ["basemapWatcher"],
        "center": ["centerWatcher"],
        "constraints": ["constraintsWatcher"],
        "extent": ["extentWatcher"],
        "floors": ["floorsWatcher"],
        "graphics": ["graphicsWatcher"],
        "highlightOptions": ["highlightOptionsWatcher"],
        "itemId": ["itemIdWatcher"],
        "map": ["mapWatcher"],
        "navigation": ["navigationWatcher"],
        "padding": ["paddingWatcher"],
        "popup": ["popupWatcher"],
        "popupEnabled": ["popupEnabledWatcher"],
        "resizeAlign": ["resizeAlignWatcher"],
        "rotation": ["rotationWatcher"],
        "scale": ["scaleWatcher"],
        "spatialReference": ["spatialReferenceWatcher"],
        "theme": ["themeWatcher"],
        "timeExtent": ["timeExtentWatcher"],
        "timeZone": ["timeZoneWatcher"],
        "viewpoint": ["viewpointWatcher"],
        "zoom": ["zoomWatcher"]
    }; }
};
ArcgisMap.style = mapCss;




/***/ }),

/***/ "./node_modules/@arcgis/map-components/dist/esm/component-utils-23194f7c.js":
/*!**********************************************************************************!*\
  !*** ./node_modules/@arcgis/map-components/dist/esm/component-utils-23194f7c.js ***!
  \**********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   a: () => (/* binding */ addHandles),
/* harmony export */   b: () => (/* binding */ isNotSameViewpoint),
/* harmony export */   c: () => (/* binding */ checkForView),
/* harmony export */   d: () => (/* binding */ checkForExpand),
/* harmony export */   e: () => (/* binding */ isNotSameCamera),
/* harmony export */   f: () => (/* binding */ isNotSameEnvironment),
/* harmony export */   g: () => (/* binding */ isValidInteger),
/* harmony export */   i: () => (/* binding */ isNullOrEmptyString),
/* harmony export */   r: () => (/* binding */ referenceElementHelper)
/* harmony export */ });
/*!
 * All material copyright Esri, All Rights Reserved, unless otherwise specified.
 * See https://js.arcgis.com/4.30/esri/copyright.txt for details.
 * v4.30.0-next.37
 */
function checkForExpand(element) {
    const expandRef = element.el.closest("arcgis-expand") ?? element.expandElem;
    if (expandRef?.widget) {
        element.view = expandRef.view;
        expandRef.widget.content = element.childElem ?? element.el;
        // TODO: Update to be expandIcon = widget.icon, not ready yet in 4.27next
        if (!expandRef.expandIcon) {
            expandRef.widget.expandIcon = element.widget ? element.widget.icon : element?.icon;
        }
        return true;
    }
    if (expandRef) {
        const widgetHandler = () => {
            expandRef.removeEventListener("arcgisExpandReady", widgetHandler, false);
            element.view = expandRef.view;
            expandRef.widget.content = element.childElem ?? element.el;
            if (!expandRef.expandIcon) {
                expandRef.widget.expandIcon = element.widget ? element.widget.icon : element?.icon;
            }
        };
        expandRef.addEventListener("arcgisExpandReady", widgetHandler, false);
        return true;
    }
    return false;
}

//--------------------------------------------------------------------------
//
//  Public Methods
//
//--------------------------------------------------------------------------
function addHandles(element, handle) {
    if (Array.isArray(handle)) {
        element._watchHandles = [...element._watchHandles, ...handle];
    }
    else {
        element._watchHandles.push(handle);
    }
}
function checkForView(element) {
    let isUsingReferenceElement = false;
    if (!checkForExpand(element)) {
        let viewRef = element.el.closest("arcgis-map") ?? element.el.closest("arcgis-scene");
        if (!viewRef && typeof element.referenceElement === "string") {
            viewRef = document.querySelector(element.referenceElement);
            isUsingReferenceElement = true;
        }
        if (viewRef?.view) {
            element.view = viewRef.view;
            const el = element.childElem ?? element.el;
            if (!isUsingReferenceElement) {
                element.view.ui.add(el, element.position);
            }
        }
        else if (viewRef) {
            waitForViewHandler(viewRef, element, isUsingReferenceElement);
        }
    }
    else {
        const viewRef = element.el.closest("arcgis-map") ?? element.el.closest("arcgis-scene");
        if (viewRef?.view) {
            element.view = viewRef.view;
        }
        else if (viewRef) {
            const handler = () => {
                viewRef.removeEventListener("arcgisViewReadyChange", handler, false);
                element.view = viewRef.view;
            };
            viewRef.addEventListener("arcgisViewReadyChange", handler, false);
        }
    }
}
function isNullOrEmptyString(value) {
    return value === undefined || value === null || value === "";
}
function isValidInteger(value) {
    return value != null && value % 1 === 0;
}
function isNotSameCamera(camera, camera2) {
    return (camera2 === undefined ||
        camera.position !== camera2.position ||
        camera.heading !== camera2.heading ||
        camera.tilt !== camera2.tilt);
}
function isNotSameEnvironment(environment, environment2) {
    return (environment2 === undefined ||
        environment2.atmosphereEnabled !== environment.atmosphereEnabled ||
        environment2.lighting.date !== environment.lighting.date ||
        environment2.lighting.directShadowsEnabled !==
            environment.lighting.directShadowsEnabled ||
        environment2.lighting.cameraTrackingEnabled !==
            environment.lighting.cameraTrackingEnabled ||
        environment2.lighting.date !== environment.lighting.date ||
        environment2.lighting.displayUTCOffset !==
            environment.lighting.displayUTCOffset);
}
function isNotSameViewpoint(viewpoint, viewpoint2) {
    return (viewpoint2 === undefined ||
        viewpoint.targetGeometry !== viewpoint2.targetGeometry ||
        viewpoint.rotation !== viewpoint2.rotation ||
        viewpoint.scale !== viewpoint2.scale);
}
async function updateForView(viewStr) {
    const viewRef = document.querySelector(viewStr);
    return await new Promise((resolve) => {
        if (viewRef?.view !== undefined) {
            resolve(viewRef.view);
        }
        else if (viewRef) {
            const handler = () => {
                viewRef.removeEventListener("arcgisViewReadyChange", handler, false);
                resolve(viewRef.view);
            };
            viewRef.addEventListener("arcgisViewReadyChange", handler, false);
        }
    });
}
async function referenceElementHelper(element, refElement) {
    if (refElement === undefined)
        return;
    else if (typeof refElement === "string") {
        element.view = await updateForView(refElement);
    }
    else if (element.widget) {
        element.view = refElement.view;
    }
}
//--------------------------------------------------------------------------
//
//  Private Methods
//
//--------------------------------------------------------------------------
function waitForViewHandler(viewRef, element, isUsingRefernceElement) {
    const handler = () => {
        viewRef.removeEventListener("arcgisViewReadyChange", handler, false);
        element.view = viewRef.view;
        if (!isUsingRefernceElement) {
            element.view.ui.add(element.childElem ?? element.el, element.position);
        }
    };
    viewRef.addEventListener("arcgisViewReadyChange", handler, false);
}




/***/ }),

/***/ "./node_modules/@arcgis/map-components/dist/esm/disconnected-6cf1c100.js":
/*!*******************************************************************************!*\
  !*** ./node_modules/@arcgis/map-components/dist/esm/disconnected-6cf1c100.js ***!
  \*******************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   o: () => (/* binding */ onDisconnectedHelper)
/* harmony export */ });
/*!
 * All material copyright Esri, All Rights Reserved, unless otherwise specified.
 * See https://js.arcgis.com/4.30/esri/copyright.txt for details.
 * v4.30.0-next.37
 */
function onDisconnectedHelper(element) {
    if (element.childElem) {
        if (!element.el.isConnected) {
            if (element.view) {
                element.view.ui.remove(element.childElem);
            }
            else if (element.widget?.view) {
                element.widget.view.ui.remove(element.childElem);
            }
            if (element._watchHandles) {
                element._watchHandles.forEach((handle) => {
                    handle.remove();
                });
            }
            element._watchHandles = [];
            element.widget?.destroy();
        }
    }
    else {
        setTimeout(() => {
            if (!element.el.isConnected) {
                if (element.view) {
                    element.view.ui.remove(element.el);
                }
                else if (element.widget?.view) {
                    element.widget.view.ui.remove(element.el);
                }
                if (element._watchHandles) {
                    element._watchHandles.forEach((handle) => {
                        handle.remove();
                    });
                }
                element._watchHandles = [];
                element.widget?.destroy();
            }
        }, 1000);
    }
}




/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2lkZ2V0cy9jaHVua3MvdmVuZG9ycy1ub2RlX21vZHVsZXNfYXJjZ2lzX21hcC1jb21wb25lbnRzX2Rpc3RfZXNtX2FyY2dpcy1iYXNlbWFwLWdhbGxlcnlfMl9lbnRyeV9qcy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ2tHO0FBQ3NDO0FBQzJCO0FBQzVGOztBQUV2RTs7QUFFQTtBQUNBO0FBQ0EsUUFBUSxxREFBZ0I7QUFDeEIseUNBQXlDLHFEQUFXO0FBQ3BELG9DQUFvQyxxREFBVztBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSwrREFBc0I7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCLHFEQUF3QjtBQUNyRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsK0RBQVk7QUFDcEI7QUFDQTtBQUNBLFFBQVEsNERBQW9CO0FBQzVCO0FBQ0E7QUFDQSxlQUFlLHFEQUFDLFVBQVUsb0NBQW9DO0FBQzlEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLFFBQVEsUUFBUSxxREFBdUI7QUFDdkQsUUFBUSwrREFBVTtBQUNsQjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxpREFBaUQsdUJBQXVCO0FBQ3hFLGFBQWE7QUFDYjtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsT0FBTyxxREFBVTtBQUNoQyw0QkFBNEI7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLDRCQUE0QixVQUFVLFNBQVMsWUFBWSxXQUFXOztBQUV0RTtBQUNBO0FBQ0EsUUFBUSxxREFBZ0I7QUFDeEIscUNBQXFDLHFEQUFXO0FBQ2hELGdDQUFnQyxxREFBVztBQUMzQywrQkFBK0IscURBQVc7QUFDMUMscUNBQXFDLHFEQUFXO0FBQ2hELDhCQUE4QixxREFBVztBQUN6Qyw4QkFBOEIscURBQVc7QUFDekMsd0NBQXdDLHFEQUFXO0FBQ25ELDhDQUE4QyxxREFBVztBQUN6RCxpQ0FBaUMscURBQVc7QUFDNUMsK0JBQStCLHFEQUFXO0FBQzFDLHlDQUF5QyxxREFBVztBQUNwRCw4Q0FBOEMscURBQVc7QUFDekQsMENBQTBDLHFEQUFXO0FBQ3JELG9DQUFvQyxxREFBVztBQUMvQyxxQ0FBcUMscURBQVc7QUFDaEQsc0NBQXNDLHFEQUFXO0FBQ2pELHNDQUFzQyxxREFBVztBQUNqRCxxQ0FBcUMscURBQVc7QUFDaEQsbUNBQW1DLHFEQUFXO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDREQUE0RCwrREFBbUI7QUFDL0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhCQUE4QixTQUFTO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QiwrREFBa0I7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxxREFBQyxVQUFVLGtEQUFrRDtBQUM1RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLGNBQWMsUUFBUSxxREFBdUI7QUFDN0QsUUFBUSwrREFBVTtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQiwrREFBbUI7QUFDcEM7QUFDQTtBQUNBLDBCQUEwQixxREFBUztBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIscURBQWU7QUFDMUM7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxRQUFRLCtEQUFVO0FBQ2xCO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsT0FBTyxxREFBVTtBQUMxQyw0QkFBNEI7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFbUY7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDL3NCbkY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFeU47Ozs7Ozs7Ozs7Ozs7OztBQ3BKek47QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7O0FBRXFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL25vZGVfbW9kdWxlcy9AYXJjZ2lzL21hcC1jb21wb25lbnRzL2Rpc3QvZXNtL2FyY2dpcy1iYXNlbWFwLWdhbGxlcnlfMi5lbnRyeS5qcyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vbm9kZV9tb2R1bGVzL0BhcmNnaXMvbWFwLWNvbXBvbmVudHMvZGlzdC9lc20vY29tcG9uZW50LXV0aWxzLTIzMTk0ZjdjLmpzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9ub2RlX21vZHVsZXMvQGFyY2dpcy9tYXAtY29tcG9uZW50cy9kaXN0L2VzbS9kaXNjb25uZWN0ZWQtNmNmMWMxMDAuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyohXG4gKiBBbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVzcmksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuICogU2VlIGh0dHBzOi8vanMuYXJjZ2lzLmNvbS80LjMwL2VzcmkvY29weXJpZ2h0LnR4dCBmb3IgZGV0YWlscy5cbiAqIHY0LjMwLjAtbmV4dC4zN1xuICovXG5pbXBvcnQgeyByIGFzIHJlZ2lzdGVySW5zdGFuY2UsIGMgYXMgY3JlYXRlRXZlbnQsIGgsIGcgYXMgZ2V0RWxlbWVudCB9IGZyb20gJy4vaW5kZXgtNmUxNzJhYWMuanMnO1xuaW1wb3J0IHsgbiBhcyBuZXdXaWRnZXRzQmFzZW1hcEdhbGxlcnksIGkgYXMgaW1wb3J0Q29yZVJlYWN0aXZlVXRpbHMsIGEgYXMgbmV3V2ViTWFwLCBiIGFzIG5ld1ZpZXdzTWFwVmlldyB9IGZyb20gJy4vaW5kZXgtMGJjNTVjYTUuanMnO1xuaW1wb3J0IHsgciBhcyByZWZlcmVuY2VFbGVtZW50SGVscGVyLCBjIGFzIGNoZWNrRm9yVmlldywgYSBhcyBhZGRIYW5kbGVzLCBpIGFzIGlzTnVsbE9yRW1wdHlTdHJpbmcsIGIgYXMgaXNOb3RTYW1lVmlld3BvaW50IH0gZnJvbSAnLi9jb21wb25lbnQtdXRpbHMtMjMxOTRmN2MuanMnO1xuaW1wb3J0IHsgbyBhcyBvbkRpc2Nvbm5lY3RlZEhlbHBlciB9IGZyb20gJy4vZGlzY29ubmVjdGVkLTZjZjFjMTAwLmpzJztcblxuY29uc3QgYmFzZW1hcEdhbGxlcnlDc3MgPSBcIlwiO1xuXG5jb25zdCBBcmNnaXNCYXNlbWFwR2FsbGVyeSA9IGNsYXNzIHtcbiAgICBjb25zdHJ1Y3Rvcihob3N0UmVmKSB7XG4gICAgICAgIHJlZ2lzdGVySW5zdGFuY2UodGhpcywgaG9zdFJlZik7XG4gICAgICAgIHRoaXMuYXJjZ2lzQmFzZW1hcEdhbGxlcnlSZWFkeSA9IGNyZWF0ZUV2ZW50KHRoaXMsIFwiYXJjZ2lzQmFzZW1hcEdhbGxlcnlSZWFkeVwiLCA3KTtcbiAgICAgICAgdGhpcy5hcmNnaXNQcm9wZXJ0eUNoYW5nZSA9IGNyZWF0ZUV2ZW50KHRoaXMsIFwiYXJjZ2lzUHJvcGVydHlDaGFuZ2VcIiwgNyk7XG4gICAgICAgIHRoaXMuX3dhdGNoSGFuZGxlcyA9IFtdO1xuICAgICAgICB0aGlzLnJlZmVyZW5jZUVsZW1lbnQgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuYWN0aXZlQmFzZW1hcCA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5kaXNhYmxlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLmljb24gPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuc291cmNlID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLnBvc2l0aW9uID0gXCJib3R0b20tbGVmdFwiO1xuICAgICAgICB0aGlzLnZpZXcgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMud2lkZ2V0ID0gdW5kZWZpbmVkO1xuICAgIH1cbiAgICByZWZlcmVuY2VFbGVtZW50V2F0Y2hlcih2YWx1ZSkge1xuICAgICAgICB2b2lkIHJlZmVyZW5jZUVsZW1lbnRIZWxwZXIodGhpcywgdmFsdWUpO1xuICAgIH1cbiAgICBkaXNhYmxlZFdhdGNoZXIodmFsdWUsIG9sZCkge1xuICAgICAgICBpZiAodGhpcy53aWRnZXQgJiYgdmFsdWUgIT09IG9sZCkge1xuICAgICAgICAgICAgdGhpcy53aWRnZXQuZGlzYWJsZWQgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpY29uV2F0Y2hlcih2YWx1ZSkge1xuICAgICAgICBpZiAodGhpcy53aWRnZXQpIHtcbiAgICAgICAgICAgIHRoaXMud2lkZ2V0Lmljb24gPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzb3VyY2VXYXRjaGVyKHZhbHVlKSB7XG4gICAgICAgIGlmICh0aGlzLndpZGdldCkge1xuICAgICAgICAgICAgdGhpcy53aWRnZXQuc291cmNlID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcG9zaXRpb25XYXRjaGVyKHZhbHVlKSB7XG4gICAgICAgIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkICYmIHRoaXMud2lkZ2V0KSB7XG4gICAgICAgICAgICB0aGlzLnZpZXcudWkubW92ZSh0aGlzLmNoaWxkRWxlbSwgdmFsdWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHZpZXdXYXRjaGVyKHZhbHVlKSB7XG4gICAgICAgIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkICYmIHRoaXMud2lkZ2V0KSB7XG4gICAgICAgICAgICB0aGlzLndpZGdldC52aWV3ID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vXG4gICAgLy8gIExpZmVjeWNsZVxuICAgIC8vXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIGFzeW5jIGNvbXBvbmVudERpZExvYWQoKSB7XG4gICAgICAgIGNvbnN0IHBhcmFtcyA9IHRoaXMuX2NyZWF0ZVBhcmFtcygpO1xuICAgICAgICBjb25zdCB3aWRnZXQgPSBhd2FpdCBuZXdXaWRnZXRzQmFzZW1hcEdhbGxlcnkocGFyYW1zKTtcbiAgICAgICAgdGhpcy53aWRnZXQgPSB3aWRnZXQ7XG4gICAgICAgIGF3YWl0IHRoaXMuX2FkZFdhdGNoZXJzKCk7XG4gICAgICAgIHRoaXMuX2FkZENvbnRhaW5lcigpO1xuICAgICAgICB0aGlzLmFyY2dpc0Jhc2VtYXBHYWxsZXJ5UmVhZHkuZW1pdCgpO1xuICAgICAgICBjaGVja0ZvclZpZXcodGhpcyk7XG4gICAgfVxuICAgIGRpc2Nvbm5lY3RlZENhbGxiYWNrKCkge1xuICAgICAgICBvbkRpc2Nvbm5lY3RlZEhlbHBlcih0aGlzKTtcbiAgICB9XG4gICAgcmVuZGVyKCkge1xuICAgICAgICByZXR1cm4gaChcImRpdlwiLCB7IHJlZjogKGVsKSA9PiAodGhpcy5jaGlsZEVsZW0gPSBlbCkgfSk7XG4gICAgfVxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvL1xuICAgIC8vICBQcml2YXRlIEludGVyYWwgTWV0aG9kc1xuICAgIC8vXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIF9hZGRDb250YWluZXIoKSB7XG4gICAgICAgIHRoaXMud2lkZ2V0LmNvbnRhaW5lciA9IHRoaXMuY2hpbGRFbGVtO1xuICAgIH1cbiAgICBhc3luYyBfYWRkV2F0Y2hlcnMoKSB7XG4gICAgICAgIGNvbnN0IHsgd2F0Y2ggfSA9IGF3YWl0IGltcG9ydENvcmVSZWFjdGl2ZVV0aWxzKCk7XG4gICAgICAgIGFkZEhhbmRsZXModGhpcywgW1xuICAgICAgICAgICAgd2F0Y2goKCkgPT4gdGhpcy53aWRnZXQuc291cmNlLCAoKSA9PiAodGhpcy5zb3VyY2UgPSB0aGlzLndpZGdldC5zb3VyY2UpLCB7XG4gICAgICAgICAgICAgICAgaW5pdGlhbDogdHJ1ZSxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgd2F0Y2goKCkgPT4gdGhpcy53aWRnZXQuYWN0aXZlQmFzZW1hcCwgKGJhc2VtYXApID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmFjdGl2ZUJhc2VtYXAgPSBiYXNlbWFwO1xuICAgICAgICAgICAgICAgIHRoaXMuYXJjZ2lzUHJvcGVydHlDaGFuZ2UuZW1pdCh7IG5hbWU6IFwiYWN0aXZlQmFzZW1hcFwiIH0pO1xuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgIGluaXRpYWw6IHRydWUsXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIHdhdGNoKCgpID0+IHRoaXMud2lkZ2V0LmRpc2FibGVkLCAodmFsdWUpID0+ICh0aGlzLmRpc2FibGVkID0gdmFsdWUpKSxcbiAgICAgICAgXSk7XG4gICAgfVxuICAgIF9jcmVhdGVQYXJhbXMoKSB7XG4gICAgICAgIGNvbnN0IHBhcmFtcyA9IHt9O1xuICAgICAgICBpZiAodGhpcy5pY29uKSB7XG4gICAgICAgICAgICBwYXJhbXMuaWNvbiA9IHRoaXMuaWNvbjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5zb3VyY2UpIHtcbiAgICAgICAgICAgIHBhcmFtcy5zb3VyY2UgPSB0aGlzLnNvdXJjZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy52aWV3KSB7XG4gICAgICAgICAgICBwYXJhbXMudmlldyA9IHRoaXMudmlldztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcGFyYW1zO1xuICAgIH1cbiAgICBnZXQgZWwoKSB7IHJldHVybiBnZXRFbGVtZW50KHRoaXMpOyB9XG4gICAgc3RhdGljIGdldCB3YXRjaGVycygpIHsgcmV0dXJuIHtcbiAgICAgICAgXCJyZWZlcmVuY2VFbGVtZW50XCI6IFtcInJlZmVyZW5jZUVsZW1lbnRXYXRjaGVyXCJdLFxuICAgICAgICBcImRpc2FibGVkXCI6IFtcImRpc2FibGVkV2F0Y2hlclwiXSxcbiAgICAgICAgXCJpY29uXCI6IFtcImljb25XYXRjaGVyXCJdLFxuICAgICAgICBcInNvdXJjZVwiOiBbXCJzb3VyY2VXYXRjaGVyXCJdLFxuICAgICAgICBcInBvc2l0aW9uXCI6IFtcInBvc2l0aW9uV2F0Y2hlclwiXSxcbiAgICAgICAgXCJ2aWV3XCI6IFtcInZpZXdXYXRjaGVyXCJdXG4gICAgfTsgfVxufTtcbkFyY2dpc0Jhc2VtYXBHYWxsZXJ5LnN0eWxlID0gYmFzZW1hcEdhbGxlcnlDc3M7XG5cbmNvbnN0IG1hcENzcyA9IFwiLmFyY2dpcy1tYXB7cGFkZGluZzowO21hcmdpbjowO2hlaWdodDoxMDAlO3dpZHRoOjEwMCV9XCI7XG5cbmNvbnN0IEFyY2dpc01hcCA9IGNsYXNzIHtcbiAgICBjb25zdHJ1Y3Rvcihob3N0UmVmKSB7XG4gICAgICAgIHJlZ2lzdGVySW5zdGFuY2UodGhpcywgaG9zdFJlZik7XG4gICAgICAgIHRoaXMuYXJjZ2lzVmlld1JlYWR5Q2hhbmdlID0gY3JlYXRlRXZlbnQodGhpcywgXCJhcmNnaXNWaWV3UmVhZHlDaGFuZ2VcIiwgNyk7XG4gICAgICAgIHRoaXMuYXJjZ2lzVmlld0NoYW5nZSA9IGNyZWF0ZUV2ZW50KHRoaXMsIFwiYXJjZ2lzVmlld0NoYW5nZVwiLCA3KTtcbiAgICAgICAgdGhpcy5hcmNnaXNWaWV3Q2xpY2sgPSBjcmVhdGVFdmVudCh0aGlzLCBcImFyY2dpc1ZpZXdDbGlja1wiLCA3KTtcbiAgICAgICAgdGhpcy5hcmNnaXNWaWV3RG91YmxlQ2xpY2sgPSBjcmVhdGVFdmVudCh0aGlzLCBcImFyY2dpc1ZpZXdEb3VibGVDbGlja1wiLCA3KTtcbiAgICAgICAgdGhpcy5hcmNnaXNWaWV3RHJhZyA9IGNyZWF0ZUV2ZW50KHRoaXMsIFwiYXJjZ2lzVmlld0RyYWdcIiwgNyk7XG4gICAgICAgIHRoaXMuYXJjZ2lzVmlld0hvbGQgPSBjcmVhdGVFdmVudCh0aGlzLCBcImFyY2dpc1ZpZXdIb2xkXCIsIDcpO1xuICAgICAgICB0aGlzLmFyY2dpc1ZpZXdJbW1lZGlhdGVDbGljayA9IGNyZWF0ZUV2ZW50KHRoaXMsIFwiYXJjZ2lzVmlld0ltbWVkaWF0ZUNsaWNrXCIsIDcpO1xuICAgICAgICB0aGlzLmFyY2dpc1ZpZXdJbW1lZGlhdGVEb3VibGVDbGljayA9IGNyZWF0ZUV2ZW50KHRoaXMsIFwiYXJjZ2lzVmlld0ltbWVkaWF0ZURvdWJsZUNsaWNrXCIsIDcpO1xuICAgICAgICB0aGlzLmFyY2dpc1ZpZXdLZXlEb3duID0gY3JlYXRlRXZlbnQodGhpcywgXCJhcmNnaXNWaWV3S2V5RG93blwiLCA3KTtcbiAgICAgICAgdGhpcy5hcmNnaXNWaWV3S2V5VXAgPSBjcmVhdGVFdmVudCh0aGlzLCBcImFyY2dpc1ZpZXdLZXlVcFwiLCA3KTtcbiAgICAgICAgdGhpcy5hcmNnaXNWaWV3TGF5ZXJ2aWV3Q3JlYXRlID0gY3JlYXRlRXZlbnQodGhpcywgXCJhcmNnaXNWaWV3TGF5ZXJ2aWV3Q3JlYXRlXCIsIDcpO1xuICAgICAgICB0aGlzLmFyY2dpc1ZpZXdMYXllcnZpZXdDcmVhdGVFcnJvciA9IGNyZWF0ZUV2ZW50KHRoaXMsIFwiYXJjZ2lzVmlld0xheWVydmlld0NyZWF0ZUVycm9yXCIsIDcpO1xuICAgICAgICB0aGlzLmFyY2dpc1ZpZXdMYXllcnZpZXdEZXN0cm95ID0gY3JlYXRlRXZlbnQodGhpcywgXCJhcmNnaXNWaWV3TGF5ZXJ2aWV3RGVzdHJveVwiLCA3KTtcbiAgICAgICAgdGhpcy5hcmNnaXNWaWV3TW91c2VXaGVlbCA9IGNyZWF0ZUV2ZW50KHRoaXMsIFwiYXJjZ2lzVmlld01vdXNlV2hlZWxcIiwgNyk7XG4gICAgICAgIHRoaXMuYXJjZ2lzVmlld1BvaW50ZXJEb3duID0gY3JlYXRlRXZlbnQodGhpcywgXCJhcmNnaXNWaWV3UG9pbnRlckRvd25cIiwgNyk7XG4gICAgICAgIHRoaXMuYXJjZ2lzVmlld1BvaW50ZXJFbnRlciA9IGNyZWF0ZUV2ZW50KHRoaXMsIFwiYXJjZ2lzVmlld1BvaW50ZXJFbnRlclwiLCA3KTtcbiAgICAgICAgdGhpcy5hcmNnaXNWaWV3UG9pbnRlckxlYXZlID0gY3JlYXRlRXZlbnQodGhpcywgXCJhcmNnaXNWaWV3UG9pbnRlckxlYXZlXCIsIDcpO1xuICAgICAgICB0aGlzLmFyY2dpc1ZpZXdQb2ludGVyTW92ZSA9IGNyZWF0ZUV2ZW50KHRoaXMsIFwiYXJjZ2lzVmlld1BvaW50ZXJNb3ZlXCIsIDcpO1xuICAgICAgICB0aGlzLmFyY2dpc1ZpZXdQb2ludGVyVXAgPSBjcmVhdGVFdmVudCh0aGlzLCBcImFyY2dpc1ZpZXdQb2ludGVyVXBcIiwgNyk7XG4gICAgICAgIHRoaXMuX3dhdGNoSGFuZGxlcyA9IFtdO1xuICAgICAgICB0aGlzLmFsbExheWVyVmlld3MgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuYmFja2dyb3VuZCA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5iYXNlbWFwVmlldyA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5iYXNlbWFwID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLmNlbnRlciA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5jb25zdHJhaW50cyA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5kZXN0cm95RGlzYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5leHRlbnQgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuZmF0YWxFcnJvciA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5mbG9vcnMgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuZ2FtZXBhZCA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5ncmFwaGljcyA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5oaWdobGlnaHRPcHRpb25zID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLmludGVyYWN0aW5nID0gZmFsc2U7XG4gICAgICAgIHRoaXMuaXRlbUlkID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLmxheWVyVmlld3MgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMubWFnbmlmaWVyID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLm1hcCA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5uYXZpZ2F0aW5nID0gZmFsc2U7XG4gICAgICAgIHRoaXMubmF2aWdhdGlvbiA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5wYWRkaW5nID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLnBvcHVwID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLnBvcHVwRW5hYmxlZCA9IHRydWU7XG4gICAgICAgIHRoaXMucmVhZHkgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5yZXNpemVBbGlnbiA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5yZXNvbHV0aW9uID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLnJvdGF0aW9uID0gMDtcbiAgICAgICAgdGhpcy5zY2FsZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5zcGF0aWFsUmVmZXJlbmNlID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLnN0YXRpb25hcnkgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuc3VzcGVuZGVkID0gdHJ1ZTtcbiAgICAgICAgdGhpcy50aGVtZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy50aW1lRXh0ZW50ID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLnRpbWVab25lID0gXCJzeXN0ZW1cIjtcbiAgICAgICAgdGhpcy50b01hcCA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy50b1NjcmVlbiA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy51cGRhdGluZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLnZpZXdwb2ludCA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy56b29tID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLnZpZXcgPSB1bmRlZmluZWQ7XG4gICAgfVxuICAgIGJhY2tncm91bmRXYXRjaGVyKHZhbHVlKSB7XG4gICAgICAgIGlmICh0aGlzLnZpZXcpIHtcbiAgICAgICAgICAgIHRoaXMuYmFja2dyb3VuZCA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGJhc2VtYXBXYXRjaGVyKHZhbHVlKSB7XG4gICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIgJiYgdGhpcy52aWV3Py5tYXAgJiYgIWlzTnVsbE9yRW1wdHlTdHJpbmcodmFsdWUpKSB7XG4gICAgICAgICAgICB0aGlzLnZpZXcubWFwLmJhc2VtYXAgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLnZpZXc/Lm1hcCkge1xuICAgICAgICAgICAgdGhpcy52aWV3Lm1hcC5iYXNlbWFwID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY2VudGVyV2F0Y2hlcih2YWx1ZSwgb2xkKSB7XG4gICAgICAgIGlmICh2YWx1ZSAhPT0gb2xkICYmIHRoaXMudmlldykge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgICAgIC8vIGNoZWNrIGlmIGNlbnRlciBpcyBzdHJpbmdcbiAgICAgICAgICAgICAgICBjb25zdCBjZW50ZXIgPSB2YWx1ZS5zcGxpdChcIixcIikubWFwKCh4KSA9PiBOdW1iZXIoeCkpO1xuICAgICAgICAgICAgICAgIGlmIChjZW50ZXJbMF0gIT09IHRoaXMudmlldy5jZW50ZXIubG9uZ2l0dWRlICYmIGNlbnRlclsxXSAhPT0gdGhpcy52aWV3LmNlbnRlci5sYXRpdHVkZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnZpZXcuY2VudGVyID0gY2VudGVyO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgLy8gYXJyYXlcbiAgICAgICAgICAgICAgICBpZiAodmFsdWVbMF0gIT09IHRoaXMudmlldy5jZW50ZXIubG9uZ2l0dWRlICYmIHZhbHVlWzFdICE9PSB0aGlzLnZpZXcuY2VudGVyLmxhdGl0dWRlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudmlldy5jZW50ZXIgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICghdGhpcy52aWV3LmNlbnRlci5lcXVhbHModmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgLy8gZmluYWxseSBhIHBvaW50XG4gICAgICAgICAgICAgICAgdGhpcy52aWV3LmNlbnRlciA9IHZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGNvbnN0cmFpbnRzV2F0Y2hlcih2YWx1ZSkge1xuICAgICAgICBpZiAodGhpcy52aWV3KSB7XG4gICAgICAgICAgICB0aGlzLnZpZXcuY29uc3RyYWludHMgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBleHRlbnRXYXRjaGVyKHZhbHVlKSB7XG4gICAgICAgIGlmICh0aGlzLnZpZXcgJiYgdmFsdWUgJiYgIXRoaXMudmlldy5leHRlbnQuZXF1YWxzKHZhbHVlKSkge1xuICAgICAgICAgICAgdGhpcy52aWV3LmV4dGVudCA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGZsb29yc1dhdGNoZXIodmFsdWUpIHtcbiAgICAgICAgaWYgKHRoaXMudmlldykge1xuICAgICAgICAgICAgdGhpcy52aWV3LmZsb29ycyA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGdyYXBoaWNzV2F0Y2hlcih2YWx1ZSkge1xuICAgICAgICBpZiAodGhpcy52aWV3KSB7XG4gICAgICAgICAgICB0aGlzLnZpZXcuZ3JhcGhpY3MgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBoaWdobGlnaHRPcHRpb25zV2F0Y2hlcih2YWx1ZSkge1xuICAgICAgICBpZiAodGhpcy52aWV3KSB7XG4gICAgICAgICAgICB0aGlzLnZpZXcuaGlnaGxpZ2h0T3B0aW9ucyA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGl0ZW1JZFdhdGNoZXIodmFsdWUsIG9sZCkge1xuICAgICAgICAvLyBOT1RFOiB0aGVyZSBpcyBhbiBpc3N1ZSB3aGVuIHVzZXJzIHNldCB0aGUgdmFsdWUgdG8gdW5kZWZpbmVkLlxuICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vaW9uaWMtdGVhbS9zdGVuY2lsL2lzc3Vlcy8yODE0XG4gICAgICAgIC8vIElmIHVzZXIgc2V0cyBgaXRlbWlkYCB0byBgdW5kZWZpbmVkYCwgU3RlbmNpbCAyIHdpbGwgbG9nIHRoZSBmb2xsb3dpbmcgd2FybmluZzpcbiAgICAgICAgLy8gYFRoZSBzdGF0ZS9wcm9wIFwiJHtwcm9wTmFtZX1cIiBjaGFuZ2VkIGR1cmluZyByZW5kZXJpbmcuYFxuICAgICAgICAvLyBgVGhpcyBjYW4gcG90ZW50aWFsbHkgbGVhZCB0byBpbmZpbml0ZS1sb29wcyBhbmQgb3RoZXIgYnVncy5gXG4gICAgICAgIC8vXG4gICAgICAgIC8vIEl0IGFwcGVhcnMgY29uc3VtZXIgc2V0dGluZyB0aGUgdmFsdWUgdG8gbnVsbCBkb2VzIG5vdCBjYXVzZSB0aGlzIHdhcm5pbmcuXG4gICAgICAgIC8vIEluIFN0ZW5jaWwgNCwgaWYgYSB1c2VyIHNldHMgcHJvcGVydHkgdG8gdW5kZWZpbmVkLCB3aWxsIHRyaWdnZXIgY2hhbmdlLCBidXRcbiAgICAgICAgLy8gd2lsbCBub3QgcmVtb3ZlIGF0dHJpYnV0ZSBmcm9tIERPTS5cbiAgICAgICAgaWYgKHZhbHVlICE9PSBvbGQpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnZpZXc/Lm1hcCkge1xuICAgICAgICAgICAgICAgIHZvaWQgdGhpcy5fdXBkYXRlTWFwKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB2b2lkIHRoaXMuX2xvYWRNYXAoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBtYXBXYXRjaGVyKHZhbHVlKSB7XG4gICAgICAgIGlmICh0aGlzLnZpZXcpIHtcbiAgICAgICAgICAgIHRoaXMudmlldy5tYXAgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBuYXZpZ2F0aW9uV2F0Y2hlcih2YWx1ZSkge1xuICAgICAgICBpZiAodGhpcy52aWV3KSB7XG4gICAgICAgICAgICB0aGlzLnZpZXcubmF2aWdhdGlvbiA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHBhZGRpbmdXYXRjaGVyKHZhbHVlKSB7XG4gICAgICAgIGlmICh0aGlzLnZpZXcpIHtcbiAgICAgICAgICAgIHRoaXMudmlldy5wYWRkaW5nID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcG9wdXBXYXRjaGVyKHZhbHVlKSB7XG4gICAgICAgIGlmICh0aGlzLnZpZXcpIHtcbiAgICAgICAgICAgIHRoaXMudmlldy5wb3B1cCA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHBvcHVwRW5hYmxlZFdhdGNoZXIodmFsdWUsIG9sZCkge1xuICAgICAgICBpZiAodmFsdWUgIT09IG9sZCAmJiB0aGlzLnZpZXcpIHtcbiAgICAgICAgICAgIHRoaXMudmlldy5wb3B1cEVuYWJsZWQgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXNpemVBbGlnbldhdGNoZXIodmFsdWUpIHtcbiAgICAgICAgaWYgKHRoaXMudmlldykge1xuICAgICAgICAgICAgdGhpcy52aWV3LnJlc2l6ZUFsaWduID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcm90YXRpb25XYXRjaGVyKHZhbHVlKSB7XG4gICAgICAgIGlmICh0aGlzLnZpZXcgJiYgdGhpcy52aWV3LnJvdGF0aW9uICE9PSB2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy52aWV3LnJvdGF0aW9uID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc2NhbGVXYXRjaGVyKHZhbHVlLCBvbGQpIHtcbiAgICAgICAgaWYgKCF0aGlzLnZpZXc/LmludGVyYWN0aW5nICYmIHZhbHVlICE9IG51bGwgJiYgdmFsdWUgIT09IG9sZCkge1xuICAgICAgICAgICAgdGhpcy52aWV3LnNjYWxlID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3BhdGlhbFJlZmVyZW5jZVdhdGNoZXIodmFsdWUpIHtcbiAgICAgICAgaWYgKHRoaXMudmlldyAmJiB2YWx1ZSAmJiAhdGhpcy52aWV3LnNwYXRpYWxSZWZlcmVuY2UuZXF1YWxzKHZhbHVlKSkge1xuICAgICAgICAgICAgdGhpcy52aWV3LnNwYXRpYWxSZWZlcmVuY2UgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB0aGVtZVdhdGNoZXIodmFsdWUpIHtcbiAgICAgICAgaWYgKHRoaXMudmlldykge1xuICAgICAgICAgICAgdGhpcy52aWV3LnRoZW1lID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdGltZUV4dGVudFdhdGNoZXIodmFsdWUpIHtcbiAgICAgICAgaWYgKHRoaXMudmlldykge1xuICAgICAgICAgICAgdGhpcy52aWV3LnRpbWVFeHRlbnQgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB0aW1lWm9uZVdhdGNoZXIodmFsdWUpIHtcbiAgICAgICAgaWYgKHRoaXMudmlldykge1xuICAgICAgICAgICAgdGhpcy52aWV3LnRpbWVab25lID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdmlld3BvaW50V2F0Y2hlcih2YWx1ZSkge1xuICAgICAgICBpZiAodGhpcy52aWV3ICYmIGlzTm90U2FtZVZpZXdwb2ludCh0aGlzLnZpZXcudmlld3BvaW50LCB2YWx1ZSkpIHtcbiAgICAgICAgICAgIHRoaXMudmlldy52aWV3cG9pbnQgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB6b29tV2F0Y2hlcih2YWx1ZSwgb2xkKSB7XG4gICAgICAgIGlmICghdGhpcy52aWV3Py5pbnRlcmFjdGluZyAmJiB2YWx1ZSAhPSBudWxsICYmIHZhbHVlICE9PSBvbGQpIHtcbiAgICAgICAgICAgIHRoaXMudmlldy56b29tID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vXG4gICAgLy8gIE1ldGhvZHNcbiAgICAvL1xuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvKipcbiAgICAgKiBDbG9zZXMgdGhlIHBvcHVwLlxuICAgICAqL1xuICAgIGFzeW5jIGNsb3NlUG9wdXAoKSB7XG4gICAgICAgIHRoaXMudmlldz8uY2xvc2VQb3B1cCgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBEZXN0cm95cyB0aGUgdmlldywgYW5kIGFueSBhc3NvY2lhdGVkIHJlc291cmNlcywgaW5jbHVkaW5nIGl0cyBtYXAsIHBvcHVwLCBhbmQgVUkgZWxlbWVudHMuXG4gICAgICovXG4gICAgYXN5bmMgZGVzdHJveSgpIHtcbiAgICAgICAgaWYgKHRoaXMuZGVzdHJveURpc2FibGVkKSB7XG4gICAgICAgICAgICB0aGlzLl9jbGVhcldhdGNoSGFuZGxlcygpO1xuICAgICAgICAgICAgdGhpcy52aWV3LmRlc3Ryb3koKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZXRzIHRoZSB2aWV3IHRvIGEgZ2l2ZW4gdGFyZ2V0LlxuICAgICAqL1xuICAgIGFzeW5jIGdvVG8odGFyZ2V0LCBvcHRpb25zKSB7XG4gICAgICAgIHJldHVybiAoYXdhaXQgdGhpcy52aWV3Py5nb1RvKHRhcmdldCwgb3B0aW9ucykpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGhpdCB0ZXN0IHJlc3VsdHMgZnJvbSBlYWNoIGxheWVyIHRoYXQgaW50ZXJzZWN0cyB0aGUgc3BlY2lmaWVkIHNjcmVlbiBjb29yZGluYXRlcy5cbiAgICAgKi9cbiAgICBhc3luYyBoaXRUZXN0KHNjcmVlblBvaW50LCBvcHRpb25zKSB7XG4gICAgICAgIHJldHVybiBhd2FpdCB0aGlzLnZpZXc/LmhpdFRlc3Qoc2NyZWVuUG9pbnQsIG9wdGlvbnMpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBPcGVucyB0aGUgcG9wdXAgYXQgdGhlIGdpdmVuIGxvY2F0aW9uIHdpdGggY29udGVudCBkZWZpbmVkIGVpdGhlciBleHBsaWNpdGx5IHdpdGggY29udGVudCBvciBkcml2ZW5cbiAgICAgKiBmcm9tIHRoZSBQb3B1cFRlbXBsYXRlIG9mIGlucHV0IGZlYXR1cmVzLlxuICAgICAqL1xuICAgIGFzeW5jIG9wZW5Qb3B1cChvcHRpb25zKSB7XG4gICAgICAgIHJldHVybiB2b2lkIHRoaXMudmlldz8ub3BlblBvcHVwKG9wdGlvbnMpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGUgYSBzY3JlZW5zaG90IG9mIHRoZSBjdXJyZW50IHZpZXcuXG4gICAgICovXG4gICAgYXN5bmMgdGFrZVNjcmVlbnNob3Qob3B0aW9ucykge1xuICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy52aWV3Py50YWtlU2NyZWVuc2hvdChvcHRpb25zKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2FsbCB0aGlzIG1ldGhvZCB0byBjbGVhciBhbnkgZmF0YWwgZXJyb3JzIHJlc3VsdGluZyBmcm9tIGEgbG9zdCBXZWJHTCBjb250ZXh0LlxuICAgICAqL1xuICAgIGFzeW5jIHRyeUZhdGFsRXJyb3JSZWNvdmVyeSgpIHtcbiAgICAgICAgdGhpcy52aWV3Py50cnlGYXRhbEVycm9yUmVjb3ZlcnkoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgTGF5ZXJWaWV3IGNyZWF0ZWQgb24gdGhlIHZpZXcgZm9yIHRoZSBnaXZlbiBsYXllci5cbiAgICAgKi9cbiAgICBhc3luYyB3aGVuTGF5ZXJWaWV3KGxheWVyKSB7XG4gICAgICAgIHJldHVybiBhd2FpdCB0aGlzLnZpZXc/LndoZW5MYXllclZpZXcobGF5ZXIpO1xuICAgIH1cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy9cbiAgICAvLyAgTGlmZWN5Y2xlXG4gICAgLy9cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgYXN5bmMgY29tcG9uZW50V2lsbExvYWQoKSB7XG4gICAgICAgIGlmICghdGhpcy52aWV3KSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLl9sb2FkTWFwKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY29tcG9uZW50RGlkUmVuZGVyKCkge1xuICAgICAgICBpZiAodGhpcy52aWV3ICYmICF0aGlzLnZpZXcuY29udGFpbmVyKSB7XG4gICAgICAgICAgICB0aGlzLnZpZXcuY29udGFpbmVyID0gdGhpcy5lbDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjb21wb25lbnREaWRMb2FkKCkge1xuICAgICAgICB0aGlzLl9wcm94eUV2ZW50cygpO1xuICAgIH1cbiAgICBkaXNjb25uZWN0ZWRDYWxsYmFjaygpIHtcbiAgICAgICAgdm9pZCB0aGlzLmRlc3Ryb3koKTtcbiAgICB9XG4gICAgcmVuZGVyKCkge1xuICAgICAgICByZXR1cm4gaChcImRpdlwiLCB7IGNsYXNzOiBcImFyY2dpcy1tYXBcIiwgcmVmOiAoZWwpID0+ICh0aGlzLmVsID0gZWwpIH0pO1xuICAgIH1cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy9cbiAgICAvLyAgUHJpdmF0ZSBNZXRob2RzXG4gICAgLy9cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgX2NsZWFyV2F0Y2hIYW5kbGVzKCkge1xuICAgICAgICB0aGlzLl93YXRjaEhhbmRsZXMuZm9yRWFjaCgoaGFuZGxlKSA9PiBoYW5kbGUucmVtb3ZlKCkpO1xuICAgICAgICB0aGlzLl93YXRjaEhhbmRsZXMgPSBbXTtcbiAgICB9XG4gICAgYXN5bmMgX2FkZFdhdGNoZXJzKCkge1xuICAgICAgICBjb25zdCB7IHdhdGNoLCB3aGVuIH0gPSBhd2FpdCBpbXBvcnRDb3JlUmVhY3RpdmVVdGlscygpO1xuICAgICAgICBhZGRIYW5kbGVzKHRoaXMsIFtcbiAgICAgICAgICAgIC8vIHdhdGNoIGZvciBzdGF0aW9uYXJ5IGFuZCBlbWl0IGFyY2dpc1ZpZXdDaGFuZ2UgZXZlbnRcbiAgICAgICAgICAgIHdhdGNoKCgpID0+IHRoaXMudmlldy5zdGF0aW9uYXJ5LCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5zdGF0aW9uYXJ5ID0gdGhpcy52aWV3LnN0YXRpb25hcnk7XG4gICAgICAgICAgICAgICAgdGhpcy5pbnRlcmFjdGluZyA9IHRoaXMudmlldy5pbnRlcmFjdGluZztcbiAgICAgICAgICAgICAgICB0aGlzLm5hdmlnYXRpbmcgPSB0aGlzLnZpZXcubmF2aWdhdGluZztcbiAgICAgICAgICAgICAgICB0aGlzLmFyY2dpc1ZpZXdDaGFuZ2UuZW1pdCgpO1xuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgIGluaXRpYWw6IHRydWUsXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIC8vIHdoZW4gdmlldyBzdGF0aW9uYXJ5IGlzIHRydWUsIHVwZGF0ZSB0aGVzZSBwcm9wczpcbiAgICAgICAgICAgIC8vIHpvb20sIHNjYWxlLCBjZW50ZXIsIHJvdGF0aW9uLCBleHRlbnQsIGNhbWVyYSwgdmlld3BvaW50XG4gICAgICAgICAgICB3aGVuKCgpID0+IHRoaXMudmlldy5zdGF0aW9uYXJ5LCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5jZW50ZXIgPSB0aGlzLnZpZXcuY2VudGVyO1xuICAgICAgICAgICAgICAgIHRoaXMuZXh0ZW50ID0gdGhpcy52aWV3LmV4dGVudDtcbiAgICAgICAgICAgICAgICB0aGlzLnNjYWxlID0gdGhpcy52aWV3LnNjYWxlO1xuICAgICAgICAgICAgICAgIHRoaXMudmlld3BvaW50ID0gdGhpcy52aWV3LnZpZXdwb2ludDtcbiAgICAgICAgICAgICAgICB0aGlzLnpvb20gPSB0aGlzLnZpZXcuem9vbTtcbiAgICAgICAgICAgICAgICB0aGlzLnNwYXRpYWxSZWZlcmVuY2UgPSB0aGlzLnZpZXcuc3BhdGlhbFJlZmVyZW5jZTtcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgLy8gd2F0Y2hlcnMgZm9yIG90aGVyIHByb3BzIHRvIHVwZGF0ZSBjb21wb25lbnRcbiAgICAgICAgICAgIHdhdGNoKCgpID0+IHRoaXMudmlldy5hbGxMYXllclZpZXdzLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5hbGxMYXllclZpZXdzID0gdGhpcy52aWV3LmFsbExheWVyVmlld3M7XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgaW5pdGlhbDogdHJ1ZSxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgd2F0Y2goKCkgPT4gdGhpcy52aWV3Lm1hcD8uYmFzZW1hcCwgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuYmFzZW1hcCA9IHRoaXMudmlldy5tYXA/LmJhc2VtYXA7XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgaW5pdGlhbDogdHJ1ZSxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgd2F0Y2goKCkgPT4gdGhpcy52aWV3LmZhdGFsRXJyb3IsICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmZhdGFsRXJyb3IgPSB0aGlzLnZpZXcuZmF0YWxFcnJvcjtcbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICBpbml0aWFsOiB0cnVlLFxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICB3YXRjaCgoKSA9PiB0aGlzLnZpZXcuaW5wdXQuZ2FtZXBhZCwgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuZ2FtZXBhZCA9IHRoaXMudmlldy5pbnB1dC5nYW1lcGFkO1xuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgIGluaXRpYWw6IHRydWUsXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIHdhdGNoKCgpID0+IHRoaXMudmlldy5ncmFwaGljcywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuZ3JhcGhpY3MgPSB0aGlzLnZpZXcuZ3JhcGhpY3M7XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgaW5pdGlhbDogdHJ1ZSxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgd2F0Y2goKCkgPT4gdGhpcy52aWV3LmxheWVyVmlld3MsICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmxheWVyVmlld3MgPSB0aGlzLnZpZXcubGF5ZXJWaWV3cztcbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICBpbml0aWFsOiB0cnVlLFxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICB3YXRjaCgoKSA9PiB0aGlzLnZpZXcubmF2aWdhdGlvbiwgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMubmF2aWdhdGlvbiA9IHRoaXMudmlldy5uYXZpZ2F0aW9uO1xuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgIGluaXRpYWw6IHRydWUsXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIHdhdGNoKCgpID0+IHRoaXMudmlldy5tYXAsICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLm1hcCA9IHRoaXMudmlldy5tYXA7XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgaW5pdGlhbDogdHJ1ZSxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgd2F0Y2goKCkgPT4gdGhpcy52aWV3LnBvcHVwLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5wb3B1cCA9IHRoaXMudmlldy5wb3B1cDtcbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICBpbml0aWFsOiB0cnVlLFxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICB3YXRjaCgoKSA9PiB0aGlzLnZpZXcucmVzb2x1dGlvbiwgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMucmVzb2x1dGlvbiA9IHRoaXMudmlldy5yZXNvbHV0aW9uO1xuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgIGluaXRpYWw6IHRydWUsXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIHdhdGNoKCgpID0+IHRoaXMudmlldy5yb3RhdGlvbiwgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMucm90YXRpb24gPSB0aGlzLnZpZXcucm90YXRpb247XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgaW5pdGlhbDogdHJ1ZSxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgd2F0Y2goKCkgPT4gdGhpcy52aWV3LnN1c3BlbmRlZCwgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuc3VzcGVuZGVkID0gdGhpcy52aWV3LnN1c3BlbmRlZDtcbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICBpbml0aWFsOiB0cnVlLFxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICB3YXRjaCgoKSA9PiB0aGlzLnZpZXcudXBkYXRpbmcsICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0aW5nID0gdGhpcy52aWV3LnVwZGF0aW5nO1xuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgIGluaXRpYWw6IHRydWUsXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIC8vIHdhdGNoIGZvciByZWFkeSBhbmQgZW1pdCBhcmNnaXNWaWV3UmVhZHlDaGFuZ2UgZXZlbnRcbiAgICAgICAgICAgIHdhdGNoKCgpID0+IHRoaXMudmlldy5yZWFkeSwgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMucmVhZHkgPSB0aGlzLnZpZXcucmVhZHk7XG4gICAgICAgICAgICAgICAgdGhpcy5hcmNnaXNWaWV3UmVhZHlDaGFuZ2UuZW1pdCgpO1xuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgIGluaXRpYWw6IHRydWUsXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgXSk7XG4gICAgfVxuICAgIGFzeW5jIF9jcmVhdGVNYXAoKSB7XG4gICAgICAgIGNvbnN0IG1hcFBhcmFtcyA9IHt9O1xuICAgICAgICBpZiAodGhpcy5pdGVtSWQpIHtcbiAgICAgICAgICAgIG1hcFBhcmFtcy5wb3J0YWxJdGVtID0gYXdhaXQgdGhpcy5fY3JlYXRlUG9ydGFsSXRlbSgpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmJhc2VtYXApIHtcbiAgICAgICAgICAgIG1hcFBhcmFtcy5iYXNlbWFwID0gdGhpcy5iYXNlbWFwO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGlzTnVsbE9yRW1wdHlTdHJpbmcodGhpcy5pdGVtSWQpKSB7XG4gICAgICAgICAgICBtYXBQYXJhbXMuYmFzZW1hcCA9IFwidG9wby12ZWN0b3JcIjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBtYXAgPSBhd2FpdCBuZXdXZWJNYXAobWFwUGFyYW1zKTtcbiAgICAgICAgcmV0dXJuIG1hcDtcbiAgICB9XG4gICAgYXN5bmMgX2NyZWF0ZVBvcnRhbEl0ZW0oKSB7XG4gICAgICAgIGNvbnN0IGl0ZW1Qcm9wcyA9IHt9O1xuICAgICAgICBpZiAodGhpcy5pdGVtSWQpIHtcbiAgICAgICAgICAgIGl0ZW1Qcm9wcy5pZCA9IHRoaXMuaXRlbUlkO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBpdGVtUHJvcHM7XG4gICAgfVxuICAgIF9jcmVhdGVWaWV3UGFyYW1zKCkge1xuICAgICAgICBjb25zdCBwYXJhbXMgPSB7fTtcbiAgICAgICAgaWYgKHRoaXMuYmFja2dyb3VuZCkge1xuICAgICAgICAgICAgcGFyYW1zLmJhY2tncm91bmQgPSB0aGlzLmJhY2tncm91bmQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuY2VudGVyKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHRoaXMuY2VudGVyID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICAgICAgcGFyYW1zLmNlbnRlciA9IHRoaXMuY2VudGVyLnNwbGl0KFwiLFwiKS5tYXAoKHgpID0+IE51bWJlcih4KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBwYXJhbXMuY2VudGVyID0gdGhpcy5jZW50ZXI7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuY29uc3RyYWludHMpIHtcbiAgICAgICAgICAgIHBhcmFtcy5jb25zdHJhaW50cyA9IHRoaXMuY29uc3RyYWludHM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuZXh0ZW50KSB7XG4gICAgICAgICAgICBwYXJhbXMuZXh0ZW50ID0gdGhpcy5leHRlbnQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuZmxvb3JzKSB7XG4gICAgICAgICAgICBwYXJhbXMuZmxvb3JzID0gdGhpcy5mbG9vcnM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuZ3JhcGhpY3MpIHtcbiAgICAgICAgICAgIHBhcmFtcy5ncmFwaGljcyA9IHRoaXMuZ3JhcGhpY3M7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuaGlnaGxpZ2h0T3B0aW9ucykge1xuICAgICAgICAgICAgcGFyYW1zLmhpZ2hsaWdodE9wdGlvbnMgPSB0aGlzLmhpZ2hsaWdodE9wdGlvbnM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubWFwKSB7XG4gICAgICAgICAgICBwYXJhbXMubWFwID0gdGhpcy5tYXA7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubmF2aWdhdGlvbikge1xuICAgICAgICAgICAgcGFyYW1zLm5hdmlnYXRpb24gPSB0aGlzLm5hdmlnYXRpb247XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucGFkZGluZykge1xuICAgICAgICAgICAgcGFyYW1zLnBhZGRpbmcgPSB0aGlzLnBhZGRpbmc7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucG9wdXApIHtcbiAgICAgICAgICAgIHBhcmFtcy5wb3B1cCA9IHRoaXMucG9wdXA7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucG9wdXBFbmFibGVkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHBhcmFtcy5wb3B1cEVuYWJsZWQgPSB0aGlzLnBvcHVwRW5hYmxlZDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5yb3RhdGlvbiAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBwYXJhbXMucm90YXRpb24gPSB0aGlzLnJvdGF0aW9uO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnNjYWxlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHBhcmFtcy5zY2FsZSA9IHRoaXMuc2NhbGU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuc3BhdGlhbFJlZmVyZW5jZSkge1xuICAgICAgICAgICAgcGFyYW1zLnNwYXRpYWxSZWZlcmVuY2UgPSB0aGlzLnNwYXRpYWxSZWZlcmVuY2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMudGhlbWUpIHtcbiAgICAgICAgICAgIHBhcmFtcy50aGVtZSA9IHRoaXMudGhlbWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMudGltZUV4dGVudCkge1xuICAgICAgICAgICAgcGFyYW1zLnRpbWVFeHRlbnQgPSB0aGlzLnRpbWVFeHRlbnQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMudGltZVpvbmUpIHtcbiAgICAgICAgICAgIHBhcmFtcy50aW1lWm9uZSA9IHRoaXMudGltZVpvbmU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMudmlld3BvaW50KSB7XG4gICAgICAgICAgICBwYXJhbXMudmlld3BvaW50ID0gdGhpcy52aWV3cG9pbnQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuem9vbSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBwYXJhbXMuem9vbSA9IHRoaXMuem9vbTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcGFyYW1zO1xuICAgIH1cbiAgICBhc3luYyBfbG9hZE1hcCgpIHtcbiAgICAgICAgdGhpcy5tYXAgfHwgKHRoaXMubWFwID0gYXdhaXQgdGhpcy5fY3JlYXRlTWFwKCkpO1xuICAgICAgICBjb25zdCBwYXJhbXMgPSB0aGlzLl9jcmVhdGVWaWV3UGFyYW1zKCk7XG4gICAgICAgIGNvbnN0IHZpZXcgPSBhd2FpdCBuZXdWaWV3c01hcFZpZXcoe1xuICAgICAgICAgICAgLi4ucGFyYW1zLFxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy52aWV3ID0gdmlldztcbiAgICAgICAgcmV0dXJuIHZvaWQgdmlldy53aGVuKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIC8vIHByb3h5IHZpZXcgZnVuY3Rpb25zXG4gICAgICAgICAgICB0aGlzLnRvTWFwID0gdmlldy50b01hcC5iaW5kKHZpZXcpO1xuICAgICAgICAgICAgdGhpcy50b1NjcmVlbiA9IHZpZXcudG9TY3JlZW4uYmluZCh2aWV3KTtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuX2FkZFdhdGNoZXJzKCk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBfcHJveHlFdmVudHMoKSB7XG4gICAgICAgIGFkZEhhbmRsZXModGhpcywgW1xuICAgICAgICAgICAgdGhpcy52aWV3Lm9uKFwiY2xpY2tcIiwgKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5hcmNnaXNWaWV3Q2xpY2suZW1pdChldmVudCk7XG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIHRoaXMudmlldy5vbihcImRvdWJsZS1jbGlja1wiLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmFyY2dpc1ZpZXdEb3VibGVDbGljay5lbWl0KGV2ZW50KTtcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgdGhpcy52aWV3Lm9uKFwiZHJhZ1wiLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmFyY2dpc1ZpZXdEcmFnLmVtaXQoZXZlbnQpO1xuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICB0aGlzLnZpZXcub24oXCJob2xkXCIsIChldmVudCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuYXJjZ2lzVmlld0hvbGQuZW1pdChldmVudCk7XG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIHRoaXMudmlldy5vbihcImltbWVkaWF0ZS1jbGlja1wiLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmFyY2dpc1ZpZXdJbW1lZGlhdGVDbGljay5lbWl0KGV2ZW50KTtcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgdGhpcy52aWV3Lm9uKFwiaW1tZWRpYXRlLWRvdWJsZS1jbGlja1wiLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmFyY2dpc1ZpZXdJbW1lZGlhdGVEb3VibGVDbGljay5lbWl0KGV2ZW50KTtcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgdGhpcy52aWV3Lm9uKFwia2V5LWRvd25cIiwgKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5hcmNnaXNWaWV3S2V5RG93bi5lbWl0KGV2ZW50KTtcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgdGhpcy52aWV3Lm9uKFwia2V5LXVwXCIsIChldmVudCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuYXJjZ2lzVmlld0tleVVwLmVtaXQoZXZlbnQpO1xuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICB0aGlzLnZpZXcub24oXCJsYXllcnZpZXctY3JlYXRlXCIsIChldmVudCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuYXJjZ2lzVmlld0xheWVydmlld0NyZWF0ZS5lbWl0KGV2ZW50KTtcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgdGhpcy52aWV3Lm9uKFwibGF5ZXJ2aWV3LWNyZWF0ZS1lcnJvclwiLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmFyY2dpc1ZpZXdMYXllcnZpZXdDcmVhdGVFcnJvci5lbWl0KGV2ZW50KTtcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgdGhpcy52aWV3Lm9uKFwibGF5ZXJ2aWV3LWRlc3Ryb3lcIiwgKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5hcmNnaXNWaWV3TGF5ZXJ2aWV3RGVzdHJveS5lbWl0KGV2ZW50KTtcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgdGhpcy52aWV3Lm9uKFwibW91c2Utd2hlZWxcIiwgKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5hcmNnaXNWaWV3TW91c2VXaGVlbC5lbWl0KGV2ZW50KTtcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgdGhpcy52aWV3Lm9uKFwicG9pbnRlci1kb3duXCIsIChldmVudCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuYXJjZ2lzVmlld1BvaW50ZXJEb3duLmVtaXQoZXZlbnQpO1xuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICB0aGlzLnZpZXcub24oXCJwb2ludGVyLWVudGVyXCIsIChldmVudCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuYXJjZ2lzVmlld1BvaW50ZXJFbnRlci5lbWl0KGV2ZW50KTtcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgdGhpcy52aWV3Lm9uKFwicG9pbnRlci1sZWF2ZVwiLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmFyY2dpc1ZpZXdQb2ludGVyTGVhdmUuZW1pdChldmVudCk7XG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIHRoaXMudmlldy5vbihcInBvaW50ZXItbW92ZVwiLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmFyY2dpc1ZpZXdQb2ludGVyTW92ZS5lbWl0KGV2ZW50KTtcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgdGhpcy52aWV3Lm9uKFwicG9pbnRlci11cFwiLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmFyY2dpc1ZpZXdQb2ludGVyVXAuZW1pdChldmVudCk7XG4gICAgICAgICAgICB9KSxcbiAgICAgICAgXSk7XG4gICAgfVxuICAgIGFzeW5jIF91cGRhdGVNYXAoKSB7XG4gICAgICAgIGlmICh0aGlzLnZpZXc/Lm1hcCkge1xuICAgICAgICAgICAgdGhpcy52aWV3Lm1hcC5kZXN0cm95KCk7XG4gICAgICAgICAgICBjb25zdCBtYXAgPSBhd2FpdCB0aGlzLl9jcmVhdGVNYXAoKTtcbiAgICAgICAgICAgIHRoaXMudmlldy5tYXAgPSBtYXA7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0IF9ob3N0RWxlbWVudCgpIHsgcmV0dXJuIGdldEVsZW1lbnQodGhpcyk7IH1cbiAgICBzdGF0aWMgZ2V0IHdhdGNoZXJzKCkgeyByZXR1cm4ge1xuICAgICAgICBcImJhY2tncm91bmRcIjogW1wiYmFja2dyb3VuZFdhdGNoZXJcIl0sXG4gICAgICAgIFwiYmFzZW1hcFwiOiBbXCJiYXNlbWFwV2F0Y2hlclwiXSxcbiAgICAgICAgXCJjZW50ZXJcIjogW1wiY2VudGVyV2F0Y2hlclwiXSxcbiAgICAgICAgXCJjb25zdHJhaW50c1wiOiBbXCJjb25zdHJhaW50c1dhdGNoZXJcIl0sXG4gICAgICAgIFwiZXh0ZW50XCI6IFtcImV4dGVudFdhdGNoZXJcIl0sXG4gICAgICAgIFwiZmxvb3JzXCI6IFtcImZsb29yc1dhdGNoZXJcIl0sXG4gICAgICAgIFwiZ3JhcGhpY3NcIjogW1wiZ3JhcGhpY3NXYXRjaGVyXCJdLFxuICAgICAgICBcImhpZ2hsaWdodE9wdGlvbnNcIjogW1wiaGlnaGxpZ2h0T3B0aW9uc1dhdGNoZXJcIl0sXG4gICAgICAgIFwiaXRlbUlkXCI6IFtcIml0ZW1JZFdhdGNoZXJcIl0sXG4gICAgICAgIFwibWFwXCI6IFtcIm1hcFdhdGNoZXJcIl0sXG4gICAgICAgIFwibmF2aWdhdGlvblwiOiBbXCJuYXZpZ2F0aW9uV2F0Y2hlclwiXSxcbiAgICAgICAgXCJwYWRkaW5nXCI6IFtcInBhZGRpbmdXYXRjaGVyXCJdLFxuICAgICAgICBcInBvcHVwXCI6IFtcInBvcHVwV2F0Y2hlclwiXSxcbiAgICAgICAgXCJwb3B1cEVuYWJsZWRcIjogW1wicG9wdXBFbmFibGVkV2F0Y2hlclwiXSxcbiAgICAgICAgXCJyZXNpemVBbGlnblwiOiBbXCJyZXNpemVBbGlnbldhdGNoZXJcIl0sXG4gICAgICAgIFwicm90YXRpb25cIjogW1wicm90YXRpb25XYXRjaGVyXCJdLFxuICAgICAgICBcInNjYWxlXCI6IFtcInNjYWxlV2F0Y2hlclwiXSxcbiAgICAgICAgXCJzcGF0aWFsUmVmZXJlbmNlXCI6IFtcInNwYXRpYWxSZWZlcmVuY2VXYXRjaGVyXCJdLFxuICAgICAgICBcInRoZW1lXCI6IFtcInRoZW1lV2F0Y2hlclwiXSxcbiAgICAgICAgXCJ0aW1lRXh0ZW50XCI6IFtcInRpbWVFeHRlbnRXYXRjaGVyXCJdLFxuICAgICAgICBcInRpbWVab25lXCI6IFtcInRpbWVab25lV2F0Y2hlclwiXSxcbiAgICAgICAgXCJ2aWV3cG9pbnRcIjogW1widmlld3BvaW50V2F0Y2hlclwiXSxcbiAgICAgICAgXCJ6b29tXCI6IFtcInpvb21XYXRjaGVyXCJdXG4gICAgfTsgfVxufTtcbkFyY2dpc01hcC5zdHlsZSA9IG1hcENzcztcblxuZXhwb3J0IHsgQXJjZ2lzQmFzZW1hcEdhbGxlcnkgYXMgYXJjZ2lzX2Jhc2VtYXBfZ2FsbGVyeSwgQXJjZ2lzTWFwIGFzIGFyY2dpc19tYXAgfTtcbiIsIi8qIVxuICogQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFc3JpLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAqIFNlZSBodHRwczovL2pzLmFyY2dpcy5jb20vNC4zMC9lc3JpL2NvcHlyaWdodC50eHQgZm9yIGRldGFpbHMuXG4gKiB2NC4zMC4wLW5leHQuMzdcbiAqL1xuZnVuY3Rpb24gY2hlY2tGb3JFeHBhbmQoZWxlbWVudCkge1xuICAgIGNvbnN0IGV4cGFuZFJlZiA9IGVsZW1lbnQuZWwuY2xvc2VzdChcImFyY2dpcy1leHBhbmRcIikgPz8gZWxlbWVudC5leHBhbmRFbGVtO1xuICAgIGlmIChleHBhbmRSZWY/LndpZGdldCkge1xuICAgICAgICBlbGVtZW50LnZpZXcgPSBleHBhbmRSZWYudmlldztcbiAgICAgICAgZXhwYW5kUmVmLndpZGdldC5jb250ZW50ID0gZWxlbWVudC5jaGlsZEVsZW0gPz8gZWxlbWVudC5lbDtcbiAgICAgICAgLy8gVE9ETzogVXBkYXRlIHRvIGJlIGV4cGFuZEljb24gPSB3aWRnZXQuaWNvbiwgbm90IHJlYWR5IHlldCBpbiA0LjI3bmV4dFxuICAgICAgICBpZiAoIWV4cGFuZFJlZi5leHBhbmRJY29uKSB7XG4gICAgICAgICAgICBleHBhbmRSZWYud2lkZ2V0LmV4cGFuZEljb24gPSBlbGVtZW50LndpZGdldCA/IGVsZW1lbnQud2lkZ2V0Lmljb24gOiBlbGVtZW50Py5pY29uO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICBpZiAoZXhwYW5kUmVmKSB7XG4gICAgICAgIGNvbnN0IHdpZGdldEhhbmRsZXIgPSAoKSA9PiB7XG4gICAgICAgICAgICBleHBhbmRSZWYucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImFyY2dpc0V4cGFuZFJlYWR5XCIsIHdpZGdldEhhbmRsZXIsIGZhbHNlKTtcbiAgICAgICAgICAgIGVsZW1lbnQudmlldyA9IGV4cGFuZFJlZi52aWV3O1xuICAgICAgICAgICAgZXhwYW5kUmVmLndpZGdldC5jb250ZW50ID0gZWxlbWVudC5jaGlsZEVsZW0gPz8gZWxlbWVudC5lbDtcbiAgICAgICAgICAgIGlmICghZXhwYW5kUmVmLmV4cGFuZEljb24pIHtcbiAgICAgICAgICAgICAgICBleHBhbmRSZWYud2lkZ2V0LmV4cGFuZEljb24gPSBlbGVtZW50LndpZGdldCA/IGVsZW1lbnQud2lkZ2V0Lmljb24gOiBlbGVtZW50Py5pY29uO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBleHBhbmRSZWYuYWRkRXZlbnRMaXN0ZW5lcihcImFyY2dpc0V4cGFuZFJlYWR5XCIsIHdpZGdldEhhbmRsZXIsIGZhbHNlKTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbn1cblxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy9cbi8vICBQdWJsaWMgTWV0aG9kc1xuLy9cbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbmZ1bmN0aW9uIGFkZEhhbmRsZXMoZWxlbWVudCwgaGFuZGxlKSB7XG4gICAgaWYgKEFycmF5LmlzQXJyYXkoaGFuZGxlKSkge1xuICAgICAgICBlbGVtZW50Ll93YXRjaEhhbmRsZXMgPSBbLi4uZWxlbWVudC5fd2F0Y2hIYW5kbGVzLCAuLi5oYW5kbGVdO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgZWxlbWVudC5fd2F0Y2hIYW5kbGVzLnB1c2goaGFuZGxlKTtcbiAgICB9XG59XG5mdW5jdGlvbiBjaGVja0ZvclZpZXcoZWxlbWVudCkge1xuICAgIGxldCBpc1VzaW5nUmVmZXJlbmNlRWxlbWVudCA9IGZhbHNlO1xuICAgIGlmICghY2hlY2tGb3JFeHBhbmQoZWxlbWVudCkpIHtcbiAgICAgICAgbGV0IHZpZXdSZWYgPSBlbGVtZW50LmVsLmNsb3Nlc3QoXCJhcmNnaXMtbWFwXCIpID8/IGVsZW1lbnQuZWwuY2xvc2VzdChcImFyY2dpcy1zY2VuZVwiKTtcbiAgICAgICAgaWYgKCF2aWV3UmVmICYmIHR5cGVvZiBlbGVtZW50LnJlZmVyZW5jZUVsZW1lbnQgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgIHZpZXdSZWYgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGVsZW1lbnQucmVmZXJlbmNlRWxlbWVudCk7XG4gICAgICAgICAgICBpc1VzaW5nUmVmZXJlbmNlRWxlbWVudCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHZpZXdSZWY/LnZpZXcpIHtcbiAgICAgICAgICAgIGVsZW1lbnQudmlldyA9IHZpZXdSZWYudmlldztcbiAgICAgICAgICAgIGNvbnN0IGVsID0gZWxlbWVudC5jaGlsZEVsZW0gPz8gZWxlbWVudC5lbDtcbiAgICAgICAgICAgIGlmICghaXNVc2luZ1JlZmVyZW5jZUVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICBlbGVtZW50LnZpZXcudWkuYWRkKGVsLCBlbGVtZW50LnBvc2l0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh2aWV3UmVmKSB7XG4gICAgICAgICAgICB3YWl0Rm9yVmlld0hhbmRsZXIodmlld1JlZiwgZWxlbWVudCwgaXNVc2luZ1JlZmVyZW5jZUVsZW1lbnQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBjb25zdCB2aWV3UmVmID0gZWxlbWVudC5lbC5jbG9zZXN0KFwiYXJjZ2lzLW1hcFwiKSA/PyBlbGVtZW50LmVsLmNsb3Nlc3QoXCJhcmNnaXMtc2NlbmVcIik7XG4gICAgICAgIGlmICh2aWV3UmVmPy52aWV3KSB7XG4gICAgICAgICAgICBlbGVtZW50LnZpZXcgPSB2aWV3UmVmLnZpZXc7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodmlld1JlZikge1xuICAgICAgICAgICAgY29uc3QgaGFuZGxlciA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICB2aWV3UmVmLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJhcmNnaXNWaWV3UmVhZHlDaGFuZ2VcIiwgaGFuZGxlciwgZmFsc2UpO1xuICAgICAgICAgICAgICAgIGVsZW1lbnQudmlldyA9IHZpZXdSZWYudmlldztcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2aWV3UmVmLmFkZEV2ZW50TGlzdGVuZXIoXCJhcmNnaXNWaWV3UmVhZHlDaGFuZ2VcIiwgaGFuZGxlciwgZmFsc2UpO1xuICAgICAgICB9XG4gICAgfVxufVxuZnVuY3Rpb24gaXNOdWxsT3JFbXB0eVN0cmluZyh2YWx1ZSkge1xuICAgIHJldHVybiB2YWx1ZSA9PT0gdW5kZWZpbmVkIHx8IHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSBcIlwiO1xufVxuZnVuY3Rpb24gaXNWYWxpZEludGVnZXIodmFsdWUpIHtcbiAgICByZXR1cm4gdmFsdWUgIT0gbnVsbCAmJiB2YWx1ZSAlIDEgPT09IDA7XG59XG5mdW5jdGlvbiBpc05vdFNhbWVDYW1lcmEoY2FtZXJhLCBjYW1lcmEyKSB7XG4gICAgcmV0dXJuIChjYW1lcmEyID09PSB1bmRlZmluZWQgfHxcbiAgICAgICAgY2FtZXJhLnBvc2l0aW9uICE9PSBjYW1lcmEyLnBvc2l0aW9uIHx8XG4gICAgICAgIGNhbWVyYS5oZWFkaW5nICE9PSBjYW1lcmEyLmhlYWRpbmcgfHxcbiAgICAgICAgY2FtZXJhLnRpbHQgIT09IGNhbWVyYTIudGlsdCk7XG59XG5mdW5jdGlvbiBpc05vdFNhbWVFbnZpcm9ubWVudChlbnZpcm9ubWVudCwgZW52aXJvbm1lbnQyKSB7XG4gICAgcmV0dXJuIChlbnZpcm9ubWVudDIgPT09IHVuZGVmaW5lZCB8fFxuICAgICAgICBlbnZpcm9ubWVudDIuYXRtb3NwaGVyZUVuYWJsZWQgIT09IGVudmlyb25tZW50LmF0bW9zcGhlcmVFbmFibGVkIHx8XG4gICAgICAgIGVudmlyb25tZW50Mi5saWdodGluZy5kYXRlICE9PSBlbnZpcm9ubWVudC5saWdodGluZy5kYXRlIHx8XG4gICAgICAgIGVudmlyb25tZW50Mi5saWdodGluZy5kaXJlY3RTaGFkb3dzRW5hYmxlZCAhPT1cbiAgICAgICAgICAgIGVudmlyb25tZW50LmxpZ2h0aW5nLmRpcmVjdFNoYWRvd3NFbmFibGVkIHx8XG4gICAgICAgIGVudmlyb25tZW50Mi5saWdodGluZy5jYW1lcmFUcmFja2luZ0VuYWJsZWQgIT09XG4gICAgICAgICAgICBlbnZpcm9ubWVudC5saWdodGluZy5jYW1lcmFUcmFja2luZ0VuYWJsZWQgfHxcbiAgICAgICAgZW52aXJvbm1lbnQyLmxpZ2h0aW5nLmRhdGUgIT09IGVudmlyb25tZW50LmxpZ2h0aW5nLmRhdGUgfHxcbiAgICAgICAgZW52aXJvbm1lbnQyLmxpZ2h0aW5nLmRpc3BsYXlVVENPZmZzZXQgIT09XG4gICAgICAgICAgICBlbnZpcm9ubWVudC5saWdodGluZy5kaXNwbGF5VVRDT2Zmc2V0KTtcbn1cbmZ1bmN0aW9uIGlzTm90U2FtZVZpZXdwb2ludCh2aWV3cG9pbnQsIHZpZXdwb2ludDIpIHtcbiAgICByZXR1cm4gKHZpZXdwb2ludDIgPT09IHVuZGVmaW5lZCB8fFxuICAgICAgICB2aWV3cG9pbnQudGFyZ2V0R2VvbWV0cnkgIT09IHZpZXdwb2ludDIudGFyZ2V0R2VvbWV0cnkgfHxcbiAgICAgICAgdmlld3BvaW50LnJvdGF0aW9uICE9PSB2aWV3cG9pbnQyLnJvdGF0aW9uIHx8XG4gICAgICAgIHZpZXdwb2ludC5zY2FsZSAhPT0gdmlld3BvaW50Mi5zY2FsZSk7XG59XG5hc3luYyBmdW5jdGlvbiB1cGRhdGVGb3JWaWV3KHZpZXdTdHIpIHtcbiAgICBjb25zdCB2aWV3UmVmID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih2aWV3U3RyKTtcbiAgICByZXR1cm4gYXdhaXQgbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcbiAgICAgICAgaWYgKHZpZXdSZWY/LnZpZXcgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmVzb2x2ZSh2aWV3UmVmLnZpZXcpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHZpZXdSZWYpIHtcbiAgICAgICAgICAgIGNvbnN0IGhhbmRsZXIgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdmlld1JlZi5yZW1vdmVFdmVudExpc3RlbmVyKFwiYXJjZ2lzVmlld1JlYWR5Q2hhbmdlXCIsIGhhbmRsZXIsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICByZXNvbHZlKHZpZXdSZWYudmlldyk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdmlld1JlZi5hZGRFdmVudExpc3RlbmVyKFwiYXJjZ2lzVmlld1JlYWR5Q2hhbmdlXCIsIGhhbmRsZXIsIGZhbHNlKTtcbiAgICAgICAgfVxuICAgIH0pO1xufVxuYXN5bmMgZnVuY3Rpb24gcmVmZXJlbmNlRWxlbWVudEhlbHBlcihlbGVtZW50LCByZWZFbGVtZW50KSB7XG4gICAgaWYgKHJlZkVsZW1lbnQgPT09IHVuZGVmaW5lZClcbiAgICAgICAgcmV0dXJuO1xuICAgIGVsc2UgaWYgKHR5cGVvZiByZWZFbGVtZW50ID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgIGVsZW1lbnQudmlldyA9IGF3YWl0IHVwZGF0ZUZvclZpZXcocmVmRWxlbWVudCk7XG4gICAgfVxuICAgIGVsc2UgaWYgKGVsZW1lbnQud2lkZ2V0KSB7XG4gICAgICAgIGVsZW1lbnQudmlldyA9IHJlZkVsZW1lbnQudmlldztcbiAgICB9XG59XG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vL1xuLy8gIFByaXZhdGUgTWV0aG9kc1xuLy9cbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbmZ1bmN0aW9uIHdhaXRGb3JWaWV3SGFuZGxlcih2aWV3UmVmLCBlbGVtZW50LCBpc1VzaW5nUmVmZXJuY2VFbGVtZW50KSB7XG4gICAgY29uc3QgaGFuZGxlciA9ICgpID0+IHtcbiAgICAgICAgdmlld1JlZi5yZW1vdmVFdmVudExpc3RlbmVyKFwiYXJjZ2lzVmlld1JlYWR5Q2hhbmdlXCIsIGhhbmRsZXIsIGZhbHNlKTtcbiAgICAgICAgZWxlbWVudC52aWV3ID0gdmlld1JlZi52aWV3O1xuICAgICAgICBpZiAoIWlzVXNpbmdSZWZlcm5jZUVsZW1lbnQpIHtcbiAgICAgICAgICAgIGVsZW1lbnQudmlldy51aS5hZGQoZWxlbWVudC5jaGlsZEVsZW0gPz8gZWxlbWVudC5lbCwgZWxlbWVudC5wb3NpdGlvbik7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHZpZXdSZWYuYWRkRXZlbnRMaXN0ZW5lcihcImFyY2dpc1ZpZXdSZWFkeUNoYW5nZVwiLCBoYW5kbGVyLCBmYWxzZSk7XG59XG5cbmV4cG9ydCB7IGFkZEhhbmRsZXMgYXMgYSwgaXNOb3RTYW1lVmlld3BvaW50IGFzIGIsIGNoZWNrRm9yVmlldyBhcyBjLCBjaGVja0ZvckV4cGFuZCBhcyBkLCBpc05vdFNhbWVDYW1lcmEgYXMgZSwgaXNOb3RTYW1lRW52aXJvbm1lbnQgYXMgZiwgaXNWYWxpZEludGVnZXIgYXMgZywgaXNOdWxsT3JFbXB0eVN0cmluZyBhcyBpLCByZWZlcmVuY2VFbGVtZW50SGVscGVyIGFzIHIgfTtcbiIsIi8qIVxuICogQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFc3JpLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAqIFNlZSBodHRwczovL2pzLmFyY2dpcy5jb20vNC4zMC9lc3JpL2NvcHlyaWdodC50eHQgZm9yIGRldGFpbHMuXG4gKiB2NC4zMC4wLW5leHQuMzdcbiAqL1xuZnVuY3Rpb24gb25EaXNjb25uZWN0ZWRIZWxwZXIoZWxlbWVudCkge1xuICAgIGlmIChlbGVtZW50LmNoaWxkRWxlbSkge1xuICAgICAgICBpZiAoIWVsZW1lbnQuZWwuaXNDb25uZWN0ZWQpIHtcbiAgICAgICAgICAgIGlmIChlbGVtZW50LnZpZXcpIHtcbiAgICAgICAgICAgICAgICBlbGVtZW50LnZpZXcudWkucmVtb3ZlKGVsZW1lbnQuY2hpbGRFbGVtKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGVsZW1lbnQud2lkZ2V0Py52aWV3KSB7XG4gICAgICAgICAgICAgICAgZWxlbWVudC53aWRnZXQudmlldy51aS5yZW1vdmUoZWxlbWVudC5jaGlsZEVsZW0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGVsZW1lbnQuX3dhdGNoSGFuZGxlcykge1xuICAgICAgICAgICAgICAgIGVsZW1lbnQuX3dhdGNoSGFuZGxlcy5mb3JFYWNoKChoYW5kbGUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxlbWVudC5fd2F0Y2hIYW5kbGVzID0gW107XG4gICAgICAgICAgICBlbGVtZW50LndpZGdldD8uZGVzdHJveSgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIGlmICghZWxlbWVudC5lbC5pc0Nvbm5lY3RlZCkge1xuICAgICAgICAgICAgICAgIGlmIChlbGVtZW50LnZpZXcpIHtcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC52aWV3LnVpLnJlbW92ZShlbGVtZW50LmVsKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoZWxlbWVudC53aWRnZXQ/LnZpZXcpIHtcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC53aWRnZXQudmlldy51aS5yZW1vdmUoZWxlbWVudC5lbCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChlbGVtZW50Ll93YXRjaEhhbmRsZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5fd2F0Y2hIYW5kbGVzLmZvckVhY2goKGhhbmRsZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxlbWVudC5fd2F0Y2hIYW5kbGVzID0gW107XG4gICAgICAgICAgICAgICAgZWxlbWVudC53aWRnZXQ/LmRlc3Ryb3koKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwgMTAwMCk7XG4gICAgfVxufVxuXG5leHBvcnQgeyBvbkRpc2Nvbm5lY3RlZEhlbHBlciBhcyBvIH07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=