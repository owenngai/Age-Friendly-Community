"use strict";
(self["webpackChunkexb_client"] = self["webpackChunkexb_client"] || []).push([["vendors-node_modules_arcgis_map-components_dist_esm_arcgis-home_entry_js"],{

/***/ "./node_modules/@arcgis/map-components/dist/esm/arcgis-home.entry.js":
/*!***************************************************************************!*\
  !*** ./node_modules/@arcgis/map-components/dist/esm/arcgis-home.entry.js ***!
  \***************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   arcgis_home: () => (/* binding */ ArcgisHome)
/* harmony export */ });
/* harmony import */ var _index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-6e172aac.js */ "./node_modules/@arcgis/map-components/dist/esm/index-6e172aac.js");
/* harmony import */ var _index_7d72018f_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./index-7d72018f.js */ "./node_modules/@arcgis/map-components/dist/esm/index-7d72018f.js");
/* harmony import */ var _chunk_WQTCUXBS_9ec3781a_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./chunk-WQTCUXBS-9ec3781a.js */ "./node_modules/@arcgis/map-components/dist/esm/chunk-WQTCUXBS-9ec3781a.js");
/* harmony import */ var _index_0bc55ca5_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./index-0bc55ca5.js */ "./node_modules/@arcgis/map-components/dist/esm/index-0bc55ca5.js");
/* harmony import */ var _component_utils_23194f7c_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./component-utils-23194f7c.js */ "./node_modules/@arcgis/map-components/dist/esm/component-utils-23194f7c.js");
/*!
 * All material copyright Esri, All Rights Reserved, unless otherwise specified.
 * See https://js.arcgis.com/4.30/esri/copyright.txt for details.
 * v4.30.0-next.37
 */






const globalCss = {
    anchor: "esri-widget__anchor",
    anchorDisabled: "esri-widget__anchor--disabled",
    button: "esri-button",
    buttonDisabled: "esri-button--disabled",
    buttonHalf: "esri-button--half",
    buttonSecondary: "esri-button--secondary",
    buttonSmall: "esri-button--small",
    buttonTertiary: "esri-button--tertiary",
    buttonThird: "esri-button--third",
    disabled: "esri-disabled",
    disabledElement: "esri-disabled-element",
    empty: "esri-widget__content--empty",
    emptyIllustration: "esri-widget__content-illustration--empty",
    heading: "esri-widget__heading",
    hidden: "esri-hidden",
    input: "esri-input",
    interactive: "esri-interactive",
    loader: "esri-widget__loader",
    loaderAnimation: "esri-widget__loader-animation",
    loaderText: "esri-widget__loader-text",
    menu: "esri-menu",
    menuHeader: "esri-menu__header",
    menuItem: "esri-menu__list-item",
    menuItemActive: "esri-menu__list-item--active",
    menuItemFocus: "esri-menu__list-item--focus",
    menuList: "esri-menu__list",
    noBookmarksIcon: "esri-widget__no-bookmark-icon",
    panel: "esri-widget--panel",
    panelHeightOnly: "esri-widget--panel-height-only",
    primaryTick: "primary-tick",
    primaryTickAmPm: "primary-tick__ampm",
    primaryTickLabel: "primary-tick__label",
    rotating: "esri-rotating",
    secondaryTick: "secondary-tick",
    select: "esri-select",
    table: "esri-widget__table",
    ui: "esri-component",
    widget: "esri-widget",
    widgetButton: "esri-widget--button",
    widgetButtonActive: "esri-widget--button-active",
    widgetDisabled: "esri-widget--disabled",
};

// FIXME: auto-destroy viewModel?
/**
 * A controller for a mapping component that:
 * - loads the viewModel
 * - initializes the viewModel with the component's properties
 * - does two-way binding between view model and component properties
 * - re-emits the viewModel's events on the component
 * - type-checks everything âœ¨
 *
 * Documentation:
 * https://devtopia.esri.com/WebGIS/arcgis-web-components/blob/main/packages/map-components/src/controllers/useViewModel.md
 */
const makeViewModelController = (loadViewModel) => (component) => proxy(component, loadViewModel);
// REFACTOR: extract common logic into IntegrationController???
class ViewModelController extends _chunk_WQTCUXBS_9ec3781a_js__WEBPACK_IMPORTED_MODULE_2__.A {
    hostConnected() {
        if (this.component.manager.didLoadCalled)
            (0,_component_utils_23194f7c_js__WEBPACK_IMPORTED_MODULE_4__.c)(this.component);
    }
    async hostLoad() {
        await super.hostLoad();
        this._watchMetaProperties();
        this._reEmitViewModelEvents();
    }
    // This can't be in hostLoad as childElem is only accessible after first render
    hostLoaded() {
        const { el } = this.component;
        const childNode = el.shadowRoot?.firstChild ?? el.firstChild ?? undefined;
        /*
         * On hot reloading, new this.component instance is created (so properties
         * are reset) but this.component.el instance is preserved (so properties are
         * preserved). Since childElem is re-parented on 1st hostLoad(),
         * for it to be accessible on the 2nd hostLoad() (hot reload), we have to
         * store it's reference on the el, rather than component
         */
        el.childElem = childNode ?? el.childElem;
        this.component.childElem = el.childElem;
        if (el.childElem === undefined && "production" !== "production")
            {}
        // Define the "view" property if not already present for compatibility with JS API
        if (!("view" in this.component))
            Object.defineProperty(this.component, "view", {
                get: () => this._instance.view,
                set: (view) => {
                    this._instance.view = view;
                    this.component.requestUpdate();
                },
            });
        (0,_component_utils_23194f7c_js__WEBPACK_IMPORTED_MODULE_4__.c)(this.component);
        this.component.arcgisReady.emit();
    }
    _watchMetaProperties() {
        this.watch("position", (position) => {
            if (this.component.el.childElem != null && typeof position === "string")
                this.component.view?.ui.move(this.component.el.childElem, position);
        });
        this.watch("referenceElement", (referenceElement) => void (0,_component_utils_23194f7c_js__WEBPACK_IMPORTED_MODULE_4__.r)(this.component, referenceElement).catch(console.error));
    }
    _reEmitViewModelEvents() {
        const isEvented = "on" in this._instance && typeof this._instance.on === "function";
        if (!isEvented)
            return;
        const eventTarget = this._instance;
        Object.entries(this.component).forEach(([key, unknown]) => {
            const value = unknown;
            if (!key.startsWith("viewModel") ||
                key === "viewModel" ||
                typeof value !== "object" ||
                value === null ||
                !("emit" in value) ||
                typeof value.emit !== "function")
                return;
            const emit = value.emit;
            const trimmedEventName = key.slice("viewModel".length);
            const capitalizedEventName = (0,_index_7d72018f_js__WEBPACK_IMPORTED_MODULE_1__.k)(trimmedEventName);
            const eventName = `${capitalizedEventName[0].toLowerCase()}${capitalizedEventName.slice(1)}`;
            this.onLifecycle(() => this.reactiveUtils.on(() => eventTarget, eventName, emit));
        });
    }
    hostDisconnected() {
        if (typeof this.component.el.childElem === "object")
            this.component.view?.ui.remove(this.component.el.childElem);
    }
}
const proxy = (0,_chunk_WQTCUXBS_9ec3781a_js__WEBPACK_IMPORTED_MODULE_2__.p)(ViewModelController);

// TODO: [MIGRATION] migrate tests
const css = {
    base: "esri-home",
};
const useHomeViewModel = makeViewModelController(_index_0bc55ca5_js__WEBPACK_IMPORTED_MODULE_3__.H);
const ArcgisHome = class {
    constructor(hostRef) {
        (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);
        this.arcgisReady = (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "arcgisReady", 7);
        this.viewModelGo = (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "arcgisHomeGo", 7);
        //--------------------------------------------------------------------------
        //
        //  Controllers
        //
        //--------------------------------------------------------------------------
        this.manager = (0,_chunk_WQTCUXBS_9ec3781a_js__WEBPACK_IMPORTED_MODULE_2__.u)(this);
        this.messages = (0,_chunk_WQTCUXBS_9ec3781a_js__WEBPACK_IMPORTED_MODULE_2__.c)();
        this.reactiveUtils = (0,_chunk_WQTCUXBS_9ec3781a_js__WEBPACK_IMPORTED_MODULE_2__.l)(_index_0bc55ca5_js__WEBPACK_IMPORTED_MODULE_3__.i);
        this.viewModel = useHomeViewModel(this);
        //--------------------------------------------------------------------------
        //
        //  Private Methods
        //
        //--------------------------------------------------------------------------
        this._go = () => {
            const { viewModel } = this;
            if (viewModel.state === "going-home")
                viewModel.cancelGo();
            else
                viewModel.go();
        };
        this.goToOverride = this.viewModel.goToOverride;
        this.icon = "home";
        this.label = undefined;
        this.position = "top-left";
        this.referenceElement = undefined;
        this.viewpoint = this.viewModel.viewpoint;
        this.state = this.viewModel.state;
    }
    //--------------------------------------------------------------------------
    //
    //  Public Methods
    //
    //--------------------------------------------------------------------------
    /**
     * This function provides the ability to interrupt and cancel the process
     * of navigating the view back to the view's initial extent.
     *
     * @since 4.9
     */
    async cancelGo() {
        this.viewModel.cancelGo();
    }
    /**
     * Animates the view to the initial Viewpoint of the view or the
     * value of `viewpoint`
     */
    async go() {
        return this.viewModel.go();
    }
    render() {
        const { messages, icon } = this;
        const state = this.viewModel?.state;
        const isLoading = state === "going-home";
        return ((0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: (0,_index_7d72018f_js__WEBPACK_IMPORTED_MODULE_1__.c)(css.base, globalCss.widget) }, (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-button", { class: globalCss.widgetButton, disabled: state === "disabled", "icon-start": isLoading ? undefined : icon, kind: "neutral", label: messages.componentLabel, onClick: this._go,
            // Workaround for https://github.com/Esri/calcite-design-system/issues/8490
            scale: isLoading ? "s" : "m", title: state === "going-home" ? messages.cancel : messages.title }, isLoading ? (
        // Cannot use calcite-button's loading=true. See https://devtopia.esri.com/WebGIS/arcgis-js-api/pull/58358#discussion_r1106927
        (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-loader", { inline: true, label: "" })) : null)));
    }
    static get assetsDirs() { return ["assets"]; }
    get el() { return (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.g)(this); }
};




/***/ }),

/***/ "./node_modules/@arcgis/map-components/dist/esm/component-utils-23194f7c.js":
/*!**********************************************************************************!*\
  !*** ./node_modules/@arcgis/map-components/dist/esm/component-utils-23194f7c.js ***!
  \**********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   a: () => (/* binding */ addHandles),
/* harmony export */   b: () => (/* binding */ isNotSameViewpoint),
/* harmony export */   c: () => (/* binding */ checkForView),
/* harmony export */   d: () => (/* binding */ checkForExpand),
/* harmony export */   e: () => (/* binding */ isNotSameCamera),
/* harmony export */   f: () => (/* binding */ isNotSameEnvironment),
/* harmony export */   g: () => (/* binding */ isValidInteger),
/* harmony export */   i: () => (/* binding */ isNullOrEmptyString),
/* harmony export */   r: () => (/* binding */ referenceElementHelper)
/* harmony export */ });
/*!
 * All material copyright Esri, All Rights Reserved, unless otherwise specified.
 * See https://js.arcgis.com/4.30/esri/copyright.txt for details.
 * v4.30.0-next.37
 */
function checkForExpand(element) {
    const expandRef = element.el.closest("arcgis-expand") ?? element.expandElem;
    if (expandRef?.widget) {
        element.view = expandRef.view;
        expandRef.widget.content = element.childElem ?? element.el;
        // TODO: Update to be expandIcon = widget.icon, not ready yet in 4.27next
        if (!expandRef.expandIcon) {
            expandRef.widget.expandIcon = element.widget ? element.widget.icon : element?.icon;
        }
        return true;
    }
    if (expandRef) {
        const widgetHandler = () => {
            expandRef.removeEventListener("arcgisExpandReady", widgetHandler, false);
            element.view = expandRef.view;
            expandRef.widget.content = element.childElem ?? element.el;
            if (!expandRef.expandIcon) {
                expandRef.widget.expandIcon = element.widget ? element.widget.icon : element?.icon;
            }
        };
        expandRef.addEventListener("arcgisExpandReady", widgetHandler, false);
        return true;
    }
    return false;
}

//--------------------------------------------------------------------------
//
//  Public Methods
//
//--------------------------------------------------------------------------
function addHandles(element, handle) {
    if (Array.isArray(handle)) {
        element._watchHandles = [...element._watchHandles, ...handle];
    }
    else {
        element._watchHandles.push(handle);
    }
}
function checkForView(element) {
    let isUsingReferenceElement = false;
    if (!checkForExpand(element)) {
        let viewRef = element.el.closest("arcgis-map") ?? element.el.closest("arcgis-scene");
        if (!viewRef && typeof element.referenceElement === "string") {
            viewRef = document.querySelector(element.referenceElement);
            isUsingReferenceElement = true;
        }
        if (viewRef?.view) {
            element.view = viewRef.view;
            const el = element.childElem ?? element.el;
            if (!isUsingReferenceElement) {
                element.view.ui.add(el, element.position);
            }
        }
        else if (viewRef) {
            waitForViewHandler(viewRef, element, isUsingReferenceElement);
        }
    }
    else {
        const viewRef = element.el.closest("arcgis-map") ?? element.el.closest("arcgis-scene");
        if (viewRef?.view) {
            element.view = viewRef.view;
        }
        else if (viewRef) {
            const handler = () => {
                viewRef.removeEventListener("arcgisViewReadyChange", handler, false);
                element.view = viewRef.view;
            };
            viewRef.addEventListener("arcgisViewReadyChange", handler, false);
        }
    }
}
function isNullOrEmptyString(value) {
    return value === undefined || value === null || value === "";
}
function isValidInteger(value) {
    return value != null && value % 1 === 0;
}
function isNotSameCamera(camera, camera2) {
    return (camera2 === undefined ||
        camera.position !== camera2.position ||
        camera.heading !== camera2.heading ||
        camera.tilt !== camera2.tilt);
}
function isNotSameEnvironment(environment, environment2) {
    return (environment2 === undefined ||
        environment2.atmosphereEnabled !== environment.atmosphereEnabled ||
        environment2.lighting.date !== environment.lighting.date ||
        environment2.lighting.directShadowsEnabled !==
            environment.lighting.directShadowsEnabled ||
        environment2.lighting.cameraTrackingEnabled !==
            environment.lighting.cameraTrackingEnabled ||
        environment2.lighting.date !== environment.lighting.date ||
        environment2.lighting.displayUTCOffset !==
            environment.lighting.displayUTCOffset);
}
function isNotSameViewpoint(viewpoint, viewpoint2) {
    return (viewpoint2 === undefined ||
        viewpoint.targetGeometry !== viewpoint2.targetGeometry ||
        viewpoint.rotation !== viewpoint2.rotation ||
        viewpoint.scale !== viewpoint2.scale);
}
async function updateForView(viewStr) {
    const viewRef = document.querySelector(viewStr);
    return await new Promise((resolve) => {
        if (viewRef?.view !== undefined) {
            resolve(viewRef.view);
        }
        else if (viewRef) {
            const handler = () => {
                viewRef.removeEventListener("arcgisViewReadyChange", handler, false);
                resolve(viewRef.view);
            };
            viewRef.addEventListener("arcgisViewReadyChange", handler, false);
        }
    });
}
async function referenceElementHelper(element, refElement) {
    if (refElement === undefined)
        return;
    else if (typeof refElement === "string") {
        element.view = await updateForView(refElement);
    }
    else if (element.widget) {
        element.view = refElement.view;
    }
}
//--------------------------------------------------------------------------
//
//  Private Methods
//
//--------------------------------------------------------------------------
function waitForViewHandler(viewRef, element, isUsingRefernceElement) {
    const handler = () => {
        viewRef.removeEventListener("arcgisViewReadyChange", handler, false);
        element.view = viewRef.view;
        if (!isUsingRefernceElement) {
            element.view.ui.add(element.childElem ?? element.el, element.position);
        }
    };
    viewRef.addEventListener("arcgisViewReadyChange", handler, false);
}




/***/ }),

/***/ "./node_modules/@arcgis/map-components/dist/esm/index-7d72018f.js":
/*!************************************************************************!*\
  !*** ./node_modules/@arcgis/map-components/dist/esm/index-7d72018f.js ***!
  \************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   c: () => (/* binding */ classes),
/* harmony export */   k: () => (/* binding */ kebabToPascal)
/* harmony export */ });
/*!
 * All material copyright Esri, All Rights Reserved, unless otherwise specified.
 * See https://js.arcgis.com/4.30/esri/copyright.txt for details.
 * v4.30.0-next.37
 */
// src/array-utils.ts

// src/css-utils.ts
function classes(...classes2) {
  const effectiveClasses = [];
  for (let i = 0; i < classes2.length; i++) {
    const arg = classes2[i];
    if (typeof arg === "string") {
      effectiveClasses.push(arg);
    } else if (Array.isArray(arg)) {
      effectiveClasses.push.apply(effectiveClasses, arg);
    } else if (typeof arg === "object") {
      for (const prop in arg) {
        if (arg[prop]) {
          effectiveClasses.push(prop);
        }
      }
    }
  }
  const className = effectiveClasses.join(" ");
  effectiveClasses.length = 0;
  return className;
}

// src/text.ts
var kebabToPascal = (name) => name.split("-").map((part) => (part[0]?.toLocaleUpperCase() ?? "") + part.slice(1)).join("");
var capitalize = (string) => string.charAt(0).toUpperCase() + string.slice(1);
var camelToHuman = (value) => capitalize(value.replaceAll(/([a-z])([A-Z])/gu, "$1 $2"));
new Proxy(
  {},
  {
    get: (_target, property) => camelToHuman(property.toString())
  }
);




/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2lkZ2V0cy9jaHVua3MvdmVuZG9ycy1ub2RlX21vZHVsZXNfYXJjZ2lzX21hcC1jb21wb25lbnRzX2Rpc3RfZXNtX2FyY2dpcy1ob21lX2VudHJ5X2pzLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDa0c7QUFDM0I7QUFDc0U7QUFDeEM7QUFDTjs7QUFFL0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQywwREFBa0I7QUFDcEQ7QUFDQTtBQUNBLFlBQVksK0RBQVk7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixLQUFLO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLEVBQXNFO0FBQ2xGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCLGFBQWE7QUFDYixRQUFRLCtEQUFZO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxrRUFBa0UsK0RBQXNCO0FBQ3hGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5Q0FBeUMscURBQWE7QUFDdEQsaUNBQWlDLHNDQUFzQyxFQUFFLDhCQUE4QjtBQUN2RztBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLDhEQUFZOztBQUUxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlEQUFpRCxpREFBMkI7QUFDNUU7QUFDQTtBQUNBLFFBQVEscURBQWdCO0FBQ3hCLDJCQUEyQixxREFBVztBQUN0QywyQkFBMkIscURBQVc7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1Qiw4REFBb0I7QUFDM0Msd0JBQXdCLDhEQUFNO0FBQzlCLDZCQUE2Qiw4REFBSSxDQUFDLGlEQUF1QjtBQUN6RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixZQUFZO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsaUJBQWlCO0FBQ2pDO0FBQ0E7QUFDQSxnQkFBZ0IscURBQUMsVUFBVSxPQUFPLHFEQUFPLDhCQUE4QixFQUFFLHFEQUFDLHFCQUFxQjtBQUMvRjtBQUNBLDRHQUE0RztBQUM1RztBQUNBLFFBQVEscURBQUMscUJBQXFCLHlCQUF5QjtBQUN2RDtBQUNBLDhCQUE4QjtBQUM5QixlQUFlLE9BQU8scURBQVU7QUFDaEM7O0FBRXFDOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ3ZOckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFeU47Ozs7Ozs7Ozs7Ozs7Ozs7QUNwSnpOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IscUJBQXFCO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7O0FBRTRDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL25vZGVfbW9kdWxlcy9AYXJjZ2lzL21hcC1jb21wb25lbnRzL2Rpc3QvZXNtL2FyY2dpcy1ob21lLmVudHJ5LmpzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9ub2RlX21vZHVsZXMvQGFyY2dpcy9tYXAtY29tcG9uZW50cy9kaXN0L2VzbS9jb21wb25lbnQtdXRpbHMtMjMxOTRmN2MuanMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL25vZGVfbW9kdWxlcy9AYXJjZ2lzL21hcC1jb21wb25lbnRzL2Rpc3QvZXNtL2luZGV4LTdkNzIwMThmLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qIVxuICogQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFc3JpLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAqIFNlZSBodHRwczovL2pzLmFyY2dpcy5jb20vNC4zMC9lc3JpL2NvcHlyaWdodC50eHQgZm9yIGRldGFpbHMuXG4gKiB2NC4zMC4wLW5leHQuMzdcbiAqL1xuaW1wb3J0IHsgciBhcyByZWdpc3Rlckluc3RhbmNlLCBjIGFzIGNyZWF0ZUV2ZW50LCBoLCBnIGFzIGdldEVsZW1lbnQgfSBmcm9tICcuL2luZGV4LTZlMTcyYWFjLmpzJztcbmltcG9ydCB7IGsgYXMga2ViYWJUb1Bhc2NhbCwgYyBhcyBjbGFzc2VzIH0gZnJvbSAnLi9pbmRleC03ZDcyMDE4Zi5qcyc7XG5pbXBvcnQgeyBwIGFzIHByb3h5RXhwb3J0cywgQSBhcyBBY2Nlc3NvckNvbnRyb2xsZXIsIHUgYXMgdXNlQ29udHJvbGxlck1hbmFnZXIsIGMgYXMgdXNlVDluLCBsIGFzIGxvYWQgfSBmcm9tICcuL2NodW5rLVdRVENVWEJTLTllYzM3ODFhLmpzJztcbmltcG9ydCB7IEggYXMgbmV3V2lkZ2V0c0hvbWVIb21lVmlld01vZGVsLCBpIGFzIGltcG9ydENvcmVSZWFjdGl2ZVV0aWxzIH0gZnJvbSAnLi9pbmRleC0wYmM1NWNhNS5qcyc7XG5pbXBvcnQgeyBjIGFzIGNoZWNrRm9yVmlldywgciBhcyByZWZlcmVuY2VFbGVtZW50SGVscGVyIH0gZnJvbSAnLi9jb21wb25lbnQtdXRpbHMtMjMxOTRmN2MuanMnO1xuXG5jb25zdCBnbG9iYWxDc3MgPSB7XG4gICAgYW5jaG9yOiBcImVzcmktd2lkZ2V0X19hbmNob3JcIixcbiAgICBhbmNob3JEaXNhYmxlZDogXCJlc3JpLXdpZGdldF9fYW5jaG9yLS1kaXNhYmxlZFwiLFxuICAgIGJ1dHRvbjogXCJlc3JpLWJ1dHRvblwiLFxuICAgIGJ1dHRvbkRpc2FibGVkOiBcImVzcmktYnV0dG9uLS1kaXNhYmxlZFwiLFxuICAgIGJ1dHRvbkhhbGY6IFwiZXNyaS1idXR0b24tLWhhbGZcIixcbiAgICBidXR0b25TZWNvbmRhcnk6IFwiZXNyaS1idXR0b24tLXNlY29uZGFyeVwiLFxuICAgIGJ1dHRvblNtYWxsOiBcImVzcmktYnV0dG9uLS1zbWFsbFwiLFxuICAgIGJ1dHRvblRlcnRpYXJ5OiBcImVzcmktYnV0dG9uLS10ZXJ0aWFyeVwiLFxuICAgIGJ1dHRvblRoaXJkOiBcImVzcmktYnV0dG9uLS10aGlyZFwiLFxuICAgIGRpc2FibGVkOiBcImVzcmktZGlzYWJsZWRcIixcbiAgICBkaXNhYmxlZEVsZW1lbnQ6IFwiZXNyaS1kaXNhYmxlZC1lbGVtZW50XCIsXG4gICAgZW1wdHk6IFwiZXNyaS13aWRnZXRfX2NvbnRlbnQtLWVtcHR5XCIsXG4gICAgZW1wdHlJbGx1c3RyYXRpb246IFwiZXNyaS13aWRnZXRfX2NvbnRlbnQtaWxsdXN0cmF0aW9uLS1lbXB0eVwiLFxuICAgIGhlYWRpbmc6IFwiZXNyaS13aWRnZXRfX2hlYWRpbmdcIixcbiAgICBoaWRkZW46IFwiZXNyaS1oaWRkZW5cIixcbiAgICBpbnB1dDogXCJlc3JpLWlucHV0XCIsXG4gICAgaW50ZXJhY3RpdmU6IFwiZXNyaS1pbnRlcmFjdGl2ZVwiLFxuICAgIGxvYWRlcjogXCJlc3JpLXdpZGdldF9fbG9hZGVyXCIsXG4gICAgbG9hZGVyQW5pbWF0aW9uOiBcImVzcmktd2lkZ2V0X19sb2FkZXItYW5pbWF0aW9uXCIsXG4gICAgbG9hZGVyVGV4dDogXCJlc3JpLXdpZGdldF9fbG9hZGVyLXRleHRcIixcbiAgICBtZW51OiBcImVzcmktbWVudVwiLFxuICAgIG1lbnVIZWFkZXI6IFwiZXNyaS1tZW51X19oZWFkZXJcIixcbiAgICBtZW51SXRlbTogXCJlc3JpLW1lbnVfX2xpc3QtaXRlbVwiLFxuICAgIG1lbnVJdGVtQWN0aXZlOiBcImVzcmktbWVudV9fbGlzdC1pdGVtLS1hY3RpdmVcIixcbiAgICBtZW51SXRlbUZvY3VzOiBcImVzcmktbWVudV9fbGlzdC1pdGVtLS1mb2N1c1wiLFxuICAgIG1lbnVMaXN0OiBcImVzcmktbWVudV9fbGlzdFwiLFxuICAgIG5vQm9va21hcmtzSWNvbjogXCJlc3JpLXdpZGdldF9fbm8tYm9va21hcmstaWNvblwiLFxuICAgIHBhbmVsOiBcImVzcmktd2lkZ2V0LS1wYW5lbFwiLFxuICAgIHBhbmVsSGVpZ2h0T25seTogXCJlc3JpLXdpZGdldC0tcGFuZWwtaGVpZ2h0LW9ubHlcIixcbiAgICBwcmltYXJ5VGljazogXCJwcmltYXJ5LXRpY2tcIixcbiAgICBwcmltYXJ5VGlja0FtUG06IFwicHJpbWFyeS10aWNrX19hbXBtXCIsXG4gICAgcHJpbWFyeVRpY2tMYWJlbDogXCJwcmltYXJ5LXRpY2tfX2xhYmVsXCIsXG4gICAgcm90YXRpbmc6IFwiZXNyaS1yb3RhdGluZ1wiLFxuICAgIHNlY29uZGFyeVRpY2s6IFwic2Vjb25kYXJ5LXRpY2tcIixcbiAgICBzZWxlY3Q6IFwiZXNyaS1zZWxlY3RcIixcbiAgICB0YWJsZTogXCJlc3JpLXdpZGdldF9fdGFibGVcIixcbiAgICB1aTogXCJlc3JpLWNvbXBvbmVudFwiLFxuICAgIHdpZGdldDogXCJlc3JpLXdpZGdldFwiLFxuICAgIHdpZGdldEJ1dHRvbjogXCJlc3JpLXdpZGdldC0tYnV0dG9uXCIsXG4gICAgd2lkZ2V0QnV0dG9uQWN0aXZlOiBcImVzcmktd2lkZ2V0LS1idXR0b24tYWN0aXZlXCIsXG4gICAgd2lkZ2V0RGlzYWJsZWQ6IFwiZXNyaS13aWRnZXQtLWRpc2FibGVkXCIsXG59O1xuXG4vLyBGSVhNRTogYXV0by1kZXN0cm95IHZpZXdNb2RlbD9cbi8qKlxuICogQSBjb250cm9sbGVyIGZvciBhIG1hcHBpbmcgY29tcG9uZW50IHRoYXQ6XG4gKiAtIGxvYWRzIHRoZSB2aWV3TW9kZWxcbiAqIC0gaW5pdGlhbGl6ZXMgdGhlIHZpZXdNb2RlbCB3aXRoIHRoZSBjb21wb25lbnQncyBwcm9wZXJ0aWVzXG4gKiAtIGRvZXMgdHdvLXdheSBiaW5kaW5nIGJldHdlZW4gdmlldyBtb2RlbCBhbmQgY29tcG9uZW50IHByb3BlcnRpZXNcbiAqIC0gcmUtZW1pdHMgdGhlIHZpZXdNb2RlbCdzIGV2ZW50cyBvbiB0aGUgY29tcG9uZW50XG4gKiAtIHR5cGUtY2hlY2tzIGV2ZXJ5dGhpbmcg4pyoXG4gKlxuICogRG9jdW1lbnRhdGlvbjpcbiAqIGh0dHBzOi8vZGV2dG9waWEuZXNyaS5jb20vV2ViR0lTL2FyY2dpcy13ZWItY29tcG9uZW50cy9ibG9iL21haW4vcGFja2FnZXMvbWFwLWNvbXBvbmVudHMvc3JjL2NvbnRyb2xsZXJzL3VzZVZpZXdNb2RlbC5tZFxuICovXG5jb25zdCBtYWtlVmlld01vZGVsQ29udHJvbGxlciA9IChsb2FkVmlld01vZGVsKSA9PiAoY29tcG9uZW50KSA9PiBwcm94eShjb21wb25lbnQsIGxvYWRWaWV3TW9kZWwpO1xuLy8gUkVGQUNUT1I6IGV4dHJhY3QgY29tbW9uIGxvZ2ljIGludG8gSW50ZWdyYXRpb25Db250cm9sbGVyPz8/XG5jbGFzcyBWaWV3TW9kZWxDb250cm9sbGVyIGV4dGVuZHMgQWNjZXNzb3JDb250cm9sbGVyIHtcbiAgICBob3N0Q29ubmVjdGVkKCkge1xuICAgICAgICBpZiAodGhpcy5jb21wb25lbnQubWFuYWdlci5kaWRMb2FkQ2FsbGVkKVxuICAgICAgICAgICAgY2hlY2tGb3JWaWV3KHRoaXMuY29tcG9uZW50KTtcbiAgICB9XG4gICAgYXN5bmMgaG9zdExvYWQoKSB7XG4gICAgICAgIGF3YWl0IHN1cGVyLmhvc3RMb2FkKCk7XG4gICAgICAgIHRoaXMuX3dhdGNoTWV0YVByb3BlcnRpZXMoKTtcbiAgICAgICAgdGhpcy5fcmVFbWl0Vmlld01vZGVsRXZlbnRzKCk7XG4gICAgfVxuICAgIC8vIFRoaXMgY2FuJ3QgYmUgaW4gaG9zdExvYWQgYXMgY2hpbGRFbGVtIGlzIG9ubHkgYWNjZXNzaWJsZSBhZnRlciBmaXJzdCByZW5kZXJcbiAgICBob3N0TG9hZGVkKCkge1xuICAgICAgICBjb25zdCB7IGVsIH0gPSB0aGlzLmNvbXBvbmVudDtcbiAgICAgICAgY29uc3QgY2hpbGROb2RlID0gZWwuc2hhZG93Um9vdD8uZmlyc3RDaGlsZCA/PyBlbC5maXJzdENoaWxkID8/IHVuZGVmaW5lZDtcbiAgICAgICAgLypcbiAgICAgICAgICogT24gaG90IHJlbG9hZGluZywgbmV3IHRoaXMuY29tcG9uZW50IGluc3RhbmNlIGlzIGNyZWF0ZWQgKHNvIHByb3BlcnRpZXNcbiAgICAgICAgICogYXJlIHJlc2V0KSBidXQgdGhpcy5jb21wb25lbnQuZWwgaW5zdGFuY2UgaXMgcHJlc2VydmVkIChzbyBwcm9wZXJ0aWVzIGFyZVxuICAgICAgICAgKiBwcmVzZXJ2ZWQpLiBTaW5jZSBjaGlsZEVsZW0gaXMgcmUtcGFyZW50ZWQgb24gMXN0IGhvc3RMb2FkKCksXG4gICAgICAgICAqIGZvciBpdCB0byBiZSBhY2Nlc3NpYmxlIG9uIHRoZSAybmQgaG9zdExvYWQoKSAoaG90IHJlbG9hZCksIHdlIGhhdmUgdG9cbiAgICAgICAgICogc3RvcmUgaXQncyByZWZlcmVuY2Ugb24gdGhlIGVsLCByYXRoZXIgdGhhbiBjb21wb25lbnRcbiAgICAgICAgICovXG4gICAgICAgIGVsLmNoaWxkRWxlbSA9IGNoaWxkTm9kZSA/PyBlbC5jaGlsZEVsZW07XG4gICAgICAgIHRoaXMuY29tcG9uZW50LmNoaWxkRWxlbSA9IGVsLmNoaWxkRWxlbTtcbiAgICAgICAgaWYgKGVsLmNoaWxkRWxlbSA9PT0gdW5kZWZpbmVkICYmIFwicHJvZHVjdGlvblwiICE9PSBcInByb2R1Y3Rpb25cIilcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlVuYWJsZSB0byBmaW5kIHJlZmVyZW5jZSB0byBjb21wb25lbnQncyByb290IGNoaWxkXCIpO1xuICAgICAgICAvLyBEZWZpbmUgdGhlIFwidmlld1wiIHByb3BlcnR5IGlmIG5vdCBhbHJlYWR5IHByZXNlbnQgZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBKUyBBUElcbiAgICAgICAgaWYgKCEoXCJ2aWV3XCIgaW4gdGhpcy5jb21wb25lbnQpKVxuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMuY29tcG9uZW50LCBcInZpZXdcIiwge1xuICAgICAgICAgICAgICAgIGdldDogKCkgPT4gdGhpcy5faW5zdGFuY2UudmlldyxcbiAgICAgICAgICAgICAgICBzZXQ6ICh2aWV3KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2luc3RhbmNlLnZpZXcgPSB2aWV3O1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbXBvbmVudC5yZXF1ZXN0VXBkYXRlKCk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICBjaGVja0ZvclZpZXcodGhpcy5jb21wb25lbnQpO1xuICAgICAgICB0aGlzLmNvbXBvbmVudC5hcmNnaXNSZWFkeS5lbWl0KCk7XG4gICAgfVxuICAgIF93YXRjaE1ldGFQcm9wZXJ0aWVzKCkge1xuICAgICAgICB0aGlzLndhdGNoKFwicG9zaXRpb25cIiwgKHBvc2l0aW9uKSA9PiB7XG4gICAgICAgICAgICBpZiAodGhpcy5jb21wb25lbnQuZWwuY2hpbGRFbGVtICE9IG51bGwgJiYgdHlwZW9mIHBvc2l0aW9uID09PSBcInN0cmluZ1wiKVxuICAgICAgICAgICAgICAgIHRoaXMuY29tcG9uZW50LnZpZXc/LnVpLm1vdmUodGhpcy5jb21wb25lbnQuZWwuY2hpbGRFbGVtLCBwb3NpdGlvbik7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLndhdGNoKFwicmVmZXJlbmNlRWxlbWVudFwiLCAocmVmZXJlbmNlRWxlbWVudCkgPT4gdm9pZCByZWZlcmVuY2VFbGVtZW50SGVscGVyKHRoaXMuY29tcG9uZW50LCByZWZlcmVuY2VFbGVtZW50KS5jYXRjaChjb25zb2xlLmVycm9yKSk7XG4gICAgfVxuICAgIF9yZUVtaXRWaWV3TW9kZWxFdmVudHMoKSB7XG4gICAgICAgIGNvbnN0IGlzRXZlbnRlZCA9IFwib25cIiBpbiB0aGlzLl9pbnN0YW5jZSAmJiB0eXBlb2YgdGhpcy5faW5zdGFuY2Uub24gPT09IFwiZnVuY3Rpb25cIjtcbiAgICAgICAgaWYgKCFpc0V2ZW50ZWQpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIGNvbnN0IGV2ZW50VGFyZ2V0ID0gdGhpcy5faW5zdGFuY2U7XG4gICAgICAgIE9iamVjdC5lbnRyaWVzKHRoaXMuY29tcG9uZW50KS5mb3JFYWNoKChba2V5LCB1bmtub3duXSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgdmFsdWUgPSB1bmtub3duO1xuICAgICAgICAgICAgaWYgKCFrZXkuc3RhcnRzV2l0aChcInZpZXdNb2RlbFwiKSB8fFxuICAgICAgICAgICAgICAgIGtleSA9PT0gXCJ2aWV3TW9kZWxcIiB8fFxuICAgICAgICAgICAgICAgIHR5cGVvZiB2YWx1ZSAhPT0gXCJvYmplY3RcIiB8fFxuICAgICAgICAgICAgICAgIHZhbHVlID09PSBudWxsIHx8XG4gICAgICAgICAgICAgICAgIShcImVtaXRcIiBpbiB2YWx1ZSkgfHxcbiAgICAgICAgICAgICAgICB0eXBlb2YgdmFsdWUuZW1pdCAhPT0gXCJmdW5jdGlvblwiKVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIGNvbnN0IGVtaXQgPSB2YWx1ZS5lbWl0O1xuICAgICAgICAgICAgY29uc3QgdHJpbW1lZEV2ZW50TmFtZSA9IGtleS5zbGljZShcInZpZXdNb2RlbFwiLmxlbmd0aCk7XG4gICAgICAgICAgICBjb25zdCBjYXBpdGFsaXplZEV2ZW50TmFtZSA9IGtlYmFiVG9QYXNjYWwodHJpbW1lZEV2ZW50TmFtZSk7XG4gICAgICAgICAgICBjb25zdCBldmVudE5hbWUgPSBgJHtjYXBpdGFsaXplZEV2ZW50TmFtZVswXS50b0xvd2VyQ2FzZSgpfSR7Y2FwaXRhbGl6ZWRFdmVudE5hbWUuc2xpY2UoMSl9YDtcbiAgICAgICAgICAgIHRoaXMub25MaWZlY3ljbGUoKCkgPT4gdGhpcy5yZWFjdGl2ZVV0aWxzLm9uKCgpID0+IGV2ZW50VGFyZ2V0LCBldmVudE5hbWUsIGVtaXQpKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGhvc3REaXNjb25uZWN0ZWQoKSB7XG4gICAgICAgIGlmICh0eXBlb2YgdGhpcy5jb21wb25lbnQuZWwuY2hpbGRFbGVtID09PSBcIm9iamVjdFwiKVxuICAgICAgICAgICAgdGhpcy5jb21wb25lbnQudmlldz8udWkucmVtb3ZlKHRoaXMuY29tcG9uZW50LmVsLmNoaWxkRWxlbSk7XG4gICAgfVxufVxuY29uc3QgcHJveHkgPSBwcm94eUV4cG9ydHMoVmlld01vZGVsQ29udHJvbGxlcik7XG5cbi8vIFRPRE86IFtNSUdSQVRJT05dIG1pZ3JhdGUgdGVzdHNcbmNvbnN0IGNzcyA9IHtcbiAgICBiYXNlOiBcImVzcmktaG9tZVwiLFxufTtcbmNvbnN0IHVzZUhvbWVWaWV3TW9kZWwgPSBtYWtlVmlld01vZGVsQ29udHJvbGxlcihuZXdXaWRnZXRzSG9tZUhvbWVWaWV3TW9kZWwpO1xuY29uc3QgQXJjZ2lzSG9tZSA9IGNsYXNzIHtcbiAgICBjb25zdHJ1Y3Rvcihob3N0UmVmKSB7XG4gICAgICAgIHJlZ2lzdGVySW5zdGFuY2UodGhpcywgaG9zdFJlZik7XG4gICAgICAgIHRoaXMuYXJjZ2lzUmVhZHkgPSBjcmVhdGVFdmVudCh0aGlzLCBcImFyY2dpc1JlYWR5XCIsIDcpO1xuICAgICAgICB0aGlzLnZpZXdNb2RlbEdvID0gY3JlYXRlRXZlbnQodGhpcywgXCJhcmNnaXNIb21lR29cIiwgNyk7XG4gICAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgLy9cbiAgICAgICAgLy8gIENvbnRyb2xsZXJzXG4gICAgICAgIC8vXG4gICAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgdGhpcy5tYW5hZ2VyID0gdXNlQ29udHJvbGxlck1hbmFnZXIodGhpcyk7XG4gICAgICAgIHRoaXMubWVzc2FnZXMgPSB1c2VUOW4oKTtcbiAgICAgICAgdGhpcy5yZWFjdGl2ZVV0aWxzID0gbG9hZChpbXBvcnRDb3JlUmVhY3RpdmVVdGlscyk7XG4gICAgICAgIHRoaXMudmlld01vZGVsID0gdXNlSG9tZVZpZXdNb2RlbCh0aGlzKTtcbiAgICAgICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAvL1xuICAgICAgICAvLyAgUHJpdmF0ZSBNZXRob2RzXG4gICAgICAgIC8vXG4gICAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgdGhpcy5fZ28gPSAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCB7IHZpZXdNb2RlbCB9ID0gdGhpcztcbiAgICAgICAgICAgIGlmICh2aWV3TW9kZWwuc3RhdGUgPT09IFwiZ29pbmctaG9tZVwiKVxuICAgICAgICAgICAgICAgIHZpZXdNb2RlbC5jYW5jZWxHbygpO1xuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIHZpZXdNb2RlbC5nbygpO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLmdvVG9PdmVycmlkZSA9IHRoaXMudmlld01vZGVsLmdvVG9PdmVycmlkZTtcbiAgICAgICAgdGhpcy5pY29uID0gXCJob21lXCI7XG4gICAgICAgIHRoaXMubGFiZWwgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMucG9zaXRpb24gPSBcInRvcC1sZWZ0XCI7XG4gICAgICAgIHRoaXMucmVmZXJlbmNlRWxlbWVudCA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy52aWV3cG9pbnQgPSB0aGlzLnZpZXdNb2RlbC52aWV3cG9pbnQ7XG4gICAgICAgIHRoaXMuc3RhdGUgPSB0aGlzLnZpZXdNb2RlbC5zdGF0ZTtcbiAgICB9XG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vXG4gICAgLy8gIFB1YmxpYyBNZXRob2RzXG4gICAgLy9cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLyoqXG4gICAgICogVGhpcyBmdW5jdGlvbiBwcm92aWRlcyB0aGUgYWJpbGl0eSB0byBpbnRlcnJ1cHQgYW5kIGNhbmNlbCB0aGUgcHJvY2Vzc1xuICAgICAqIG9mIG5hdmlnYXRpbmcgdGhlIHZpZXcgYmFjayB0byB0aGUgdmlldydzIGluaXRpYWwgZXh0ZW50LlxuICAgICAqXG4gICAgICogQHNpbmNlIDQuOVxuICAgICAqL1xuICAgIGFzeW5jIGNhbmNlbEdvKCkge1xuICAgICAgICB0aGlzLnZpZXdNb2RlbC5jYW5jZWxHbygpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBbmltYXRlcyB0aGUgdmlldyB0byB0aGUgaW5pdGlhbCBWaWV3cG9pbnQgb2YgdGhlIHZpZXcgb3IgdGhlXG4gICAgICogdmFsdWUgb2YgYHZpZXdwb2ludGBcbiAgICAgKi9cbiAgICBhc3luYyBnbygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudmlld01vZGVsLmdvKCk7XG4gICAgfVxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgY29uc3QgeyBtZXNzYWdlcywgaWNvbiB9ID0gdGhpcztcbiAgICAgICAgY29uc3Qgc3RhdGUgPSB0aGlzLnZpZXdNb2RlbD8uc3RhdGU7XG4gICAgICAgIGNvbnN0IGlzTG9hZGluZyA9IHN0YXRlID09PSBcImdvaW5nLWhvbWVcIjtcbiAgICAgICAgcmV0dXJuIChoKFwiZGl2XCIsIHsgY2xhc3M6IGNsYXNzZXMoY3NzLmJhc2UsIGdsb2JhbENzcy53aWRnZXQpIH0sIGgoXCJjYWxjaXRlLWJ1dHRvblwiLCB7IGNsYXNzOiBnbG9iYWxDc3Mud2lkZ2V0QnV0dG9uLCBkaXNhYmxlZDogc3RhdGUgPT09IFwiZGlzYWJsZWRcIiwgXCJpY29uLXN0YXJ0XCI6IGlzTG9hZGluZyA/IHVuZGVmaW5lZCA6IGljb24sIGtpbmQ6IFwibmV1dHJhbFwiLCBsYWJlbDogbWVzc2FnZXMuY29tcG9uZW50TGFiZWwsIG9uQ2xpY2s6IHRoaXMuX2dvLFxuICAgICAgICAgICAgLy8gV29ya2Fyb3VuZCBmb3IgaHR0cHM6Ly9naXRodWIuY29tL0VzcmkvY2FsY2l0ZS1kZXNpZ24tc3lzdGVtL2lzc3Vlcy84NDkwXG4gICAgICAgICAgICBzY2FsZTogaXNMb2FkaW5nID8gXCJzXCIgOiBcIm1cIiwgdGl0bGU6IHN0YXRlID09PSBcImdvaW5nLWhvbWVcIiA/IG1lc3NhZ2VzLmNhbmNlbCA6IG1lc3NhZ2VzLnRpdGxlIH0sIGlzTG9hZGluZyA/IChcbiAgICAgICAgLy8gQ2Fubm90IHVzZSBjYWxjaXRlLWJ1dHRvbidzIGxvYWRpbmc9dHJ1ZS4gU2VlIGh0dHBzOi8vZGV2dG9waWEuZXNyaS5jb20vV2ViR0lTL2FyY2dpcy1qcy1hcGkvcHVsbC81ODM1OCNkaXNjdXNzaW9uX3IxMTA2OTI3XG4gICAgICAgIGgoXCJjYWxjaXRlLWxvYWRlclwiLCB7IGlubGluZTogdHJ1ZSwgbGFiZWw6IFwiXCIgfSkpIDogbnVsbCkpKTtcbiAgICB9XG4gICAgc3RhdGljIGdldCBhc3NldHNEaXJzKCkgeyByZXR1cm4gW1wiYXNzZXRzXCJdOyB9XG4gICAgZ2V0IGVsKCkgeyByZXR1cm4gZ2V0RWxlbWVudCh0aGlzKTsgfVxufTtcblxuZXhwb3J0IHsgQXJjZ2lzSG9tZSBhcyBhcmNnaXNfaG9tZSB9O1xuIiwiLyohXG4gKiBBbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVzcmksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuICogU2VlIGh0dHBzOi8vanMuYXJjZ2lzLmNvbS80LjMwL2VzcmkvY29weXJpZ2h0LnR4dCBmb3IgZGV0YWlscy5cbiAqIHY0LjMwLjAtbmV4dC4zN1xuICovXG5mdW5jdGlvbiBjaGVja0ZvckV4cGFuZChlbGVtZW50KSB7XG4gICAgY29uc3QgZXhwYW5kUmVmID0gZWxlbWVudC5lbC5jbG9zZXN0KFwiYXJjZ2lzLWV4cGFuZFwiKSA/PyBlbGVtZW50LmV4cGFuZEVsZW07XG4gICAgaWYgKGV4cGFuZFJlZj8ud2lkZ2V0KSB7XG4gICAgICAgIGVsZW1lbnQudmlldyA9IGV4cGFuZFJlZi52aWV3O1xuICAgICAgICBleHBhbmRSZWYud2lkZ2V0LmNvbnRlbnQgPSBlbGVtZW50LmNoaWxkRWxlbSA/PyBlbGVtZW50LmVsO1xuICAgICAgICAvLyBUT0RPOiBVcGRhdGUgdG8gYmUgZXhwYW5kSWNvbiA9IHdpZGdldC5pY29uLCBub3QgcmVhZHkgeWV0IGluIDQuMjduZXh0XG4gICAgICAgIGlmICghZXhwYW5kUmVmLmV4cGFuZEljb24pIHtcbiAgICAgICAgICAgIGV4cGFuZFJlZi53aWRnZXQuZXhwYW5kSWNvbiA9IGVsZW1lbnQud2lkZ2V0ID8gZWxlbWVudC53aWRnZXQuaWNvbiA6IGVsZW1lbnQ/Lmljb247XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIGlmIChleHBhbmRSZWYpIHtcbiAgICAgICAgY29uc3Qgd2lkZ2V0SGFuZGxlciA9ICgpID0+IHtcbiAgICAgICAgICAgIGV4cGFuZFJlZi5yZW1vdmVFdmVudExpc3RlbmVyKFwiYXJjZ2lzRXhwYW5kUmVhZHlcIiwgd2lkZ2V0SGFuZGxlciwgZmFsc2UpO1xuICAgICAgICAgICAgZWxlbWVudC52aWV3ID0gZXhwYW5kUmVmLnZpZXc7XG4gICAgICAgICAgICBleHBhbmRSZWYud2lkZ2V0LmNvbnRlbnQgPSBlbGVtZW50LmNoaWxkRWxlbSA/PyBlbGVtZW50LmVsO1xuICAgICAgICAgICAgaWYgKCFleHBhbmRSZWYuZXhwYW5kSWNvbikge1xuICAgICAgICAgICAgICAgIGV4cGFuZFJlZi53aWRnZXQuZXhwYW5kSWNvbiA9IGVsZW1lbnQud2lkZ2V0ID8gZWxlbWVudC53aWRnZXQuaWNvbiA6IGVsZW1lbnQ/Lmljb247XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIGV4cGFuZFJlZi5hZGRFdmVudExpc3RlbmVyKFwiYXJjZ2lzRXhwYW5kUmVhZHlcIiwgd2lkZ2V0SGFuZGxlciwgZmFsc2UpO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xufVxuXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vL1xuLy8gIFB1YmxpYyBNZXRob2RzXG4vL1xuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuZnVuY3Rpb24gYWRkSGFuZGxlcyhlbGVtZW50LCBoYW5kbGUpIHtcbiAgICBpZiAoQXJyYXkuaXNBcnJheShoYW5kbGUpKSB7XG4gICAgICAgIGVsZW1lbnQuX3dhdGNoSGFuZGxlcyA9IFsuLi5lbGVtZW50Ll93YXRjaEhhbmRsZXMsIC4uLmhhbmRsZV07XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBlbGVtZW50Ll93YXRjaEhhbmRsZXMucHVzaChoYW5kbGUpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGNoZWNrRm9yVmlldyhlbGVtZW50KSB7XG4gICAgbGV0IGlzVXNpbmdSZWZlcmVuY2VFbGVtZW50ID0gZmFsc2U7XG4gICAgaWYgKCFjaGVja0ZvckV4cGFuZChlbGVtZW50KSkge1xuICAgICAgICBsZXQgdmlld1JlZiA9IGVsZW1lbnQuZWwuY2xvc2VzdChcImFyY2dpcy1tYXBcIikgPz8gZWxlbWVudC5lbC5jbG9zZXN0KFwiYXJjZ2lzLXNjZW5lXCIpO1xuICAgICAgICBpZiAoIXZpZXdSZWYgJiYgdHlwZW9mIGVsZW1lbnQucmVmZXJlbmNlRWxlbWVudCA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgdmlld1JlZiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZWxlbWVudC5yZWZlcmVuY2VFbGVtZW50KTtcbiAgICAgICAgICAgIGlzVXNpbmdSZWZlcmVuY2VFbGVtZW50ID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodmlld1JlZj8udmlldykge1xuICAgICAgICAgICAgZWxlbWVudC52aWV3ID0gdmlld1JlZi52aWV3O1xuICAgICAgICAgICAgY29uc3QgZWwgPSBlbGVtZW50LmNoaWxkRWxlbSA/PyBlbGVtZW50LmVsO1xuICAgICAgICAgICAgaWYgKCFpc1VzaW5nUmVmZXJlbmNlRWxlbWVudCkge1xuICAgICAgICAgICAgICAgIGVsZW1lbnQudmlldy51aS5hZGQoZWwsIGVsZW1lbnQucG9zaXRpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHZpZXdSZWYpIHtcbiAgICAgICAgICAgIHdhaXRGb3JWaWV3SGFuZGxlcih2aWV3UmVmLCBlbGVtZW50LCBpc1VzaW5nUmVmZXJlbmNlRWxlbWVudCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGNvbnN0IHZpZXdSZWYgPSBlbGVtZW50LmVsLmNsb3Nlc3QoXCJhcmNnaXMtbWFwXCIpID8/IGVsZW1lbnQuZWwuY2xvc2VzdChcImFyY2dpcy1zY2VuZVwiKTtcbiAgICAgICAgaWYgKHZpZXdSZWY/LnZpZXcpIHtcbiAgICAgICAgICAgIGVsZW1lbnQudmlldyA9IHZpZXdSZWYudmlldztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh2aWV3UmVmKSB7XG4gICAgICAgICAgICBjb25zdCBoYW5kbGVyID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgIHZpZXdSZWYucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImFyY2dpc1ZpZXdSZWFkeUNoYW5nZVwiLCBoYW5kbGVyLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgZWxlbWVudC52aWV3ID0gdmlld1JlZi52aWV3O1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZpZXdSZWYuYWRkRXZlbnRMaXN0ZW5lcihcImFyY2dpc1ZpZXdSZWFkeUNoYW5nZVwiLCBoYW5kbGVyLCBmYWxzZSk7XG4gICAgICAgIH1cbiAgICB9XG59XG5mdW5jdGlvbiBpc051bGxPckVtcHR5U3RyaW5nKHZhbHVlKSB7XG4gICAgcmV0dXJuIHZhbHVlID09PSB1bmRlZmluZWQgfHwgdmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IFwiXCI7XG59XG5mdW5jdGlvbiBpc1ZhbGlkSW50ZWdlcih2YWx1ZSkge1xuICAgIHJldHVybiB2YWx1ZSAhPSBudWxsICYmIHZhbHVlICUgMSA9PT0gMDtcbn1cbmZ1bmN0aW9uIGlzTm90U2FtZUNhbWVyYShjYW1lcmEsIGNhbWVyYTIpIHtcbiAgICByZXR1cm4gKGNhbWVyYTIgPT09IHVuZGVmaW5lZCB8fFxuICAgICAgICBjYW1lcmEucG9zaXRpb24gIT09IGNhbWVyYTIucG9zaXRpb24gfHxcbiAgICAgICAgY2FtZXJhLmhlYWRpbmcgIT09IGNhbWVyYTIuaGVhZGluZyB8fFxuICAgICAgICBjYW1lcmEudGlsdCAhPT0gY2FtZXJhMi50aWx0KTtcbn1cbmZ1bmN0aW9uIGlzTm90U2FtZUVudmlyb25tZW50KGVudmlyb25tZW50LCBlbnZpcm9ubWVudDIpIHtcbiAgICByZXR1cm4gKGVudmlyb25tZW50MiA9PT0gdW5kZWZpbmVkIHx8XG4gICAgICAgIGVudmlyb25tZW50Mi5hdG1vc3BoZXJlRW5hYmxlZCAhPT0gZW52aXJvbm1lbnQuYXRtb3NwaGVyZUVuYWJsZWQgfHxcbiAgICAgICAgZW52aXJvbm1lbnQyLmxpZ2h0aW5nLmRhdGUgIT09IGVudmlyb25tZW50LmxpZ2h0aW5nLmRhdGUgfHxcbiAgICAgICAgZW52aXJvbm1lbnQyLmxpZ2h0aW5nLmRpcmVjdFNoYWRvd3NFbmFibGVkICE9PVxuICAgICAgICAgICAgZW52aXJvbm1lbnQubGlnaHRpbmcuZGlyZWN0U2hhZG93c0VuYWJsZWQgfHxcbiAgICAgICAgZW52aXJvbm1lbnQyLmxpZ2h0aW5nLmNhbWVyYVRyYWNraW5nRW5hYmxlZCAhPT1cbiAgICAgICAgICAgIGVudmlyb25tZW50LmxpZ2h0aW5nLmNhbWVyYVRyYWNraW5nRW5hYmxlZCB8fFxuICAgICAgICBlbnZpcm9ubWVudDIubGlnaHRpbmcuZGF0ZSAhPT0gZW52aXJvbm1lbnQubGlnaHRpbmcuZGF0ZSB8fFxuICAgICAgICBlbnZpcm9ubWVudDIubGlnaHRpbmcuZGlzcGxheVVUQ09mZnNldCAhPT1cbiAgICAgICAgICAgIGVudmlyb25tZW50LmxpZ2h0aW5nLmRpc3BsYXlVVENPZmZzZXQpO1xufVxuZnVuY3Rpb24gaXNOb3RTYW1lVmlld3BvaW50KHZpZXdwb2ludCwgdmlld3BvaW50Mikge1xuICAgIHJldHVybiAodmlld3BvaW50MiA9PT0gdW5kZWZpbmVkIHx8XG4gICAgICAgIHZpZXdwb2ludC50YXJnZXRHZW9tZXRyeSAhPT0gdmlld3BvaW50Mi50YXJnZXRHZW9tZXRyeSB8fFxuICAgICAgICB2aWV3cG9pbnQucm90YXRpb24gIT09IHZpZXdwb2ludDIucm90YXRpb24gfHxcbiAgICAgICAgdmlld3BvaW50LnNjYWxlICE9PSB2aWV3cG9pbnQyLnNjYWxlKTtcbn1cbmFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUZvclZpZXcodmlld1N0cikge1xuICAgIGNvbnN0IHZpZXdSZWYgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHZpZXdTdHIpO1xuICAgIHJldHVybiBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xuICAgICAgICBpZiAodmlld1JlZj8udmlldyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXNvbHZlKHZpZXdSZWYudmlldyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodmlld1JlZikge1xuICAgICAgICAgICAgY29uc3QgaGFuZGxlciA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICB2aWV3UmVmLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJhcmNnaXNWaWV3UmVhZHlDaGFuZ2VcIiwgaGFuZGxlciwgZmFsc2UpO1xuICAgICAgICAgICAgICAgIHJlc29sdmUodmlld1JlZi52aWV3KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2aWV3UmVmLmFkZEV2ZW50TGlzdGVuZXIoXCJhcmNnaXNWaWV3UmVhZHlDaGFuZ2VcIiwgaGFuZGxlciwgZmFsc2UpO1xuICAgICAgICB9XG4gICAgfSk7XG59XG5hc3luYyBmdW5jdGlvbiByZWZlcmVuY2VFbGVtZW50SGVscGVyKGVsZW1lbnQsIHJlZkVsZW1lbnQpIHtcbiAgICBpZiAocmVmRWxlbWVudCA9PT0gdW5kZWZpbmVkKVxuICAgICAgICByZXR1cm47XG4gICAgZWxzZSBpZiAodHlwZW9mIHJlZkVsZW1lbnQgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgZWxlbWVudC52aWV3ID0gYXdhaXQgdXBkYXRlRm9yVmlldyhyZWZFbGVtZW50KTtcbiAgICB9XG4gICAgZWxzZSBpZiAoZWxlbWVudC53aWRnZXQpIHtcbiAgICAgICAgZWxlbWVudC52aWV3ID0gcmVmRWxlbWVudC52aWV3O1xuICAgIH1cbn1cbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vXG4vLyAgUHJpdmF0ZSBNZXRob2RzXG4vL1xuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuZnVuY3Rpb24gd2FpdEZvclZpZXdIYW5kbGVyKHZpZXdSZWYsIGVsZW1lbnQsIGlzVXNpbmdSZWZlcm5jZUVsZW1lbnQpIHtcbiAgICBjb25zdCBoYW5kbGVyID0gKCkgPT4ge1xuICAgICAgICB2aWV3UmVmLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJhcmNnaXNWaWV3UmVhZHlDaGFuZ2VcIiwgaGFuZGxlciwgZmFsc2UpO1xuICAgICAgICBlbGVtZW50LnZpZXcgPSB2aWV3UmVmLnZpZXc7XG4gICAgICAgIGlmICghaXNVc2luZ1JlZmVybmNlRWxlbWVudCkge1xuICAgICAgICAgICAgZWxlbWVudC52aWV3LnVpLmFkZChlbGVtZW50LmNoaWxkRWxlbSA/PyBlbGVtZW50LmVsLCBlbGVtZW50LnBvc2l0aW9uKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgdmlld1JlZi5hZGRFdmVudExpc3RlbmVyKFwiYXJjZ2lzVmlld1JlYWR5Q2hhbmdlXCIsIGhhbmRsZXIsIGZhbHNlKTtcbn1cblxuZXhwb3J0IHsgYWRkSGFuZGxlcyBhcyBhLCBpc05vdFNhbWVWaWV3cG9pbnQgYXMgYiwgY2hlY2tGb3JWaWV3IGFzIGMsIGNoZWNrRm9yRXhwYW5kIGFzIGQsIGlzTm90U2FtZUNhbWVyYSBhcyBlLCBpc05vdFNhbWVFbnZpcm9ubWVudCBhcyBmLCBpc1ZhbGlkSW50ZWdlciBhcyBnLCBpc051bGxPckVtcHR5U3RyaW5nIGFzIGksIHJlZmVyZW5jZUVsZW1lbnRIZWxwZXIgYXMgciB9O1xuIiwiLyohXG4gKiBBbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVzcmksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuICogU2VlIGh0dHBzOi8vanMuYXJjZ2lzLmNvbS80LjMwL2VzcmkvY29weXJpZ2h0LnR4dCBmb3IgZGV0YWlscy5cbiAqIHY0LjMwLjAtbmV4dC4zN1xuICovXG4vLyBzcmMvYXJyYXktdXRpbHMudHNcblxuLy8gc3JjL2Nzcy11dGlscy50c1xuZnVuY3Rpb24gY2xhc3NlcyguLi5jbGFzc2VzMikge1xuICBjb25zdCBlZmZlY3RpdmVDbGFzc2VzID0gW107XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgY2xhc3NlczIubGVuZ3RoOyBpKyspIHtcbiAgICBjb25zdCBhcmcgPSBjbGFzc2VzMltpXTtcbiAgICBpZiAodHlwZW9mIGFyZyA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgZWZmZWN0aXZlQ2xhc3Nlcy5wdXNoKGFyZyk7XG4gICAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KGFyZykpIHtcbiAgICAgIGVmZmVjdGl2ZUNsYXNzZXMucHVzaC5hcHBseShlZmZlY3RpdmVDbGFzc2VzLCBhcmcpO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIGFyZyA9PT0gXCJvYmplY3RcIikge1xuICAgICAgZm9yIChjb25zdCBwcm9wIGluIGFyZykge1xuICAgICAgICBpZiAoYXJnW3Byb3BdKSB7XG4gICAgICAgICAgZWZmZWN0aXZlQ2xhc3Nlcy5wdXNoKHByb3ApO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG4gIGNvbnN0IGNsYXNzTmFtZSA9IGVmZmVjdGl2ZUNsYXNzZXMuam9pbihcIiBcIik7XG4gIGVmZmVjdGl2ZUNsYXNzZXMubGVuZ3RoID0gMDtcbiAgcmV0dXJuIGNsYXNzTmFtZTtcbn1cblxuLy8gc3JjL3RleHQudHNcbnZhciBrZWJhYlRvUGFzY2FsID0gKG5hbWUpID0+IG5hbWUuc3BsaXQoXCItXCIpLm1hcCgocGFydCkgPT4gKHBhcnRbMF0/LnRvTG9jYWxlVXBwZXJDYXNlKCkgPz8gXCJcIikgKyBwYXJ0LnNsaWNlKDEpKS5qb2luKFwiXCIpO1xudmFyIGNhcGl0YWxpemUgPSAoc3RyaW5nKSA9PiBzdHJpbmcuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBzdHJpbmcuc2xpY2UoMSk7XG52YXIgY2FtZWxUb0h1bWFuID0gKHZhbHVlKSA9PiBjYXBpdGFsaXplKHZhbHVlLnJlcGxhY2VBbGwoLyhbYS16XSkoW0EtWl0pL2d1LCBcIiQxICQyXCIpKTtcbm5ldyBQcm94eShcbiAge30sXG4gIHtcbiAgICBnZXQ6IChfdGFyZ2V0LCBwcm9wZXJ0eSkgPT4gY2FtZWxUb0h1bWFuKHByb3BlcnR5LnRvU3RyaW5nKCkpXG4gIH1cbik7XG5cbmV4cG9ydCB7IGNsYXNzZXMgYXMgYywga2ViYWJUb1Bhc2NhbCBhcyBrIH07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=