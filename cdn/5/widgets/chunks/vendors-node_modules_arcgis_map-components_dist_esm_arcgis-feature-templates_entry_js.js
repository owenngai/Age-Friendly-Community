"use strict";
(self["webpackChunkexb_client"] = self["webpackChunkexb_client"] || []).push([["vendors-node_modules_arcgis_map-components_dist_esm_arcgis-feature-templates_entry_js"],{

/***/ "./node_modules/@arcgis/map-components/dist/esm/arcgis-feature-templates.entry.js":
/*!****************************************************************************************!*\
  !*** ./node_modules/@arcgis/map-components/dist/esm/arcgis-feature-templates.entry.js ***!
  \****************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   arcgis_feature_templates: () => (/* binding */ ArcgisFeatureTemplates)
/* harmony export */ });
/* harmony import */ var _index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-6e172aac.js */ "./node_modules/@arcgis/map-components/dist/esm/index-6e172aac.js");
/* harmony import */ var _index_0bc55ca5_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./index-0bc55ca5.js */ "./node_modules/@arcgis/map-components/dist/esm/index-0bc55ca5.js");
/* harmony import */ var _component_utils_23194f7c_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./component-utils-23194f7c.js */ "./node_modules/@arcgis/map-components/dist/esm/component-utils-23194f7c.js");
/* harmony import */ var _disconnected_6cf1c100_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./disconnected-6cf1c100.js */ "./node_modules/@arcgis/map-components/dist/esm/disconnected-6cf1c100.js");
/*!
 * All material copyright Esri, All Rights Reserved, unless otherwise specified.
 * See https://js.arcgis.com/4.30/esri/copyright.txt for details.
 * v4.30.0-next.37
 */





const featureTemplatesCss = "";

const ArcgisFeatureTemplates = class {
    constructor(hostRef) {
        (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);
        this.widgetReady = (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "widgetReady", 7);
        this.featureTemplatesSelect = (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "featureTemplatesSelect", 7);
        this._watchHandles = [];
        this.referenceElement = undefined;
        this.position = "bottom-left";
        this.expandable = false;
        this.widget = undefined;
        this.enableListScroll = undefined;
        this.filterFunction = undefined;
        this.filterText = undefined;
        this.groupBy = undefined;
        this.layers = undefined;
        this.selectionMode = undefined;
        this.visibleElements = undefined;
    }
    enableListScrolWatcher(newValue) {
        if (newValue !== undefined && this.widget) {
            this.widget.enableListScroll = newValue;
        }
    }
    filterFunctionWatcher(newValue) {
        if (this.widget) {
            this.widget.filterFunction = newValue;
        }
    }
    filterTextWatcher(newValue) {
        if (this.widget) {
            this.widget.filterText = newValue;
        }
    }
    groupByWatcher(newValue) {
        if (this.widget) {
            this.widget.groupBy = newValue;
        }
    }
    layersWatcher(newValue) {
        if (this.widget) {
            this.widget.layers = newValue;
        }
    }
    selectionModeWatcher(newValue) {
        if (this.widget) {
            this.widget.selectionMode = newValue;
        }
    }
    visibleElementsWatcher(newValue) {
        if (this.widget) {
            this.widget.visibleElements = newValue;
        }
    }
    //--------------------------------------------------------------------------
    //
    //  Lifecycle
    //
    //--------------------------------------------------------------------------
    async componentDidLoad() {
        const params = this._createParams();
        const widget = await (0,_index_0bc55ca5_js__WEBPACK_IMPORTED_MODULE_1__.B)(params);
        this.widget = widget;
        this._proxyEvents();
        this.widgetReady.emit({ widget: this.widget });
        (0,_component_utils_23194f7c_js__WEBPACK_IMPORTED_MODULE_2__.c)(this);
    }
    disconnectedCallback() {
        (0,_disconnected_6cf1c100_js__WEBPACK_IMPORTED_MODULE_3__.o)(this);
    }
    render() {
        if (this.expandable) {
            return ((0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-expand", { position: this.position, ref: (el) => (this.expandElem = el) }, (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { ref: (el) => (this.childElem = el) })));
        }
        return (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { ref: (el) => (this.childElem = el) });
    }
    //--------------------------------------------------------------------------
    //
    //  Private Methods
    //
    //--------------------------------------------------------------------------
    _createParams() {
        const params = {
            container: this.childElem,
        };
        if (this.enableListScroll !== undefined) {
            params.enableListScroll = this.enableListScroll;
        }
        if (this.filterFunction) {
            params.filterFunction = this.filterFunction;
        }
        if (this.filterText) {
            params.filterText = this.filterText;
        }
        if (this.groupBy) {
            params.groupBy = this.groupBy;
        }
        if (this.layers) {
            params.layers = this.layers;
        }
        if (this.selectionMode !== undefined) {
            params.selectionMode = this.selectionMode;
        }
        if (this.visibleElements) {
            params.visibleElements = this.visibleElements;
        }
        return params;
    }
    _proxyEvents() {
        this.widget.on("select", (e) => this.featureTemplatesSelect.emit(e));
    }
    get el() { return (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.g)(this); }
    static get watchers() { return {
        "enableListScroll": ["enableListScrolWatcher"],
        "filterFunction": ["filterFunctionWatcher"],
        "filterText": ["filterTextWatcher"],
        "groupBy": ["groupByWatcher"],
        "layers": ["layersWatcher"],
        "selectionMode": ["selectionModeWatcher"],
        "visibleElements": ["visibleElementsWatcher"]
    }; }
};
ArcgisFeatureTemplates.style = featureTemplatesCss;




/***/ }),

/***/ "./node_modules/@arcgis/map-components/dist/esm/component-utils-23194f7c.js":
/*!**********************************************************************************!*\
  !*** ./node_modules/@arcgis/map-components/dist/esm/component-utils-23194f7c.js ***!
  \**********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   a: () => (/* binding */ addHandles),
/* harmony export */   b: () => (/* binding */ isNotSameViewpoint),
/* harmony export */   c: () => (/* binding */ checkForView),
/* harmony export */   d: () => (/* binding */ checkForExpand),
/* harmony export */   e: () => (/* binding */ isNotSameCamera),
/* harmony export */   f: () => (/* binding */ isNotSameEnvironment),
/* harmony export */   g: () => (/* binding */ isValidInteger),
/* harmony export */   i: () => (/* binding */ isNullOrEmptyString),
/* harmony export */   r: () => (/* binding */ referenceElementHelper)
/* harmony export */ });
/*!
 * All material copyright Esri, All Rights Reserved, unless otherwise specified.
 * See https://js.arcgis.com/4.30/esri/copyright.txt for details.
 * v4.30.0-next.37
 */
function checkForExpand(element) {
    const expandRef = element.el.closest("arcgis-expand") ?? element.expandElem;
    if (expandRef?.widget) {
        element.view = expandRef.view;
        expandRef.widget.content = element.childElem ?? element.el;
        // TODO: Update to be expandIcon = widget.icon, not ready yet in 4.27next
        if (!expandRef.expandIcon) {
            expandRef.widget.expandIcon = element.widget ? element.widget.icon : element?.icon;
        }
        return true;
    }
    if (expandRef) {
        const widgetHandler = () => {
            expandRef.removeEventListener("arcgisExpandReady", widgetHandler, false);
            element.view = expandRef.view;
            expandRef.widget.content = element.childElem ?? element.el;
            if (!expandRef.expandIcon) {
                expandRef.widget.expandIcon = element.widget ? element.widget.icon : element?.icon;
            }
        };
        expandRef.addEventListener("arcgisExpandReady", widgetHandler, false);
        return true;
    }
    return false;
}

//--------------------------------------------------------------------------
//
//  Public Methods
//
//--------------------------------------------------------------------------
function addHandles(element, handle) {
    if (Array.isArray(handle)) {
        element._watchHandles = [...element._watchHandles, ...handle];
    }
    else {
        element._watchHandles.push(handle);
    }
}
function checkForView(element) {
    let isUsingReferenceElement = false;
    if (!checkForExpand(element)) {
        let viewRef = element.el.closest("arcgis-map") ?? element.el.closest("arcgis-scene");
        if (!viewRef && typeof element.referenceElement === "string") {
            viewRef = document.querySelector(element.referenceElement);
            isUsingReferenceElement = true;
        }
        if (viewRef?.view) {
            element.view = viewRef.view;
            const el = element.childElem ?? element.el;
            if (!isUsingReferenceElement) {
                element.view.ui.add(el, element.position);
            }
        }
        else if (viewRef) {
            waitForViewHandler(viewRef, element, isUsingReferenceElement);
        }
    }
    else {
        const viewRef = element.el.closest("arcgis-map") ?? element.el.closest("arcgis-scene");
        if (viewRef?.view) {
            element.view = viewRef.view;
        }
        else if (viewRef) {
            const handler = () => {
                viewRef.removeEventListener("arcgisViewReadyChange", handler, false);
                element.view = viewRef.view;
            };
            viewRef.addEventListener("arcgisViewReadyChange", handler, false);
        }
    }
}
function isNullOrEmptyString(value) {
    return value === undefined || value === null || value === "";
}
function isValidInteger(value) {
    return value != null && value % 1 === 0;
}
function isNotSameCamera(camera, camera2) {
    return (camera2 === undefined ||
        camera.position !== camera2.position ||
        camera.heading !== camera2.heading ||
        camera.tilt !== camera2.tilt);
}
function isNotSameEnvironment(environment, environment2) {
    return (environment2 === undefined ||
        environment2.atmosphereEnabled !== environment.atmosphereEnabled ||
        environment2.lighting.date !== environment.lighting.date ||
        environment2.lighting.directShadowsEnabled !==
            environment.lighting.directShadowsEnabled ||
        environment2.lighting.cameraTrackingEnabled !==
            environment.lighting.cameraTrackingEnabled ||
        environment2.lighting.date !== environment.lighting.date ||
        environment2.lighting.displayUTCOffset !==
            environment.lighting.displayUTCOffset);
}
function isNotSameViewpoint(viewpoint, viewpoint2) {
    return (viewpoint2 === undefined ||
        viewpoint.targetGeometry !== viewpoint2.targetGeometry ||
        viewpoint.rotation !== viewpoint2.rotation ||
        viewpoint.scale !== viewpoint2.scale);
}
async function updateForView(viewStr) {
    const viewRef = document.querySelector(viewStr);
    return await new Promise((resolve) => {
        if (viewRef?.view !== undefined) {
            resolve(viewRef.view);
        }
        else if (viewRef) {
            const handler = () => {
                viewRef.removeEventListener("arcgisViewReadyChange", handler, false);
                resolve(viewRef.view);
            };
            viewRef.addEventListener("arcgisViewReadyChange", handler, false);
        }
    });
}
async function referenceElementHelper(element, refElement) {
    if (refElement === undefined)
        return;
    else if (typeof refElement === "string") {
        element.view = await updateForView(refElement);
    }
    else if (element.widget) {
        element.view = refElement.view;
    }
}
//--------------------------------------------------------------------------
//
//  Private Methods
//
//--------------------------------------------------------------------------
function waitForViewHandler(viewRef, element, isUsingRefernceElement) {
    const handler = () => {
        viewRef.removeEventListener("arcgisViewReadyChange", handler, false);
        element.view = viewRef.view;
        if (!isUsingRefernceElement) {
            element.view.ui.add(element.childElem ?? element.el, element.position);
        }
    };
    viewRef.addEventListener("arcgisViewReadyChange", handler, false);
}




/***/ }),

/***/ "./node_modules/@arcgis/map-components/dist/esm/disconnected-6cf1c100.js":
/*!*******************************************************************************!*\
  !*** ./node_modules/@arcgis/map-components/dist/esm/disconnected-6cf1c100.js ***!
  \*******************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   o: () => (/* binding */ onDisconnectedHelper)
/* harmony export */ });
/*!
 * All material copyright Esri, All Rights Reserved, unless otherwise specified.
 * See https://js.arcgis.com/4.30/esri/copyright.txt for details.
 * v4.30.0-next.37
 */
function onDisconnectedHelper(element) {
    if (element.childElem) {
        if (!element.el.isConnected) {
            if (element.view) {
                element.view.ui.remove(element.childElem);
            }
            else if (element.widget?.view) {
                element.widget.view.ui.remove(element.childElem);
            }
            if (element._watchHandles) {
                element._watchHandles.forEach((handle) => {
                    handle.remove();
                });
            }
            element._watchHandles = [];
            element.widget?.destroy();
        }
    }
    else {
        setTimeout(() => {
            if (!element.el.isConnected) {
                if (element.view) {
                    element.view.ui.remove(element.el);
                }
                else if (element.widget?.view) {
                    element.widget.view.ui.remove(element.el);
                }
                if (element._watchHandles) {
                    element._watchHandles.forEach((handle) => {
                        handle.remove();
                    });
                }
                element._watchHandles = [];
                element.widget?.destroy();
            }
        }, 1000);
    }
}




/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2lkZ2V0cy9jaHVua3MvdmVuZG9ycy1ub2RlX21vZHVsZXNfYXJjZ2lzX21hcC1jb21wb25lbnRzX2Rpc3RfZXNtX2FyY2dpcy1mZWF0dXJlLXRlbXBsYXRlc19lbnRyeV9qcy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDa0c7QUFDNUI7QUFDSjtBQUNLOztBQUV2RTs7QUFFQTtBQUNBO0FBQ0EsUUFBUSxxREFBZ0I7QUFDeEIsMkJBQTJCLHFEQUFXO0FBQ3RDLHNDQUFzQyxxREFBVztBQUNqRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QixxREFBMEI7QUFDdkQ7QUFDQTtBQUNBLGdDQUFnQyxxQkFBcUI7QUFDckQsUUFBUSwrREFBWTtBQUNwQjtBQUNBO0FBQ0EsUUFBUSw0REFBb0I7QUFDNUI7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLHFEQUFDLG9CQUFvQiw4REFBOEQsRUFBRSxxREFBQyxVQUFVLG9DQUFvQztBQUN4SjtBQUNBLGVBQWUscURBQUMsVUFBVSxvQ0FBb0M7QUFDOUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxPQUFPLHFEQUFVO0FBQ2hDLDRCQUE0QjtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFOEQ7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDdkk5RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUV5Tjs7Ozs7Ozs7Ozs7Ozs7O0FDcEp6TjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTs7QUFFcUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vbm9kZV9tb2R1bGVzL0BhcmNnaXMvbWFwLWNvbXBvbmVudHMvZGlzdC9lc20vYXJjZ2lzLWZlYXR1cmUtdGVtcGxhdGVzLmVudHJ5LmpzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9ub2RlX21vZHVsZXMvQGFyY2dpcy9tYXAtY29tcG9uZW50cy9kaXN0L2VzbS9jb21wb25lbnQtdXRpbHMtMjMxOTRmN2MuanMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL25vZGVfbW9kdWxlcy9AYXJjZ2lzL21hcC1jb21wb25lbnRzL2Rpc3QvZXNtL2Rpc2Nvbm5lY3RlZC02Y2YxYzEwMC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiFcbiAqIEFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRXNyaSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG4gKiBTZWUgaHR0cHM6Ly9qcy5hcmNnaXMuY29tLzQuMzAvZXNyaS9jb3B5cmlnaHQudHh0IGZvciBkZXRhaWxzLlxuICogdjQuMzAuMC1uZXh0LjM3XG4gKi9cbmltcG9ydCB7IHIgYXMgcmVnaXN0ZXJJbnN0YW5jZSwgYyBhcyBjcmVhdGVFdmVudCwgaCwgZyBhcyBnZXRFbGVtZW50IH0gZnJvbSAnLi9pbmRleC02ZTE3MmFhYy5qcyc7XG5pbXBvcnQgeyBCIGFzIG5ld1dpZGdldHNGZWF0dXJlVGVtcGxhdGVzIH0gZnJvbSAnLi9pbmRleC0wYmM1NWNhNS5qcyc7XG5pbXBvcnQgeyBjIGFzIGNoZWNrRm9yVmlldyB9IGZyb20gJy4vY29tcG9uZW50LXV0aWxzLTIzMTk0ZjdjLmpzJztcbmltcG9ydCB7IG8gYXMgb25EaXNjb25uZWN0ZWRIZWxwZXIgfSBmcm9tICcuL2Rpc2Nvbm5lY3RlZC02Y2YxYzEwMC5qcyc7XG5cbmNvbnN0IGZlYXR1cmVUZW1wbGF0ZXNDc3MgPSBcIlwiO1xuXG5jb25zdCBBcmNnaXNGZWF0dXJlVGVtcGxhdGVzID0gY2xhc3Mge1xuICAgIGNvbnN0cnVjdG9yKGhvc3RSZWYpIHtcbiAgICAgICAgcmVnaXN0ZXJJbnN0YW5jZSh0aGlzLCBob3N0UmVmKTtcbiAgICAgICAgdGhpcy53aWRnZXRSZWFkeSA9IGNyZWF0ZUV2ZW50KHRoaXMsIFwid2lkZ2V0UmVhZHlcIiwgNyk7XG4gICAgICAgIHRoaXMuZmVhdHVyZVRlbXBsYXRlc1NlbGVjdCA9IGNyZWF0ZUV2ZW50KHRoaXMsIFwiZmVhdHVyZVRlbXBsYXRlc1NlbGVjdFwiLCA3KTtcbiAgICAgICAgdGhpcy5fd2F0Y2hIYW5kbGVzID0gW107XG4gICAgICAgIHRoaXMucmVmZXJlbmNlRWxlbWVudCA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5wb3NpdGlvbiA9IFwiYm90dG9tLWxlZnRcIjtcbiAgICAgICAgdGhpcy5leHBhbmRhYmxlID0gZmFsc2U7XG4gICAgICAgIHRoaXMud2lkZ2V0ID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLmVuYWJsZUxpc3RTY3JvbGwgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuZmlsdGVyRnVuY3Rpb24gPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuZmlsdGVyVGV4dCA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5ncm91cEJ5ID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLmxheWVycyA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5zZWxlY3Rpb25Nb2RlID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLnZpc2libGVFbGVtZW50cyA9IHVuZGVmaW5lZDtcbiAgICB9XG4gICAgZW5hYmxlTGlzdFNjcm9sV2F0Y2hlcihuZXdWYWx1ZSkge1xuICAgICAgICBpZiAobmV3VmFsdWUgIT09IHVuZGVmaW5lZCAmJiB0aGlzLndpZGdldCkge1xuICAgICAgICAgICAgdGhpcy53aWRnZXQuZW5hYmxlTGlzdFNjcm9sbCA9IG5ld1ZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGZpbHRlckZ1bmN0aW9uV2F0Y2hlcihuZXdWYWx1ZSkge1xuICAgICAgICBpZiAodGhpcy53aWRnZXQpIHtcbiAgICAgICAgICAgIHRoaXMud2lkZ2V0LmZpbHRlckZ1bmN0aW9uID0gbmV3VmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZmlsdGVyVGV4dFdhdGNoZXIobmV3VmFsdWUpIHtcbiAgICAgICAgaWYgKHRoaXMud2lkZ2V0KSB7XG4gICAgICAgICAgICB0aGlzLndpZGdldC5maWx0ZXJUZXh0ID0gbmV3VmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ3JvdXBCeVdhdGNoZXIobmV3VmFsdWUpIHtcbiAgICAgICAgaWYgKHRoaXMud2lkZ2V0KSB7XG4gICAgICAgICAgICB0aGlzLndpZGdldC5ncm91cEJ5ID0gbmV3VmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgbGF5ZXJzV2F0Y2hlcihuZXdWYWx1ZSkge1xuICAgICAgICBpZiAodGhpcy53aWRnZXQpIHtcbiAgICAgICAgICAgIHRoaXMud2lkZ2V0LmxheWVycyA9IG5ld1ZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHNlbGVjdGlvbk1vZGVXYXRjaGVyKG5ld1ZhbHVlKSB7XG4gICAgICAgIGlmICh0aGlzLndpZGdldCkge1xuICAgICAgICAgICAgdGhpcy53aWRnZXQuc2VsZWN0aW9uTW9kZSA9IG5ld1ZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHZpc2libGVFbGVtZW50c1dhdGNoZXIobmV3VmFsdWUpIHtcbiAgICAgICAgaWYgKHRoaXMud2lkZ2V0KSB7XG4gICAgICAgICAgICB0aGlzLndpZGdldC52aXNpYmxlRWxlbWVudHMgPSBuZXdWYWx1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy9cbiAgICAvLyAgTGlmZWN5Y2xlXG4gICAgLy9cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgYXN5bmMgY29tcG9uZW50RGlkTG9hZCgpIHtcbiAgICAgICAgY29uc3QgcGFyYW1zID0gdGhpcy5fY3JlYXRlUGFyYW1zKCk7XG4gICAgICAgIGNvbnN0IHdpZGdldCA9IGF3YWl0IG5ld1dpZGdldHNGZWF0dXJlVGVtcGxhdGVzKHBhcmFtcyk7XG4gICAgICAgIHRoaXMud2lkZ2V0ID0gd2lkZ2V0O1xuICAgICAgICB0aGlzLl9wcm94eUV2ZW50cygpO1xuICAgICAgICB0aGlzLndpZGdldFJlYWR5LmVtaXQoeyB3aWRnZXQ6IHRoaXMud2lkZ2V0IH0pO1xuICAgICAgICBjaGVja0ZvclZpZXcodGhpcyk7XG4gICAgfVxuICAgIGRpc2Nvbm5lY3RlZENhbGxiYWNrKCkge1xuICAgICAgICBvbkRpc2Nvbm5lY3RlZEhlbHBlcih0aGlzKTtcbiAgICB9XG4gICAgcmVuZGVyKCkge1xuICAgICAgICBpZiAodGhpcy5leHBhbmRhYmxlKSB7XG4gICAgICAgICAgICByZXR1cm4gKGgoXCJhcmNnaXMtZXhwYW5kXCIsIHsgcG9zaXRpb246IHRoaXMucG9zaXRpb24sIHJlZjogKGVsKSA9PiAodGhpcy5leHBhbmRFbGVtID0gZWwpIH0sIGgoXCJkaXZcIiwgeyByZWY6IChlbCkgPT4gKHRoaXMuY2hpbGRFbGVtID0gZWwpIH0pKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGgoXCJkaXZcIiwgeyByZWY6IChlbCkgPT4gKHRoaXMuY2hpbGRFbGVtID0gZWwpIH0pO1xuICAgIH1cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy9cbiAgICAvLyAgUHJpdmF0ZSBNZXRob2RzXG4gICAgLy9cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgX2NyZWF0ZVBhcmFtcygpIHtcbiAgICAgICAgY29uc3QgcGFyYW1zID0ge1xuICAgICAgICAgICAgY29udGFpbmVyOiB0aGlzLmNoaWxkRWxlbSxcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKHRoaXMuZW5hYmxlTGlzdFNjcm9sbCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBwYXJhbXMuZW5hYmxlTGlzdFNjcm9sbCA9IHRoaXMuZW5hYmxlTGlzdFNjcm9sbDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5maWx0ZXJGdW5jdGlvbikge1xuICAgICAgICAgICAgcGFyYW1zLmZpbHRlckZ1bmN0aW9uID0gdGhpcy5maWx0ZXJGdW5jdGlvbjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5maWx0ZXJUZXh0KSB7XG4gICAgICAgICAgICBwYXJhbXMuZmlsdGVyVGV4dCA9IHRoaXMuZmlsdGVyVGV4dDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5ncm91cEJ5KSB7XG4gICAgICAgICAgICBwYXJhbXMuZ3JvdXBCeSA9IHRoaXMuZ3JvdXBCeTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5sYXllcnMpIHtcbiAgICAgICAgICAgIHBhcmFtcy5sYXllcnMgPSB0aGlzLmxheWVycztcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5zZWxlY3Rpb25Nb2RlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHBhcmFtcy5zZWxlY3Rpb25Nb2RlID0gdGhpcy5zZWxlY3Rpb25Nb2RlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnZpc2libGVFbGVtZW50cykge1xuICAgICAgICAgICAgcGFyYW1zLnZpc2libGVFbGVtZW50cyA9IHRoaXMudmlzaWJsZUVsZW1lbnRzO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwYXJhbXM7XG4gICAgfVxuICAgIF9wcm94eUV2ZW50cygpIHtcbiAgICAgICAgdGhpcy53aWRnZXQub24oXCJzZWxlY3RcIiwgKGUpID0+IHRoaXMuZmVhdHVyZVRlbXBsYXRlc1NlbGVjdC5lbWl0KGUpKTtcbiAgICB9XG4gICAgZ2V0IGVsKCkgeyByZXR1cm4gZ2V0RWxlbWVudCh0aGlzKTsgfVxuICAgIHN0YXRpYyBnZXQgd2F0Y2hlcnMoKSB7IHJldHVybiB7XG4gICAgICAgIFwiZW5hYmxlTGlzdFNjcm9sbFwiOiBbXCJlbmFibGVMaXN0U2Nyb2xXYXRjaGVyXCJdLFxuICAgICAgICBcImZpbHRlckZ1bmN0aW9uXCI6IFtcImZpbHRlckZ1bmN0aW9uV2F0Y2hlclwiXSxcbiAgICAgICAgXCJmaWx0ZXJUZXh0XCI6IFtcImZpbHRlclRleHRXYXRjaGVyXCJdLFxuICAgICAgICBcImdyb3VwQnlcIjogW1wiZ3JvdXBCeVdhdGNoZXJcIl0sXG4gICAgICAgIFwibGF5ZXJzXCI6IFtcImxheWVyc1dhdGNoZXJcIl0sXG4gICAgICAgIFwic2VsZWN0aW9uTW9kZVwiOiBbXCJzZWxlY3Rpb25Nb2RlV2F0Y2hlclwiXSxcbiAgICAgICAgXCJ2aXNpYmxlRWxlbWVudHNcIjogW1widmlzaWJsZUVsZW1lbnRzV2F0Y2hlclwiXVxuICAgIH07IH1cbn07XG5BcmNnaXNGZWF0dXJlVGVtcGxhdGVzLnN0eWxlID0gZmVhdHVyZVRlbXBsYXRlc0NzcztcblxuZXhwb3J0IHsgQXJjZ2lzRmVhdHVyZVRlbXBsYXRlcyBhcyBhcmNnaXNfZmVhdHVyZV90ZW1wbGF0ZXMgfTtcbiIsIi8qIVxuICogQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFc3JpLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAqIFNlZSBodHRwczovL2pzLmFyY2dpcy5jb20vNC4zMC9lc3JpL2NvcHlyaWdodC50eHQgZm9yIGRldGFpbHMuXG4gKiB2NC4zMC4wLW5leHQuMzdcbiAqL1xuZnVuY3Rpb24gY2hlY2tGb3JFeHBhbmQoZWxlbWVudCkge1xuICAgIGNvbnN0IGV4cGFuZFJlZiA9IGVsZW1lbnQuZWwuY2xvc2VzdChcImFyY2dpcy1leHBhbmRcIikgPz8gZWxlbWVudC5leHBhbmRFbGVtO1xuICAgIGlmIChleHBhbmRSZWY/LndpZGdldCkge1xuICAgICAgICBlbGVtZW50LnZpZXcgPSBleHBhbmRSZWYudmlldztcbiAgICAgICAgZXhwYW5kUmVmLndpZGdldC5jb250ZW50ID0gZWxlbWVudC5jaGlsZEVsZW0gPz8gZWxlbWVudC5lbDtcbiAgICAgICAgLy8gVE9ETzogVXBkYXRlIHRvIGJlIGV4cGFuZEljb24gPSB3aWRnZXQuaWNvbiwgbm90IHJlYWR5IHlldCBpbiA0LjI3bmV4dFxuICAgICAgICBpZiAoIWV4cGFuZFJlZi5leHBhbmRJY29uKSB7XG4gICAgICAgICAgICBleHBhbmRSZWYud2lkZ2V0LmV4cGFuZEljb24gPSBlbGVtZW50LndpZGdldCA/IGVsZW1lbnQud2lkZ2V0Lmljb24gOiBlbGVtZW50Py5pY29uO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICBpZiAoZXhwYW5kUmVmKSB7XG4gICAgICAgIGNvbnN0IHdpZGdldEhhbmRsZXIgPSAoKSA9PiB7XG4gICAgICAgICAgICBleHBhbmRSZWYucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImFyY2dpc0V4cGFuZFJlYWR5XCIsIHdpZGdldEhhbmRsZXIsIGZhbHNlKTtcbiAgICAgICAgICAgIGVsZW1lbnQudmlldyA9IGV4cGFuZFJlZi52aWV3O1xuICAgICAgICAgICAgZXhwYW5kUmVmLndpZGdldC5jb250ZW50ID0gZWxlbWVudC5jaGlsZEVsZW0gPz8gZWxlbWVudC5lbDtcbiAgICAgICAgICAgIGlmICghZXhwYW5kUmVmLmV4cGFuZEljb24pIHtcbiAgICAgICAgICAgICAgICBleHBhbmRSZWYud2lkZ2V0LmV4cGFuZEljb24gPSBlbGVtZW50LndpZGdldCA/IGVsZW1lbnQud2lkZ2V0Lmljb24gOiBlbGVtZW50Py5pY29uO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBleHBhbmRSZWYuYWRkRXZlbnRMaXN0ZW5lcihcImFyY2dpc0V4cGFuZFJlYWR5XCIsIHdpZGdldEhhbmRsZXIsIGZhbHNlKTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbn1cblxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy9cbi8vICBQdWJsaWMgTWV0aG9kc1xuLy9cbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbmZ1bmN0aW9uIGFkZEhhbmRsZXMoZWxlbWVudCwgaGFuZGxlKSB7XG4gICAgaWYgKEFycmF5LmlzQXJyYXkoaGFuZGxlKSkge1xuICAgICAgICBlbGVtZW50Ll93YXRjaEhhbmRsZXMgPSBbLi4uZWxlbWVudC5fd2F0Y2hIYW5kbGVzLCAuLi5oYW5kbGVdO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgZWxlbWVudC5fd2F0Y2hIYW5kbGVzLnB1c2goaGFuZGxlKTtcbiAgICB9XG59XG5mdW5jdGlvbiBjaGVja0ZvclZpZXcoZWxlbWVudCkge1xuICAgIGxldCBpc1VzaW5nUmVmZXJlbmNlRWxlbWVudCA9IGZhbHNlO1xuICAgIGlmICghY2hlY2tGb3JFeHBhbmQoZWxlbWVudCkpIHtcbiAgICAgICAgbGV0IHZpZXdSZWYgPSBlbGVtZW50LmVsLmNsb3Nlc3QoXCJhcmNnaXMtbWFwXCIpID8/IGVsZW1lbnQuZWwuY2xvc2VzdChcImFyY2dpcy1zY2VuZVwiKTtcbiAgICAgICAgaWYgKCF2aWV3UmVmICYmIHR5cGVvZiBlbGVtZW50LnJlZmVyZW5jZUVsZW1lbnQgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgIHZpZXdSZWYgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGVsZW1lbnQucmVmZXJlbmNlRWxlbWVudCk7XG4gICAgICAgICAgICBpc1VzaW5nUmVmZXJlbmNlRWxlbWVudCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHZpZXdSZWY/LnZpZXcpIHtcbiAgICAgICAgICAgIGVsZW1lbnQudmlldyA9IHZpZXdSZWYudmlldztcbiAgICAgICAgICAgIGNvbnN0IGVsID0gZWxlbWVudC5jaGlsZEVsZW0gPz8gZWxlbWVudC5lbDtcbiAgICAgICAgICAgIGlmICghaXNVc2luZ1JlZmVyZW5jZUVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICBlbGVtZW50LnZpZXcudWkuYWRkKGVsLCBlbGVtZW50LnBvc2l0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh2aWV3UmVmKSB7XG4gICAgICAgICAgICB3YWl0Rm9yVmlld0hhbmRsZXIodmlld1JlZiwgZWxlbWVudCwgaXNVc2luZ1JlZmVyZW5jZUVsZW1lbnQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBjb25zdCB2aWV3UmVmID0gZWxlbWVudC5lbC5jbG9zZXN0KFwiYXJjZ2lzLW1hcFwiKSA/PyBlbGVtZW50LmVsLmNsb3Nlc3QoXCJhcmNnaXMtc2NlbmVcIik7XG4gICAgICAgIGlmICh2aWV3UmVmPy52aWV3KSB7XG4gICAgICAgICAgICBlbGVtZW50LnZpZXcgPSB2aWV3UmVmLnZpZXc7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodmlld1JlZikge1xuICAgICAgICAgICAgY29uc3QgaGFuZGxlciA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICB2aWV3UmVmLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJhcmNnaXNWaWV3UmVhZHlDaGFuZ2VcIiwgaGFuZGxlciwgZmFsc2UpO1xuICAgICAgICAgICAgICAgIGVsZW1lbnQudmlldyA9IHZpZXdSZWYudmlldztcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2aWV3UmVmLmFkZEV2ZW50TGlzdGVuZXIoXCJhcmNnaXNWaWV3UmVhZHlDaGFuZ2VcIiwgaGFuZGxlciwgZmFsc2UpO1xuICAgICAgICB9XG4gICAgfVxufVxuZnVuY3Rpb24gaXNOdWxsT3JFbXB0eVN0cmluZyh2YWx1ZSkge1xuICAgIHJldHVybiB2YWx1ZSA9PT0gdW5kZWZpbmVkIHx8IHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSBcIlwiO1xufVxuZnVuY3Rpb24gaXNWYWxpZEludGVnZXIodmFsdWUpIHtcbiAgICByZXR1cm4gdmFsdWUgIT0gbnVsbCAmJiB2YWx1ZSAlIDEgPT09IDA7XG59XG5mdW5jdGlvbiBpc05vdFNhbWVDYW1lcmEoY2FtZXJhLCBjYW1lcmEyKSB7XG4gICAgcmV0dXJuIChjYW1lcmEyID09PSB1bmRlZmluZWQgfHxcbiAgICAgICAgY2FtZXJhLnBvc2l0aW9uICE9PSBjYW1lcmEyLnBvc2l0aW9uIHx8XG4gICAgICAgIGNhbWVyYS5oZWFkaW5nICE9PSBjYW1lcmEyLmhlYWRpbmcgfHxcbiAgICAgICAgY2FtZXJhLnRpbHQgIT09IGNhbWVyYTIudGlsdCk7XG59XG5mdW5jdGlvbiBpc05vdFNhbWVFbnZpcm9ubWVudChlbnZpcm9ubWVudCwgZW52aXJvbm1lbnQyKSB7XG4gICAgcmV0dXJuIChlbnZpcm9ubWVudDIgPT09IHVuZGVmaW5lZCB8fFxuICAgICAgICBlbnZpcm9ubWVudDIuYXRtb3NwaGVyZUVuYWJsZWQgIT09IGVudmlyb25tZW50LmF0bW9zcGhlcmVFbmFibGVkIHx8XG4gICAgICAgIGVudmlyb25tZW50Mi5saWdodGluZy5kYXRlICE9PSBlbnZpcm9ubWVudC5saWdodGluZy5kYXRlIHx8XG4gICAgICAgIGVudmlyb25tZW50Mi5saWdodGluZy5kaXJlY3RTaGFkb3dzRW5hYmxlZCAhPT1cbiAgICAgICAgICAgIGVudmlyb25tZW50LmxpZ2h0aW5nLmRpcmVjdFNoYWRvd3NFbmFibGVkIHx8XG4gICAgICAgIGVudmlyb25tZW50Mi5saWdodGluZy5jYW1lcmFUcmFja2luZ0VuYWJsZWQgIT09XG4gICAgICAgICAgICBlbnZpcm9ubWVudC5saWdodGluZy5jYW1lcmFUcmFja2luZ0VuYWJsZWQgfHxcbiAgICAgICAgZW52aXJvbm1lbnQyLmxpZ2h0aW5nLmRhdGUgIT09IGVudmlyb25tZW50LmxpZ2h0aW5nLmRhdGUgfHxcbiAgICAgICAgZW52aXJvbm1lbnQyLmxpZ2h0aW5nLmRpc3BsYXlVVENPZmZzZXQgIT09XG4gICAgICAgICAgICBlbnZpcm9ubWVudC5saWdodGluZy5kaXNwbGF5VVRDT2Zmc2V0KTtcbn1cbmZ1bmN0aW9uIGlzTm90U2FtZVZpZXdwb2ludCh2aWV3cG9pbnQsIHZpZXdwb2ludDIpIHtcbiAgICByZXR1cm4gKHZpZXdwb2ludDIgPT09IHVuZGVmaW5lZCB8fFxuICAgICAgICB2aWV3cG9pbnQudGFyZ2V0R2VvbWV0cnkgIT09IHZpZXdwb2ludDIudGFyZ2V0R2VvbWV0cnkgfHxcbiAgICAgICAgdmlld3BvaW50LnJvdGF0aW9uICE9PSB2aWV3cG9pbnQyLnJvdGF0aW9uIHx8XG4gICAgICAgIHZpZXdwb2ludC5zY2FsZSAhPT0gdmlld3BvaW50Mi5zY2FsZSk7XG59XG5hc3luYyBmdW5jdGlvbiB1cGRhdGVGb3JWaWV3KHZpZXdTdHIpIHtcbiAgICBjb25zdCB2aWV3UmVmID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih2aWV3U3RyKTtcbiAgICByZXR1cm4gYXdhaXQgbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcbiAgICAgICAgaWYgKHZpZXdSZWY/LnZpZXcgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmVzb2x2ZSh2aWV3UmVmLnZpZXcpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHZpZXdSZWYpIHtcbiAgICAgICAgICAgIGNvbnN0IGhhbmRsZXIgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdmlld1JlZi5yZW1vdmVFdmVudExpc3RlbmVyKFwiYXJjZ2lzVmlld1JlYWR5Q2hhbmdlXCIsIGhhbmRsZXIsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICByZXNvbHZlKHZpZXdSZWYudmlldyk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdmlld1JlZi5hZGRFdmVudExpc3RlbmVyKFwiYXJjZ2lzVmlld1JlYWR5Q2hhbmdlXCIsIGhhbmRsZXIsIGZhbHNlKTtcbiAgICAgICAgfVxuICAgIH0pO1xufVxuYXN5bmMgZnVuY3Rpb24gcmVmZXJlbmNlRWxlbWVudEhlbHBlcihlbGVtZW50LCByZWZFbGVtZW50KSB7XG4gICAgaWYgKHJlZkVsZW1lbnQgPT09IHVuZGVmaW5lZClcbiAgICAgICAgcmV0dXJuO1xuICAgIGVsc2UgaWYgKHR5cGVvZiByZWZFbGVtZW50ID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgIGVsZW1lbnQudmlldyA9IGF3YWl0IHVwZGF0ZUZvclZpZXcocmVmRWxlbWVudCk7XG4gICAgfVxuICAgIGVsc2UgaWYgKGVsZW1lbnQud2lkZ2V0KSB7XG4gICAgICAgIGVsZW1lbnQudmlldyA9IHJlZkVsZW1lbnQudmlldztcbiAgICB9XG59XG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vL1xuLy8gIFByaXZhdGUgTWV0aG9kc1xuLy9cbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbmZ1bmN0aW9uIHdhaXRGb3JWaWV3SGFuZGxlcih2aWV3UmVmLCBlbGVtZW50LCBpc1VzaW5nUmVmZXJuY2VFbGVtZW50KSB7XG4gICAgY29uc3QgaGFuZGxlciA9ICgpID0+IHtcbiAgICAgICAgdmlld1JlZi5yZW1vdmVFdmVudExpc3RlbmVyKFwiYXJjZ2lzVmlld1JlYWR5Q2hhbmdlXCIsIGhhbmRsZXIsIGZhbHNlKTtcbiAgICAgICAgZWxlbWVudC52aWV3ID0gdmlld1JlZi52aWV3O1xuICAgICAgICBpZiAoIWlzVXNpbmdSZWZlcm5jZUVsZW1lbnQpIHtcbiAgICAgICAgICAgIGVsZW1lbnQudmlldy51aS5hZGQoZWxlbWVudC5jaGlsZEVsZW0gPz8gZWxlbWVudC5lbCwgZWxlbWVudC5wb3NpdGlvbik7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHZpZXdSZWYuYWRkRXZlbnRMaXN0ZW5lcihcImFyY2dpc1ZpZXdSZWFkeUNoYW5nZVwiLCBoYW5kbGVyLCBmYWxzZSk7XG59XG5cbmV4cG9ydCB7IGFkZEhhbmRsZXMgYXMgYSwgaXNOb3RTYW1lVmlld3BvaW50IGFzIGIsIGNoZWNrRm9yVmlldyBhcyBjLCBjaGVja0ZvckV4cGFuZCBhcyBkLCBpc05vdFNhbWVDYW1lcmEgYXMgZSwgaXNOb3RTYW1lRW52aXJvbm1lbnQgYXMgZiwgaXNWYWxpZEludGVnZXIgYXMgZywgaXNOdWxsT3JFbXB0eVN0cmluZyBhcyBpLCByZWZlcmVuY2VFbGVtZW50SGVscGVyIGFzIHIgfTtcbiIsIi8qIVxuICogQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFc3JpLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAqIFNlZSBodHRwczovL2pzLmFyY2dpcy5jb20vNC4zMC9lc3JpL2NvcHlyaWdodC50eHQgZm9yIGRldGFpbHMuXG4gKiB2NC4zMC4wLW5leHQuMzdcbiAqL1xuZnVuY3Rpb24gb25EaXNjb25uZWN0ZWRIZWxwZXIoZWxlbWVudCkge1xuICAgIGlmIChlbGVtZW50LmNoaWxkRWxlbSkge1xuICAgICAgICBpZiAoIWVsZW1lbnQuZWwuaXNDb25uZWN0ZWQpIHtcbiAgICAgICAgICAgIGlmIChlbGVtZW50LnZpZXcpIHtcbiAgICAgICAgICAgICAgICBlbGVtZW50LnZpZXcudWkucmVtb3ZlKGVsZW1lbnQuY2hpbGRFbGVtKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGVsZW1lbnQud2lkZ2V0Py52aWV3KSB7XG4gICAgICAgICAgICAgICAgZWxlbWVudC53aWRnZXQudmlldy51aS5yZW1vdmUoZWxlbWVudC5jaGlsZEVsZW0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGVsZW1lbnQuX3dhdGNoSGFuZGxlcykge1xuICAgICAgICAgICAgICAgIGVsZW1lbnQuX3dhdGNoSGFuZGxlcy5mb3JFYWNoKChoYW5kbGUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxlbWVudC5fd2F0Y2hIYW5kbGVzID0gW107XG4gICAgICAgICAgICBlbGVtZW50LndpZGdldD8uZGVzdHJveSgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIGlmICghZWxlbWVudC5lbC5pc0Nvbm5lY3RlZCkge1xuICAgICAgICAgICAgICAgIGlmIChlbGVtZW50LnZpZXcpIHtcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC52aWV3LnVpLnJlbW92ZShlbGVtZW50LmVsKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoZWxlbWVudC53aWRnZXQ/LnZpZXcpIHtcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC53aWRnZXQudmlldy51aS5yZW1vdmUoZWxlbWVudC5lbCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChlbGVtZW50Ll93YXRjaEhhbmRsZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5fd2F0Y2hIYW5kbGVzLmZvckVhY2goKGhhbmRsZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxlbWVudC5fd2F0Y2hIYW5kbGVzID0gW107XG4gICAgICAgICAgICAgICAgZWxlbWVudC53aWRnZXQ/LmRlc3Ryb3koKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwgMTAwMCk7XG4gICAgfVxufVxuXG5leHBvcnQgeyBvbkRpc2Nvbm5lY3RlZEhlbHBlciBhcyBvIH07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=