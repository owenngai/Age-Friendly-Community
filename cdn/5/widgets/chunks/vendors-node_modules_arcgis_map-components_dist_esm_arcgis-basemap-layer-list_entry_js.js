"use strict";
(self["webpackChunkexb_client"] = self["webpackChunkexb_client"] || []).push([["vendors-node_modules_arcgis_map-components_dist_esm_arcgis-basemap-layer-list_entry_js"],{

/***/ "./node_modules/@arcgis/map-components/dist/esm/arcgis-basemap-layer-list.entry.js":
/*!*****************************************************************************************!*\
  !*** ./node_modules/@arcgis/map-components/dist/esm/arcgis-basemap-layer-list.entry.js ***!
  \*****************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   arcgis_basemap_layer_list: () => (/* binding */ ArcgisBasemapLayerList)
/* harmony export */ });
/* harmony import */ var _index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-6e172aac.js */ "./node_modules/@arcgis/map-components/dist/esm/index-6e172aac.js");
/* harmony import */ var _index_0bc55ca5_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./index-0bc55ca5.js */ "./node_modules/@arcgis/map-components/dist/esm/index-0bc55ca5.js");
/* harmony import */ var _component_utils_23194f7c_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./component-utils-23194f7c.js */ "./node_modules/@arcgis/map-components/dist/esm/component-utils-23194f7c.js");
/* harmony import */ var _disconnected_6cf1c100_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./disconnected-6cf1c100.js */ "./node_modules/@arcgis/map-components/dist/esm/disconnected-6cf1c100.js");
/*!
 * All material copyright Esri, All Rights Reserved, unless otherwise specified.
 * See https://js.arcgis.com/4.30/esri/copyright.txt for details.
 * v4.30.0-next.37
 */





const basemapLayerListCss = "";

const ArcgisBasemapLayerList = class {
    constructor(hostRef) {
        (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);
        this.arcgisBasemapLayerListReady = (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "arcgisBasemapLayerListReady", 7);
        this.basemapLayerListTriggerAction = (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "basemapLayerListTriggerAction", 7);
        this._watchHandles = [];
        this.referenceElement = undefined;
        this.baseFilterText = "";
        this.baseItems = undefined;
        this.baseListItemCreatedFunction = undefined;
        this.basemapTitle = undefined;
        this.collapsed = false;
        this.dragEnabled = false;
        this.editingTitle = false;
        this.filterPlaceholder = "";
        this.icon = undefined;
        this.minFilterItems = 10;
        this.referenceFilterText = "";
        this.referenceListItemCreatedFunction = undefined;
        this.selectedItems = undefined;
        this.selectionMode = "none";
        this.visibilityAppearance = "default";
        this.visibleElementsBaseLayers = true;
        this.visibleElementsCloseButton = false;
        this.visibleElementsCollapseButton = false;
        this.visibleElementsEditTitleButton = false;
        this.visibleElementsErrors = false;
        this.visibleElementsFilter = false;
        this.visibleElementsFlow = true;
        this.visibleElementsHeading = true;
        this.visibleElementsReferenceLayers = true;
        this.visibleElementsStatusIndicators = true;
        this.visibleElementsTemporaryLayerIndicators = false;
        this.view = undefined;
        this.widget = undefined;
        this.position = "bottom-left";
    }
    referenceElementWatcher(value) {
        void (0,_component_utils_23194f7c_js__WEBPACK_IMPORTED_MODULE_2__.r)(this, value);
    }
    baseFilterTextWatcher(value) {
        if (this.widget) {
            this.widget.baseFilterText = value;
        }
    }
    baseListItemCreatedFunctionWatcher(value) {
        if (this.widget) {
            this.widget.baseListItemCreatedFunction = value;
        }
    }
    basemapTitleWatcher(value, old) {
        if (this.widget && value !== old) {
            this.widget.basemapTitle = value;
        }
    }
    collapsedWatcher(value) {
        if (this.widget && this.widget.collapsed !== value) {
            this.widget.collapsed = value;
        }
    }
    dragEnabledWatcher(value) {
        if (this.widget && value !== undefined) {
            this.widget.dragEnabled = value;
        }
    }
    editingTitleWatcher(value) {
        if (this.widget && value !== undefined) {
            this.widget.editingTitle = value;
        }
    }
    filterPlaceholderWatcher(value) {
        if (this.widget) {
            this.widget.filterPlaceholder = value;
        }
    }
    iconWatcher(value) {
        if (this.widget) {
            this.widget.icon = value;
        }
    }
    minFilterItemsWatcher(value) {
        if (this.widget) {
            this.widget.minFilterItems = value;
        }
    }
    referenceFilterTextWatcher(value) {
        if (this.widget) {
            this.widget.referenceFilterText = value;
        }
    }
    referenceListItemCreatedFunctionWatcher(value) {
        if (this.widget) {
            this.widget.referenceListItemCreatedFunction = value;
        }
    }
    selectionModeWatcher(value) {
        if (this.widget) {
            this.widget.selectionMode = value;
        }
    }
    visibilityAppearanceWatcher(value) {
        if (this.widget) {
            this.widget.visibilityAppearance = value;
        }
    }
    visibleElementsBaseLayersWatcher(value) {
        if (this.widget) {
            this.widget.visibleElements = {
                ...this.widget.visibleElements,
                baseLayers: value,
            };
        }
    }
    visibleElementsCloseButtonWatcher(value) {
        if (this.widget) {
            this.widget.visibleElements = {
                ...this.widget.visibleElements,
                closeButton: value,
            };
        }
    }
    visibleElementsCollapseButtonWatcher(value) {
        if (this.widget) {
            this.widget.visibleElements = {
                ...this.widget.visibleElements,
                collapseButton: value,
            };
        }
    }
    visibleElementsEditTitleButtonWatcher(value) {
        if (this.widget) {
            this.widget.visibleElements = {
                ...this.widget.visibleElements,
                editTitleButton: value,
            };
        }
    }
    visibleElementsErrorsWatcher(value) {
        if (this.widget) {
            this.widget.visibleElements = {
                ...this.widget.visibleElements,
                errors: value,
            };
        }
    }
    visibleElementsFilterWatcher(value) {
        if (this.widget) {
            this.widget.visibleElements = {
                ...this.widget.visibleElements,
                filter: value,
            };
        }
    }
    visibleElementsFlowWatcher(value) {
        if (this.widget) {
            this.widget.visibleElements = {
                ...this.widget.visibleElements,
                flow: value,
            };
        }
    }
    visibleElementsHeadingWatcher(value) {
        if (this.widget) {
            this.widget.visibleElements = {
                ...this.widget.visibleElements,
                filter: value,
            };
        }
    }
    visibleElementsReferenceLayersWatcher(value) {
        if (this.widget) {
            this.widget.visibleElements = {
                ...this.widget.visibleElements,
                referenceLayers: value,
            };
        }
    }
    visibleElementsStatusIndicatorsWatcher(value) {
        if (this.widget) {
            this.widget.visibleElements = {
                ...this.widget.visibleElements,
                statusIndicators: value,
            };
        }
    }
    visibleElementsTemporaryLayerIndicatorsWatcher(value) {
        if (this.widget) {
            this.widget.visibleElements = {
                ...this.widget.visibleElements,
                temporaryLayerIndicators: value,
            };
        }
    }
    viewWatcher(value) {
        if (this.widget) {
            this.widget.view = value;
        }
    }
    positionWatcher(value) {
        if (this.widget) {
            this.view.ui.move(this.childElem, value);
        }
    }
    //--------------------------------------------------------------------------
    //
    //  Lifecycle
    //
    //--------------------------------------------------------------------------
    async componentDidLoad() {
        const params = this._createParams();
        const widget = await (0,_index_0bc55ca5_js__WEBPACK_IMPORTED_MODULE_1__.f)(params);
        this.widget = widget;
        await this._addWatchers();
        await this._addWatchers();
        this._proxyEvents();
        this._addContainer();
        this.arcgisBasemapLayerListReady.emit();
        (0,_component_utils_23194f7c_js__WEBPACK_IMPORTED_MODULE_2__.c)(this);
    }
    disconnectedCallback() {
        (0,_disconnected_6cf1c100_js__WEBPACK_IMPORTED_MODULE_3__.o)(this);
    }
    render() {
        return (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { ref: (el) => (this.childElem = el) });
    }
    //--------------------------------------------------------------------------
    //
    //  Private Methods
    //
    //--------------------------------------------------------------------------
    _addContainer() {
        this.widget.container = this.childElem;
    }
    _createParams() {
        const params = {};
        params.visibleElements = {
            baseLayers: this.visibleElementsBaseLayers,
            closeButton: this.visibleElementsCloseButton,
            collapseButton: this.visibleElementsCollapseButton,
            editTitleButton: this.visibleElementsEditTitleButton,
            errors: this.visibleElementsErrors,
            filter: this.visibleElementsFilter,
            flow: this.visibleElementsFlow,
            heading: this.visibleElementsHeading,
            referenceLayers: this.visibleElementsReferenceLayers,
            statusIndicators: this.visibleElementsStatusIndicators,
            temporaryLayerIndicators: this.visibleElementsTemporaryLayerIndicators,
        };
        if (this.baseFilterText) {
            params.baseFilterText = this.baseFilterText;
        }
        if (this.baseListItemCreatedFunction) {
            params.baseListItemCreatedFunction = this.baseListItemCreatedFunction;
        }
        if (this.basemapTitle) {
            params.basemapTitle = this.basemapTitle;
        }
        if (this.collapsed !== undefined) {
            params.collapsed = this.collapsed;
        }
        if (this.dragEnabled !== undefined) {
            params.dragEnabled = this.dragEnabled;
        }
        if (this.editingTitle !== undefined) {
            params.editingTitle = this.editingTitle;
        }
        if (this.filterPlaceholder) {
            params.filterPlaceholder = this.filterPlaceholder;
        }
        if (this.icon) {
            params.icon = this.icon;
        }
        if (this.minFilterItems !== undefined) {
            params.minFilterItems = this.minFilterItems;
        }
        if (this.referenceFilterText) {
            params.referenceFilterText = this.referenceFilterText;
        }
        if (this.referenceListItemCreatedFunction) {
            params.referenceListItemCreatedFunction = this.referenceListItemCreatedFunction;
        }
        if (this.selectionMode) {
            params.selectionMode = this.selectionMode;
        }
        if (this.visibilityAppearance) {
            params.visibilityAppearance = this.visibilityAppearance;
        }
        if (this.view) {
            params.view = this.view;
        }
        return params;
    }
    async _addWatchers() {
        const { watch } = await (0,_index_0bc55ca5_js__WEBPACK_IMPORTED_MODULE_1__.i)();
        (0,_component_utils_23194f7c_js__WEBPACK_IMPORTED_MODULE_2__.a)(this, [
            watch(() => this.widget.baseItems, (value) => (this.baseItems = value), {
                initial: true,
            }),
            watch(() => this.widget.selectedItems, (value) => (this.selectedItems = value), {
                initial: true,
            }),
            watch(() => this.widget.basemapTitle, (value) => {
                if (!this.basemapTitle) {
                    this.basemapTitle = value;
                }
            }, {
                initial: true,
            }),
            watch(() => this.widget.collapsed, (value) => (this.collapsed = value)),
        ]);
    }
    _proxyEvents() {
        this.widget?.on("trigger-action", (e) => this.basemapLayerListTriggerAction.emit(e));
    }
    get el() { return (0,_index_6e172aac_js__WEBPACK_IMPORTED_MODULE_0__.g)(this); }
    static get watchers() { return {
        "referenceElement": ["referenceElementWatcher"],
        "baseFilterText": ["baseFilterTextWatcher"],
        "baseListItemCreatedFunction": ["baseListItemCreatedFunctionWatcher"],
        "basemapTitle": ["basemapTitleWatcher"],
        "collapsed": ["collapsedWatcher"],
        "dragEnabled": ["dragEnabledWatcher"],
        "editingTitle": ["editingTitleWatcher"],
        "filterPlaceholder": ["filterPlaceholderWatcher"],
        "icon": ["iconWatcher"],
        "minFilterItems": ["minFilterItemsWatcher"],
        "referenceFilterText": ["referenceFilterTextWatcher"],
        "referenceListItemCreatedFunction": ["referenceListItemCreatedFunctionWatcher"],
        "selectionMode": ["selectionModeWatcher"],
        "visibilityAppearance": ["visibilityAppearanceWatcher"],
        "visibleElementsBaseLayers": ["visibleElementsBaseLayersWatcher"],
        "visibleElementsCloseButton": ["visibleElementsCloseButtonWatcher"],
        "visibleElementsCollapseButton": ["visibleElementsCollapseButtonWatcher"],
        "visibleElementsEditTitleButton": ["visibleElementsEditTitleButtonWatcher"],
        "visibleElementsErrors": ["visibleElementsErrorsWatcher"],
        "visibleElementsFilter": ["visibleElementsFilterWatcher"],
        "visibleElementsFlow": ["visibleElementsFlowWatcher"],
        "visibleElementsHeading": ["visibleElementsHeadingWatcher"],
        "visibleElementsReferenceLayers": ["visibleElementsReferenceLayersWatcher"],
        "visibleElementsStatusIndicators": ["visibleElementsStatusIndicatorsWatcher"],
        "visibleElementsTemporaryLayerIndicators": ["visibleElementsTemporaryLayerIndicatorsWatcher"],
        "view": ["viewWatcher"],
        "position": ["positionWatcher"]
    }; }
};
ArcgisBasemapLayerList.style = basemapLayerListCss;




/***/ }),

/***/ "./node_modules/@arcgis/map-components/dist/esm/component-utils-23194f7c.js":
/*!**********************************************************************************!*\
  !*** ./node_modules/@arcgis/map-components/dist/esm/component-utils-23194f7c.js ***!
  \**********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   a: () => (/* binding */ addHandles),
/* harmony export */   b: () => (/* binding */ isNotSameViewpoint),
/* harmony export */   c: () => (/* binding */ checkForView),
/* harmony export */   d: () => (/* binding */ checkForExpand),
/* harmony export */   e: () => (/* binding */ isNotSameCamera),
/* harmony export */   f: () => (/* binding */ isNotSameEnvironment),
/* harmony export */   g: () => (/* binding */ isValidInteger),
/* harmony export */   i: () => (/* binding */ isNullOrEmptyString),
/* harmony export */   r: () => (/* binding */ referenceElementHelper)
/* harmony export */ });
/*!
 * All material copyright Esri, All Rights Reserved, unless otherwise specified.
 * See https://js.arcgis.com/4.30/esri/copyright.txt for details.
 * v4.30.0-next.37
 */
function checkForExpand(element) {
    const expandRef = element.el.closest("arcgis-expand") ?? element.expandElem;
    if (expandRef?.widget) {
        element.view = expandRef.view;
        expandRef.widget.content = element.childElem ?? element.el;
        // TODO: Update to be expandIcon = widget.icon, not ready yet in 4.27next
        if (!expandRef.expandIcon) {
            expandRef.widget.expandIcon = element.widget ? element.widget.icon : element?.icon;
        }
        return true;
    }
    if (expandRef) {
        const widgetHandler = () => {
            expandRef.removeEventListener("arcgisExpandReady", widgetHandler, false);
            element.view = expandRef.view;
            expandRef.widget.content = element.childElem ?? element.el;
            if (!expandRef.expandIcon) {
                expandRef.widget.expandIcon = element.widget ? element.widget.icon : element?.icon;
            }
        };
        expandRef.addEventListener("arcgisExpandReady", widgetHandler, false);
        return true;
    }
    return false;
}

//--------------------------------------------------------------------------
//
//  Public Methods
//
//--------------------------------------------------------------------------
function addHandles(element, handle) {
    if (Array.isArray(handle)) {
        element._watchHandles = [...element._watchHandles, ...handle];
    }
    else {
        element._watchHandles.push(handle);
    }
}
function checkForView(element) {
    let isUsingReferenceElement = false;
    if (!checkForExpand(element)) {
        let viewRef = element.el.closest("arcgis-map") ?? element.el.closest("arcgis-scene");
        if (!viewRef && typeof element.referenceElement === "string") {
            viewRef = document.querySelector(element.referenceElement);
            isUsingReferenceElement = true;
        }
        if (viewRef?.view) {
            element.view = viewRef.view;
            const el = element.childElem ?? element.el;
            if (!isUsingReferenceElement) {
                element.view.ui.add(el, element.position);
            }
        }
        else if (viewRef) {
            waitForViewHandler(viewRef, element, isUsingReferenceElement);
        }
    }
    else {
        const viewRef = element.el.closest("arcgis-map") ?? element.el.closest("arcgis-scene");
        if (viewRef?.view) {
            element.view = viewRef.view;
        }
        else if (viewRef) {
            const handler = () => {
                viewRef.removeEventListener("arcgisViewReadyChange", handler, false);
                element.view = viewRef.view;
            };
            viewRef.addEventListener("arcgisViewReadyChange", handler, false);
        }
    }
}
function isNullOrEmptyString(value) {
    return value === undefined || value === null || value === "";
}
function isValidInteger(value) {
    return value != null && value % 1 === 0;
}
function isNotSameCamera(camera, camera2) {
    return (camera2 === undefined ||
        camera.position !== camera2.position ||
        camera.heading !== camera2.heading ||
        camera.tilt !== camera2.tilt);
}
function isNotSameEnvironment(environment, environment2) {
    return (environment2 === undefined ||
        environment2.atmosphereEnabled !== environment.atmosphereEnabled ||
        environment2.lighting.date !== environment.lighting.date ||
        environment2.lighting.directShadowsEnabled !==
            environment.lighting.directShadowsEnabled ||
        environment2.lighting.cameraTrackingEnabled !==
            environment.lighting.cameraTrackingEnabled ||
        environment2.lighting.date !== environment.lighting.date ||
        environment2.lighting.displayUTCOffset !==
            environment.lighting.displayUTCOffset);
}
function isNotSameViewpoint(viewpoint, viewpoint2) {
    return (viewpoint2 === undefined ||
        viewpoint.targetGeometry !== viewpoint2.targetGeometry ||
        viewpoint.rotation !== viewpoint2.rotation ||
        viewpoint.scale !== viewpoint2.scale);
}
async function updateForView(viewStr) {
    const viewRef = document.querySelector(viewStr);
    return await new Promise((resolve) => {
        if (viewRef?.view !== undefined) {
            resolve(viewRef.view);
        }
        else if (viewRef) {
            const handler = () => {
                viewRef.removeEventListener("arcgisViewReadyChange", handler, false);
                resolve(viewRef.view);
            };
            viewRef.addEventListener("arcgisViewReadyChange", handler, false);
        }
    });
}
async function referenceElementHelper(element, refElement) {
    if (refElement === undefined)
        return;
    else if (typeof refElement === "string") {
        element.view = await updateForView(refElement);
    }
    else if (element.widget) {
        element.view = refElement.view;
    }
}
//--------------------------------------------------------------------------
//
//  Private Methods
//
//--------------------------------------------------------------------------
function waitForViewHandler(viewRef, element, isUsingRefernceElement) {
    const handler = () => {
        viewRef.removeEventListener("arcgisViewReadyChange", handler, false);
        element.view = viewRef.view;
        if (!isUsingRefernceElement) {
            element.view.ui.add(element.childElem ?? element.el, element.position);
        }
    };
    viewRef.addEventListener("arcgisViewReadyChange", handler, false);
}




/***/ }),

/***/ "./node_modules/@arcgis/map-components/dist/esm/disconnected-6cf1c100.js":
/*!*******************************************************************************!*\
  !*** ./node_modules/@arcgis/map-components/dist/esm/disconnected-6cf1c100.js ***!
  \*******************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   o: () => (/* binding */ onDisconnectedHelper)
/* harmony export */ });
/*!
 * All material copyright Esri, All Rights Reserved, unless otherwise specified.
 * See https://js.arcgis.com/4.30/esri/copyright.txt for details.
 * v4.30.0-next.37
 */
function onDisconnectedHelper(element) {
    if (element.childElem) {
        if (!element.el.isConnected) {
            if (element.view) {
                element.view.ui.remove(element.childElem);
            }
            else if (element.widget?.view) {
                element.widget.view.ui.remove(element.childElem);
            }
            if (element._watchHandles) {
                element._watchHandles.forEach((handle) => {
                    handle.remove();
                });
            }
            element._watchHandles = [];
            element.widget?.destroy();
        }
    }
    else {
        setTimeout(() => {
            if (!element.el.isConnected) {
                if (element.view) {
                    element.view.ui.remove(element.el);
                }
                else if (element.widget?.view) {
                    element.widget.view.ui.remove(element.el);
                }
                if (element._watchHandles) {
                    element._watchHandles.forEach((handle) => {
                        handle.remove();
                    });
                }
                element._watchHandles = [];
                element.widget?.destroy();
            }
        }, 1000);
    }
}




/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2lkZ2V0cy9jaHVua3MvdmVuZG9ycy1ub2RlX21vZHVsZXNfYXJjZ2lzX21hcC1jb21wb25lbnRzX2Rpc3RfZXNtX2FyY2dpcy1iYXNlbWFwLWxheWVyLWxpc3RfZW50cnlfanMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ2tHO0FBQ0U7QUFDWTtBQUN6Qzs7QUFFdkU7O0FBRUE7QUFDQTtBQUNBLFFBQVEscURBQWdCO0FBQ3hCLDJDQUEyQyxxREFBVztBQUN0RCw2Q0FBNkMscURBQVc7QUFDeEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSwrREFBc0I7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCLHFEQUEwQjtBQUN2RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLCtEQUFZO0FBQ3BCO0FBQ0E7QUFDQSxRQUFRLDREQUFvQjtBQUM1QjtBQUNBO0FBQ0EsZUFBZSxxREFBQyxVQUFVLG9DQUFvQztBQUM5RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsUUFBUSxRQUFRLHFEQUF1QjtBQUN2RCxRQUFRLCtEQUFVO0FBQ2xCO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLE9BQU8scURBQVU7QUFDaEMsNEJBQTRCO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFK0Q7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDdlcvRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUV5Tjs7Ozs7Ozs7Ozs7Ozs7O0FDcEp6TjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTs7QUFFcUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vbm9kZV9tb2R1bGVzL0BhcmNnaXMvbWFwLWNvbXBvbmVudHMvZGlzdC9lc20vYXJjZ2lzLWJhc2VtYXAtbGF5ZXItbGlzdC5lbnRyeS5qcyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vbm9kZV9tb2R1bGVzL0BhcmNnaXMvbWFwLWNvbXBvbmVudHMvZGlzdC9lc20vY29tcG9uZW50LXV0aWxzLTIzMTk0ZjdjLmpzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9ub2RlX21vZHVsZXMvQGFyY2dpcy9tYXAtY29tcG9uZW50cy9kaXN0L2VzbS9kaXNjb25uZWN0ZWQtNmNmMWMxMDAuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyohXG4gKiBBbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVzcmksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuICogU2VlIGh0dHBzOi8vanMuYXJjZ2lzLmNvbS80LjMwL2VzcmkvY29weXJpZ2h0LnR4dCBmb3IgZGV0YWlscy5cbiAqIHY0LjMwLjAtbmV4dC4zN1xuICovXG5pbXBvcnQgeyByIGFzIHJlZ2lzdGVySW5zdGFuY2UsIGMgYXMgY3JlYXRlRXZlbnQsIGgsIGcgYXMgZ2V0RWxlbWVudCB9IGZyb20gJy4vaW5kZXgtNmUxNzJhYWMuanMnO1xuaW1wb3J0IHsgZiBhcyBuZXdXaWRnZXRzQmFzZW1hcExheWVyTGlzdCwgaSBhcyBpbXBvcnRDb3JlUmVhY3RpdmVVdGlscyB9IGZyb20gJy4vaW5kZXgtMGJjNTVjYTUuanMnO1xuaW1wb3J0IHsgciBhcyByZWZlcmVuY2VFbGVtZW50SGVscGVyLCBjIGFzIGNoZWNrRm9yVmlldywgYSBhcyBhZGRIYW5kbGVzIH0gZnJvbSAnLi9jb21wb25lbnQtdXRpbHMtMjMxOTRmN2MuanMnO1xuaW1wb3J0IHsgbyBhcyBvbkRpc2Nvbm5lY3RlZEhlbHBlciB9IGZyb20gJy4vZGlzY29ubmVjdGVkLTZjZjFjMTAwLmpzJztcblxuY29uc3QgYmFzZW1hcExheWVyTGlzdENzcyA9IFwiXCI7XG5cbmNvbnN0IEFyY2dpc0Jhc2VtYXBMYXllckxpc3QgPSBjbGFzcyB7XG4gICAgY29uc3RydWN0b3IoaG9zdFJlZikge1xuICAgICAgICByZWdpc3Rlckluc3RhbmNlKHRoaXMsIGhvc3RSZWYpO1xuICAgICAgICB0aGlzLmFyY2dpc0Jhc2VtYXBMYXllckxpc3RSZWFkeSA9IGNyZWF0ZUV2ZW50KHRoaXMsIFwiYXJjZ2lzQmFzZW1hcExheWVyTGlzdFJlYWR5XCIsIDcpO1xuICAgICAgICB0aGlzLmJhc2VtYXBMYXllckxpc3RUcmlnZ2VyQWN0aW9uID0gY3JlYXRlRXZlbnQodGhpcywgXCJiYXNlbWFwTGF5ZXJMaXN0VHJpZ2dlckFjdGlvblwiLCA3KTtcbiAgICAgICAgdGhpcy5fd2F0Y2hIYW5kbGVzID0gW107XG4gICAgICAgIHRoaXMucmVmZXJlbmNlRWxlbWVudCA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5iYXNlRmlsdGVyVGV4dCA9IFwiXCI7XG4gICAgICAgIHRoaXMuYmFzZUl0ZW1zID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLmJhc2VMaXN0SXRlbUNyZWF0ZWRGdW5jdGlvbiA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5iYXNlbWFwVGl0bGUgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuY29sbGFwc2VkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuZHJhZ0VuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5lZGl0aW5nVGl0bGUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5maWx0ZXJQbGFjZWhvbGRlciA9IFwiXCI7XG4gICAgICAgIHRoaXMuaWNvbiA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5taW5GaWx0ZXJJdGVtcyA9IDEwO1xuICAgICAgICB0aGlzLnJlZmVyZW5jZUZpbHRlclRleHQgPSBcIlwiO1xuICAgICAgICB0aGlzLnJlZmVyZW5jZUxpc3RJdGVtQ3JlYXRlZEZ1bmN0aW9uID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLnNlbGVjdGVkSXRlbXMgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuc2VsZWN0aW9uTW9kZSA9IFwibm9uZVwiO1xuICAgICAgICB0aGlzLnZpc2liaWxpdHlBcHBlYXJhbmNlID0gXCJkZWZhdWx0XCI7XG4gICAgICAgIHRoaXMudmlzaWJsZUVsZW1lbnRzQmFzZUxheWVycyA9IHRydWU7XG4gICAgICAgIHRoaXMudmlzaWJsZUVsZW1lbnRzQ2xvc2VCdXR0b24gPSBmYWxzZTtcbiAgICAgICAgdGhpcy52aXNpYmxlRWxlbWVudHNDb2xsYXBzZUJ1dHRvbiA9IGZhbHNlO1xuICAgICAgICB0aGlzLnZpc2libGVFbGVtZW50c0VkaXRUaXRsZUJ1dHRvbiA9IGZhbHNlO1xuICAgICAgICB0aGlzLnZpc2libGVFbGVtZW50c0Vycm9ycyA9IGZhbHNlO1xuICAgICAgICB0aGlzLnZpc2libGVFbGVtZW50c0ZpbHRlciA9IGZhbHNlO1xuICAgICAgICB0aGlzLnZpc2libGVFbGVtZW50c0Zsb3cgPSB0cnVlO1xuICAgICAgICB0aGlzLnZpc2libGVFbGVtZW50c0hlYWRpbmcgPSB0cnVlO1xuICAgICAgICB0aGlzLnZpc2libGVFbGVtZW50c1JlZmVyZW5jZUxheWVycyA9IHRydWU7XG4gICAgICAgIHRoaXMudmlzaWJsZUVsZW1lbnRzU3RhdHVzSW5kaWNhdG9ycyA9IHRydWU7XG4gICAgICAgIHRoaXMudmlzaWJsZUVsZW1lbnRzVGVtcG9yYXJ5TGF5ZXJJbmRpY2F0b3JzID0gZmFsc2U7XG4gICAgICAgIHRoaXMudmlldyA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy53aWRnZXQgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMucG9zaXRpb24gPSBcImJvdHRvbS1sZWZ0XCI7XG4gICAgfVxuICAgIHJlZmVyZW5jZUVsZW1lbnRXYXRjaGVyKHZhbHVlKSB7XG4gICAgICAgIHZvaWQgcmVmZXJlbmNlRWxlbWVudEhlbHBlcih0aGlzLCB2YWx1ZSk7XG4gICAgfVxuICAgIGJhc2VGaWx0ZXJUZXh0V2F0Y2hlcih2YWx1ZSkge1xuICAgICAgICBpZiAodGhpcy53aWRnZXQpIHtcbiAgICAgICAgICAgIHRoaXMud2lkZ2V0LmJhc2VGaWx0ZXJUZXh0ID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgYmFzZUxpc3RJdGVtQ3JlYXRlZEZ1bmN0aW9uV2F0Y2hlcih2YWx1ZSkge1xuICAgICAgICBpZiAodGhpcy53aWRnZXQpIHtcbiAgICAgICAgICAgIHRoaXMud2lkZ2V0LmJhc2VMaXN0SXRlbUNyZWF0ZWRGdW5jdGlvbiA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGJhc2VtYXBUaXRsZVdhdGNoZXIodmFsdWUsIG9sZCkge1xuICAgICAgICBpZiAodGhpcy53aWRnZXQgJiYgdmFsdWUgIT09IG9sZCkge1xuICAgICAgICAgICAgdGhpcy53aWRnZXQuYmFzZW1hcFRpdGxlID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY29sbGFwc2VkV2F0Y2hlcih2YWx1ZSkge1xuICAgICAgICBpZiAodGhpcy53aWRnZXQgJiYgdGhpcy53aWRnZXQuY29sbGFwc2VkICE9PSB2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy53aWRnZXQuY29sbGFwc2VkID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZHJhZ0VuYWJsZWRXYXRjaGVyKHZhbHVlKSB7XG4gICAgICAgIGlmICh0aGlzLndpZGdldCAmJiB2YWx1ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aGlzLndpZGdldC5kcmFnRW5hYmxlZCA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVkaXRpbmdUaXRsZVdhdGNoZXIodmFsdWUpIHtcbiAgICAgICAgaWYgKHRoaXMud2lkZ2V0ICYmIHZhbHVlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMud2lkZ2V0LmVkaXRpbmdUaXRsZSA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGZpbHRlclBsYWNlaG9sZGVyV2F0Y2hlcih2YWx1ZSkge1xuICAgICAgICBpZiAodGhpcy53aWRnZXQpIHtcbiAgICAgICAgICAgIHRoaXMud2lkZ2V0LmZpbHRlclBsYWNlaG9sZGVyID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWNvbldhdGNoZXIodmFsdWUpIHtcbiAgICAgICAgaWYgKHRoaXMud2lkZ2V0KSB7XG4gICAgICAgICAgICB0aGlzLndpZGdldC5pY29uID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgbWluRmlsdGVySXRlbXNXYXRjaGVyKHZhbHVlKSB7XG4gICAgICAgIGlmICh0aGlzLndpZGdldCkge1xuICAgICAgICAgICAgdGhpcy53aWRnZXQubWluRmlsdGVySXRlbXMgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZWZlcmVuY2VGaWx0ZXJUZXh0V2F0Y2hlcih2YWx1ZSkge1xuICAgICAgICBpZiAodGhpcy53aWRnZXQpIHtcbiAgICAgICAgICAgIHRoaXMud2lkZ2V0LnJlZmVyZW5jZUZpbHRlclRleHQgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZWZlcmVuY2VMaXN0SXRlbUNyZWF0ZWRGdW5jdGlvbldhdGNoZXIodmFsdWUpIHtcbiAgICAgICAgaWYgKHRoaXMud2lkZ2V0KSB7XG4gICAgICAgICAgICB0aGlzLndpZGdldC5yZWZlcmVuY2VMaXN0SXRlbUNyZWF0ZWRGdW5jdGlvbiA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHNlbGVjdGlvbk1vZGVXYXRjaGVyKHZhbHVlKSB7XG4gICAgICAgIGlmICh0aGlzLndpZGdldCkge1xuICAgICAgICAgICAgdGhpcy53aWRnZXQuc2VsZWN0aW9uTW9kZSA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHZpc2liaWxpdHlBcHBlYXJhbmNlV2F0Y2hlcih2YWx1ZSkge1xuICAgICAgICBpZiAodGhpcy53aWRnZXQpIHtcbiAgICAgICAgICAgIHRoaXMud2lkZ2V0LnZpc2liaWxpdHlBcHBlYXJhbmNlID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdmlzaWJsZUVsZW1lbnRzQmFzZUxheWVyc1dhdGNoZXIodmFsdWUpIHtcbiAgICAgICAgaWYgKHRoaXMud2lkZ2V0KSB7XG4gICAgICAgICAgICB0aGlzLndpZGdldC52aXNpYmxlRWxlbWVudHMgPSB7XG4gICAgICAgICAgICAgICAgLi4udGhpcy53aWRnZXQudmlzaWJsZUVsZW1lbnRzLFxuICAgICAgICAgICAgICAgIGJhc2VMYXllcnM6IHZhbHVlLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB2aXNpYmxlRWxlbWVudHNDbG9zZUJ1dHRvbldhdGNoZXIodmFsdWUpIHtcbiAgICAgICAgaWYgKHRoaXMud2lkZ2V0KSB7XG4gICAgICAgICAgICB0aGlzLndpZGdldC52aXNpYmxlRWxlbWVudHMgPSB7XG4gICAgICAgICAgICAgICAgLi4udGhpcy53aWRnZXQudmlzaWJsZUVsZW1lbnRzLFxuICAgICAgICAgICAgICAgIGNsb3NlQnV0dG9uOiB2YWx1ZSxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG4gICAgdmlzaWJsZUVsZW1lbnRzQ29sbGFwc2VCdXR0b25XYXRjaGVyKHZhbHVlKSB7XG4gICAgICAgIGlmICh0aGlzLndpZGdldCkge1xuICAgICAgICAgICAgdGhpcy53aWRnZXQudmlzaWJsZUVsZW1lbnRzID0ge1xuICAgICAgICAgICAgICAgIC4uLnRoaXMud2lkZ2V0LnZpc2libGVFbGVtZW50cyxcbiAgICAgICAgICAgICAgICBjb2xsYXBzZUJ1dHRvbjogdmFsdWUsXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuICAgIHZpc2libGVFbGVtZW50c0VkaXRUaXRsZUJ1dHRvbldhdGNoZXIodmFsdWUpIHtcbiAgICAgICAgaWYgKHRoaXMud2lkZ2V0KSB7XG4gICAgICAgICAgICB0aGlzLndpZGdldC52aXNpYmxlRWxlbWVudHMgPSB7XG4gICAgICAgICAgICAgICAgLi4udGhpcy53aWRnZXQudmlzaWJsZUVsZW1lbnRzLFxuICAgICAgICAgICAgICAgIGVkaXRUaXRsZUJ1dHRvbjogdmFsdWUsXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuICAgIHZpc2libGVFbGVtZW50c0Vycm9yc1dhdGNoZXIodmFsdWUpIHtcbiAgICAgICAgaWYgKHRoaXMud2lkZ2V0KSB7XG4gICAgICAgICAgICB0aGlzLndpZGdldC52aXNpYmxlRWxlbWVudHMgPSB7XG4gICAgICAgICAgICAgICAgLi4udGhpcy53aWRnZXQudmlzaWJsZUVsZW1lbnRzLFxuICAgICAgICAgICAgICAgIGVycm9yczogdmFsdWUsXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuICAgIHZpc2libGVFbGVtZW50c0ZpbHRlcldhdGNoZXIodmFsdWUpIHtcbiAgICAgICAgaWYgKHRoaXMud2lkZ2V0KSB7XG4gICAgICAgICAgICB0aGlzLndpZGdldC52aXNpYmxlRWxlbWVudHMgPSB7XG4gICAgICAgICAgICAgICAgLi4udGhpcy53aWRnZXQudmlzaWJsZUVsZW1lbnRzLFxuICAgICAgICAgICAgICAgIGZpbHRlcjogdmFsdWUsXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuICAgIHZpc2libGVFbGVtZW50c0Zsb3dXYXRjaGVyKHZhbHVlKSB7XG4gICAgICAgIGlmICh0aGlzLndpZGdldCkge1xuICAgICAgICAgICAgdGhpcy53aWRnZXQudmlzaWJsZUVsZW1lbnRzID0ge1xuICAgICAgICAgICAgICAgIC4uLnRoaXMud2lkZ2V0LnZpc2libGVFbGVtZW50cyxcbiAgICAgICAgICAgICAgICBmbG93OiB2YWx1ZSxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG4gICAgdmlzaWJsZUVsZW1lbnRzSGVhZGluZ1dhdGNoZXIodmFsdWUpIHtcbiAgICAgICAgaWYgKHRoaXMud2lkZ2V0KSB7XG4gICAgICAgICAgICB0aGlzLndpZGdldC52aXNpYmxlRWxlbWVudHMgPSB7XG4gICAgICAgICAgICAgICAgLi4udGhpcy53aWRnZXQudmlzaWJsZUVsZW1lbnRzLFxuICAgICAgICAgICAgICAgIGZpbHRlcjogdmFsdWUsXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuICAgIHZpc2libGVFbGVtZW50c1JlZmVyZW5jZUxheWVyc1dhdGNoZXIodmFsdWUpIHtcbiAgICAgICAgaWYgKHRoaXMud2lkZ2V0KSB7XG4gICAgICAgICAgICB0aGlzLndpZGdldC52aXNpYmxlRWxlbWVudHMgPSB7XG4gICAgICAgICAgICAgICAgLi4udGhpcy53aWRnZXQudmlzaWJsZUVsZW1lbnRzLFxuICAgICAgICAgICAgICAgIHJlZmVyZW5jZUxheWVyczogdmFsdWUsXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuICAgIHZpc2libGVFbGVtZW50c1N0YXR1c0luZGljYXRvcnNXYXRjaGVyKHZhbHVlKSB7XG4gICAgICAgIGlmICh0aGlzLndpZGdldCkge1xuICAgICAgICAgICAgdGhpcy53aWRnZXQudmlzaWJsZUVsZW1lbnRzID0ge1xuICAgICAgICAgICAgICAgIC4uLnRoaXMud2lkZ2V0LnZpc2libGVFbGVtZW50cyxcbiAgICAgICAgICAgICAgICBzdGF0dXNJbmRpY2F0b3JzOiB2YWx1ZSxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG4gICAgdmlzaWJsZUVsZW1lbnRzVGVtcG9yYXJ5TGF5ZXJJbmRpY2F0b3JzV2F0Y2hlcih2YWx1ZSkge1xuICAgICAgICBpZiAodGhpcy53aWRnZXQpIHtcbiAgICAgICAgICAgIHRoaXMud2lkZ2V0LnZpc2libGVFbGVtZW50cyA9IHtcbiAgICAgICAgICAgICAgICAuLi50aGlzLndpZGdldC52aXNpYmxlRWxlbWVudHMsXG4gICAgICAgICAgICAgICAgdGVtcG9yYXJ5TGF5ZXJJbmRpY2F0b3JzOiB2YWx1ZSxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG4gICAgdmlld1dhdGNoZXIodmFsdWUpIHtcbiAgICAgICAgaWYgKHRoaXMud2lkZ2V0KSB7XG4gICAgICAgICAgICB0aGlzLndpZGdldC52aWV3ID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcG9zaXRpb25XYXRjaGVyKHZhbHVlKSB7XG4gICAgICAgIGlmICh0aGlzLndpZGdldCkge1xuICAgICAgICAgICAgdGhpcy52aWV3LnVpLm1vdmUodGhpcy5jaGlsZEVsZW0sIHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy9cbiAgICAvLyAgTGlmZWN5Y2xlXG4gICAgLy9cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgYXN5bmMgY29tcG9uZW50RGlkTG9hZCgpIHtcbiAgICAgICAgY29uc3QgcGFyYW1zID0gdGhpcy5fY3JlYXRlUGFyYW1zKCk7XG4gICAgICAgIGNvbnN0IHdpZGdldCA9IGF3YWl0IG5ld1dpZGdldHNCYXNlbWFwTGF5ZXJMaXN0KHBhcmFtcyk7XG4gICAgICAgIHRoaXMud2lkZ2V0ID0gd2lkZ2V0O1xuICAgICAgICBhd2FpdCB0aGlzLl9hZGRXYXRjaGVycygpO1xuICAgICAgICBhd2FpdCB0aGlzLl9hZGRXYXRjaGVycygpO1xuICAgICAgICB0aGlzLl9wcm94eUV2ZW50cygpO1xuICAgICAgICB0aGlzLl9hZGRDb250YWluZXIoKTtcbiAgICAgICAgdGhpcy5hcmNnaXNCYXNlbWFwTGF5ZXJMaXN0UmVhZHkuZW1pdCgpO1xuICAgICAgICBjaGVja0ZvclZpZXcodGhpcyk7XG4gICAgfVxuICAgIGRpc2Nvbm5lY3RlZENhbGxiYWNrKCkge1xuICAgICAgICBvbkRpc2Nvbm5lY3RlZEhlbHBlcih0aGlzKTtcbiAgICB9XG4gICAgcmVuZGVyKCkge1xuICAgICAgICByZXR1cm4gaChcImRpdlwiLCB7IHJlZjogKGVsKSA9PiAodGhpcy5jaGlsZEVsZW0gPSBlbCkgfSk7XG4gICAgfVxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvL1xuICAgIC8vICBQcml2YXRlIE1ldGhvZHNcbiAgICAvL1xuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICBfYWRkQ29udGFpbmVyKCkge1xuICAgICAgICB0aGlzLndpZGdldC5jb250YWluZXIgPSB0aGlzLmNoaWxkRWxlbTtcbiAgICB9XG4gICAgX2NyZWF0ZVBhcmFtcygpIHtcbiAgICAgICAgY29uc3QgcGFyYW1zID0ge307XG4gICAgICAgIHBhcmFtcy52aXNpYmxlRWxlbWVudHMgPSB7XG4gICAgICAgICAgICBiYXNlTGF5ZXJzOiB0aGlzLnZpc2libGVFbGVtZW50c0Jhc2VMYXllcnMsXG4gICAgICAgICAgICBjbG9zZUJ1dHRvbjogdGhpcy52aXNpYmxlRWxlbWVudHNDbG9zZUJ1dHRvbixcbiAgICAgICAgICAgIGNvbGxhcHNlQnV0dG9uOiB0aGlzLnZpc2libGVFbGVtZW50c0NvbGxhcHNlQnV0dG9uLFxuICAgICAgICAgICAgZWRpdFRpdGxlQnV0dG9uOiB0aGlzLnZpc2libGVFbGVtZW50c0VkaXRUaXRsZUJ1dHRvbixcbiAgICAgICAgICAgIGVycm9yczogdGhpcy52aXNpYmxlRWxlbWVudHNFcnJvcnMsXG4gICAgICAgICAgICBmaWx0ZXI6IHRoaXMudmlzaWJsZUVsZW1lbnRzRmlsdGVyLFxuICAgICAgICAgICAgZmxvdzogdGhpcy52aXNpYmxlRWxlbWVudHNGbG93LFxuICAgICAgICAgICAgaGVhZGluZzogdGhpcy52aXNpYmxlRWxlbWVudHNIZWFkaW5nLFxuICAgICAgICAgICAgcmVmZXJlbmNlTGF5ZXJzOiB0aGlzLnZpc2libGVFbGVtZW50c1JlZmVyZW5jZUxheWVycyxcbiAgICAgICAgICAgIHN0YXR1c0luZGljYXRvcnM6IHRoaXMudmlzaWJsZUVsZW1lbnRzU3RhdHVzSW5kaWNhdG9ycyxcbiAgICAgICAgICAgIHRlbXBvcmFyeUxheWVySW5kaWNhdG9yczogdGhpcy52aXNpYmxlRWxlbWVudHNUZW1wb3JhcnlMYXllckluZGljYXRvcnMsXG4gICAgICAgIH07XG4gICAgICAgIGlmICh0aGlzLmJhc2VGaWx0ZXJUZXh0KSB7XG4gICAgICAgICAgICBwYXJhbXMuYmFzZUZpbHRlclRleHQgPSB0aGlzLmJhc2VGaWx0ZXJUZXh0O1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmJhc2VMaXN0SXRlbUNyZWF0ZWRGdW5jdGlvbikge1xuICAgICAgICAgICAgcGFyYW1zLmJhc2VMaXN0SXRlbUNyZWF0ZWRGdW5jdGlvbiA9IHRoaXMuYmFzZUxpc3RJdGVtQ3JlYXRlZEZ1bmN0aW9uO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmJhc2VtYXBUaXRsZSkge1xuICAgICAgICAgICAgcGFyYW1zLmJhc2VtYXBUaXRsZSA9IHRoaXMuYmFzZW1hcFRpdGxlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmNvbGxhcHNlZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBwYXJhbXMuY29sbGFwc2VkID0gdGhpcy5jb2xsYXBzZWQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuZHJhZ0VuYWJsZWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcGFyYW1zLmRyYWdFbmFibGVkID0gdGhpcy5kcmFnRW5hYmxlZDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5lZGl0aW5nVGl0bGUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcGFyYW1zLmVkaXRpbmdUaXRsZSA9IHRoaXMuZWRpdGluZ1RpdGxlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmZpbHRlclBsYWNlaG9sZGVyKSB7XG4gICAgICAgICAgICBwYXJhbXMuZmlsdGVyUGxhY2Vob2xkZXIgPSB0aGlzLmZpbHRlclBsYWNlaG9sZGVyO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmljb24pIHtcbiAgICAgICAgICAgIHBhcmFtcy5pY29uID0gdGhpcy5pY29uO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm1pbkZpbHRlckl0ZW1zICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHBhcmFtcy5taW5GaWx0ZXJJdGVtcyA9IHRoaXMubWluRmlsdGVySXRlbXM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucmVmZXJlbmNlRmlsdGVyVGV4dCkge1xuICAgICAgICAgICAgcGFyYW1zLnJlZmVyZW5jZUZpbHRlclRleHQgPSB0aGlzLnJlZmVyZW5jZUZpbHRlclRleHQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucmVmZXJlbmNlTGlzdEl0ZW1DcmVhdGVkRnVuY3Rpb24pIHtcbiAgICAgICAgICAgIHBhcmFtcy5yZWZlcmVuY2VMaXN0SXRlbUNyZWF0ZWRGdW5jdGlvbiA9IHRoaXMucmVmZXJlbmNlTGlzdEl0ZW1DcmVhdGVkRnVuY3Rpb247XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuc2VsZWN0aW9uTW9kZSkge1xuICAgICAgICAgICAgcGFyYW1zLnNlbGVjdGlvbk1vZGUgPSB0aGlzLnNlbGVjdGlvbk1vZGU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMudmlzaWJpbGl0eUFwcGVhcmFuY2UpIHtcbiAgICAgICAgICAgIHBhcmFtcy52aXNpYmlsaXR5QXBwZWFyYW5jZSA9IHRoaXMudmlzaWJpbGl0eUFwcGVhcmFuY2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMudmlldykge1xuICAgICAgICAgICAgcGFyYW1zLnZpZXcgPSB0aGlzLnZpZXc7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHBhcmFtcztcbiAgICB9XG4gICAgYXN5bmMgX2FkZFdhdGNoZXJzKCkge1xuICAgICAgICBjb25zdCB7IHdhdGNoIH0gPSBhd2FpdCBpbXBvcnRDb3JlUmVhY3RpdmVVdGlscygpO1xuICAgICAgICBhZGRIYW5kbGVzKHRoaXMsIFtcbiAgICAgICAgICAgIHdhdGNoKCgpID0+IHRoaXMud2lkZ2V0LmJhc2VJdGVtcywgKHZhbHVlKSA9PiAodGhpcy5iYXNlSXRlbXMgPSB2YWx1ZSksIHtcbiAgICAgICAgICAgICAgICBpbml0aWFsOiB0cnVlLFxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICB3YXRjaCgoKSA9PiB0aGlzLndpZGdldC5zZWxlY3RlZEl0ZW1zLCAodmFsdWUpID0+ICh0aGlzLnNlbGVjdGVkSXRlbXMgPSB2YWx1ZSksIHtcbiAgICAgICAgICAgICAgICBpbml0aWFsOiB0cnVlLFxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICB3YXRjaCgoKSA9PiB0aGlzLndpZGdldC5iYXNlbWFwVGl0bGUsICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgIGlmICghdGhpcy5iYXNlbWFwVGl0bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5iYXNlbWFwVGl0bGUgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgaW5pdGlhbDogdHJ1ZSxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgd2F0Y2goKCkgPT4gdGhpcy53aWRnZXQuY29sbGFwc2VkLCAodmFsdWUpID0+ICh0aGlzLmNvbGxhcHNlZCA9IHZhbHVlKSksXG4gICAgICAgIF0pO1xuICAgIH1cbiAgICBfcHJveHlFdmVudHMoKSB7XG4gICAgICAgIHRoaXMud2lkZ2V0Py5vbihcInRyaWdnZXItYWN0aW9uXCIsIChlKSA9PiB0aGlzLmJhc2VtYXBMYXllckxpc3RUcmlnZ2VyQWN0aW9uLmVtaXQoZSkpO1xuICAgIH1cbiAgICBnZXQgZWwoKSB7IHJldHVybiBnZXRFbGVtZW50KHRoaXMpOyB9XG4gICAgc3RhdGljIGdldCB3YXRjaGVycygpIHsgcmV0dXJuIHtcbiAgICAgICAgXCJyZWZlcmVuY2VFbGVtZW50XCI6IFtcInJlZmVyZW5jZUVsZW1lbnRXYXRjaGVyXCJdLFxuICAgICAgICBcImJhc2VGaWx0ZXJUZXh0XCI6IFtcImJhc2VGaWx0ZXJUZXh0V2F0Y2hlclwiXSxcbiAgICAgICAgXCJiYXNlTGlzdEl0ZW1DcmVhdGVkRnVuY3Rpb25cIjogW1wiYmFzZUxpc3RJdGVtQ3JlYXRlZEZ1bmN0aW9uV2F0Y2hlclwiXSxcbiAgICAgICAgXCJiYXNlbWFwVGl0bGVcIjogW1wiYmFzZW1hcFRpdGxlV2F0Y2hlclwiXSxcbiAgICAgICAgXCJjb2xsYXBzZWRcIjogW1wiY29sbGFwc2VkV2F0Y2hlclwiXSxcbiAgICAgICAgXCJkcmFnRW5hYmxlZFwiOiBbXCJkcmFnRW5hYmxlZFdhdGNoZXJcIl0sXG4gICAgICAgIFwiZWRpdGluZ1RpdGxlXCI6IFtcImVkaXRpbmdUaXRsZVdhdGNoZXJcIl0sXG4gICAgICAgIFwiZmlsdGVyUGxhY2Vob2xkZXJcIjogW1wiZmlsdGVyUGxhY2Vob2xkZXJXYXRjaGVyXCJdLFxuICAgICAgICBcImljb25cIjogW1wiaWNvbldhdGNoZXJcIl0sXG4gICAgICAgIFwibWluRmlsdGVySXRlbXNcIjogW1wibWluRmlsdGVySXRlbXNXYXRjaGVyXCJdLFxuICAgICAgICBcInJlZmVyZW5jZUZpbHRlclRleHRcIjogW1wicmVmZXJlbmNlRmlsdGVyVGV4dFdhdGNoZXJcIl0sXG4gICAgICAgIFwicmVmZXJlbmNlTGlzdEl0ZW1DcmVhdGVkRnVuY3Rpb25cIjogW1wicmVmZXJlbmNlTGlzdEl0ZW1DcmVhdGVkRnVuY3Rpb25XYXRjaGVyXCJdLFxuICAgICAgICBcInNlbGVjdGlvbk1vZGVcIjogW1wic2VsZWN0aW9uTW9kZVdhdGNoZXJcIl0sXG4gICAgICAgIFwidmlzaWJpbGl0eUFwcGVhcmFuY2VcIjogW1widmlzaWJpbGl0eUFwcGVhcmFuY2VXYXRjaGVyXCJdLFxuICAgICAgICBcInZpc2libGVFbGVtZW50c0Jhc2VMYXllcnNcIjogW1widmlzaWJsZUVsZW1lbnRzQmFzZUxheWVyc1dhdGNoZXJcIl0sXG4gICAgICAgIFwidmlzaWJsZUVsZW1lbnRzQ2xvc2VCdXR0b25cIjogW1widmlzaWJsZUVsZW1lbnRzQ2xvc2VCdXR0b25XYXRjaGVyXCJdLFxuICAgICAgICBcInZpc2libGVFbGVtZW50c0NvbGxhcHNlQnV0dG9uXCI6IFtcInZpc2libGVFbGVtZW50c0NvbGxhcHNlQnV0dG9uV2F0Y2hlclwiXSxcbiAgICAgICAgXCJ2aXNpYmxlRWxlbWVudHNFZGl0VGl0bGVCdXR0b25cIjogW1widmlzaWJsZUVsZW1lbnRzRWRpdFRpdGxlQnV0dG9uV2F0Y2hlclwiXSxcbiAgICAgICAgXCJ2aXNpYmxlRWxlbWVudHNFcnJvcnNcIjogW1widmlzaWJsZUVsZW1lbnRzRXJyb3JzV2F0Y2hlclwiXSxcbiAgICAgICAgXCJ2aXNpYmxlRWxlbWVudHNGaWx0ZXJcIjogW1widmlzaWJsZUVsZW1lbnRzRmlsdGVyV2F0Y2hlclwiXSxcbiAgICAgICAgXCJ2aXNpYmxlRWxlbWVudHNGbG93XCI6IFtcInZpc2libGVFbGVtZW50c0Zsb3dXYXRjaGVyXCJdLFxuICAgICAgICBcInZpc2libGVFbGVtZW50c0hlYWRpbmdcIjogW1widmlzaWJsZUVsZW1lbnRzSGVhZGluZ1dhdGNoZXJcIl0sXG4gICAgICAgIFwidmlzaWJsZUVsZW1lbnRzUmVmZXJlbmNlTGF5ZXJzXCI6IFtcInZpc2libGVFbGVtZW50c1JlZmVyZW5jZUxheWVyc1dhdGNoZXJcIl0sXG4gICAgICAgIFwidmlzaWJsZUVsZW1lbnRzU3RhdHVzSW5kaWNhdG9yc1wiOiBbXCJ2aXNpYmxlRWxlbWVudHNTdGF0dXNJbmRpY2F0b3JzV2F0Y2hlclwiXSxcbiAgICAgICAgXCJ2aXNpYmxlRWxlbWVudHNUZW1wb3JhcnlMYXllckluZGljYXRvcnNcIjogW1widmlzaWJsZUVsZW1lbnRzVGVtcG9yYXJ5TGF5ZXJJbmRpY2F0b3JzV2F0Y2hlclwiXSxcbiAgICAgICAgXCJ2aWV3XCI6IFtcInZpZXdXYXRjaGVyXCJdLFxuICAgICAgICBcInBvc2l0aW9uXCI6IFtcInBvc2l0aW9uV2F0Y2hlclwiXVxuICAgIH07IH1cbn07XG5BcmNnaXNCYXNlbWFwTGF5ZXJMaXN0LnN0eWxlID0gYmFzZW1hcExheWVyTGlzdENzcztcblxuZXhwb3J0IHsgQXJjZ2lzQmFzZW1hcExheWVyTGlzdCBhcyBhcmNnaXNfYmFzZW1hcF9sYXllcl9saXN0IH07XG4iLCIvKiFcbiAqIEFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRXNyaSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG4gKiBTZWUgaHR0cHM6Ly9qcy5hcmNnaXMuY29tLzQuMzAvZXNyaS9jb3B5cmlnaHQudHh0IGZvciBkZXRhaWxzLlxuICogdjQuMzAuMC1uZXh0LjM3XG4gKi9cbmZ1bmN0aW9uIGNoZWNrRm9yRXhwYW5kKGVsZW1lbnQpIHtcbiAgICBjb25zdCBleHBhbmRSZWYgPSBlbGVtZW50LmVsLmNsb3Nlc3QoXCJhcmNnaXMtZXhwYW5kXCIpID8/IGVsZW1lbnQuZXhwYW5kRWxlbTtcbiAgICBpZiAoZXhwYW5kUmVmPy53aWRnZXQpIHtcbiAgICAgICAgZWxlbWVudC52aWV3ID0gZXhwYW5kUmVmLnZpZXc7XG4gICAgICAgIGV4cGFuZFJlZi53aWRnZXQuY29udGVudCA9IGVsZW1lbnQuY2hpbGRFbGVtID8/IGVsZW1lbnQuZWw7XG4gICAgICAgIC8vIFRPRE86IFVwZGF0ZSB0byBiZSBleHBhbmRJY29uID0gd2lkZ2V0Lmljb24sIG5vdCByZWFkeSB5ZXQgaW4gNC4yN25leHRcbiAgICAgICAgaWYgKCFleHBhbmRSZWYuZXhwYW5kSWNvbikge1xuICAgICAgICAgICAgZXhwYW5kUmVmLndpZGdldC5leHBhbmRJY29uID0gZWxlbWVudC53aWRnZXQgPyBlbGVtZW50LndpZGdldC5pY29uIDogZWxlbWVudD8uaWNvbjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgaWYgKGV4cGFuZFJlZikge1xuICAgICAgICBjb25zdCB3aWRnZXRIYW5kbGVyID0gKCkgPT4ge1xuICAgICAgICAgICAgZXhwYW5kUmVmLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJhcmNnaXNFeHBhbmRSZWFkeVwiLCB3aWRnZXRIYW5kbGVyLCBmYWxzZSk7XG4gICAgICAgICAgICBlbGVtZW50LnZpZXcgPSBleHBhbmRSZWYudmlldztcbiAgICAgICAgICAgIGV4cGFuZFJlZi53aWRnZXQuY29udGVudCA9IGVsZW1lbnQuY2hpbGRFbGVtID8/IGVsZW1lbnQuZWw7XG4gICAgICAgICAgICBpZiAoIWV4cGFuZFJlZi5leHBhbmRJY29uKSB7XG4gICAgICAgICAgICAgICAgZXhwYW5kUmVmLndpZGdldC5leHBhbmRJY29uID0gZWxlbWVudC53aWRnZXQgPyBlbGVtZW50LndpZGdldC5pY29uIDogZWxlbWVudD8uaWNvbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgZXhwYW5kUmVmLmFkZEV2ZW50TGlzdGVuZXIoXCJhcmNnaXNFeHBhbmRSZWFkeVwiLCB3aWRnZXRIYW5kbGVyLCBmYWxzZSk7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG59XG5cbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vXG4vLyAgUHVibGljIE1ldGhvZHNcbi8vXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5mdW5jdGlvbiBhZGRIYW5kbGVzKGVsZW1lbnQsIGhhbmRsZSkge1xuICAgIGlmIChBcnJheS5pc0FycmF5KGhhbmRsZSkpIHtcbiAgICAgICAgZWxlbWVudC5fd2F0Y2hIYW5kbGVzID0gWy4uLmVsZW1lbnQuX3dhdGNoSGFuZGxlcywgLi4uaGFuZGxlXTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGVsZW1lbnQuX3dhdGNoSGFuZGxlcy5wdXNoKGhhbmRsZSk7XG4gICAgfVxufVxuZnVuY3Rpb24gY2hlY2tGb3JWaWV3KGVsZW1lbnQpIHtcbiAgICBsZXQgaXNVc2luZ1JlZmVyZW5jZUVsZW1lbnQgPSBmYWxzZTtcbiAgICBpZiAoIWNoZWNrRm9yRXhwYW5kKGVsZW1lbnQpKSB7XG4gICAgICAgIGxldCB2aWV3UmVmID0gZWxlbWVudC5lbC5jbG9zZXN0KFwiYXJjZ2lzLW1hcFwiKSA/PyBlbGVtZW50LmVsLmNsb3Nlc3QoXCJhcmNnaXMtc2NlbmVcIik7XG4gICAgICAgIGlmICghdmlld1JlZiAmJiB0eXBlb2YgZWxlbWVudC5yZWZlcmVuY2VFbGVtZW50ID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICB2aWV3UmVmID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihlbGVtZW50LnJlZmVyZW5jZUVsZW1lbnQpO1xuICAgICAgICAgICAgaXNVc2luZ1JlZmVyZW5jZUVsZW1lbnQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh2aWV3UmVmPy52aWV3KSB7XG4gICAgICAgICAgICBlbGVtZW50LnZpZXcgPSB2aWV3UmVmLnZpZXc7XG4gICAgICAgICAgICBjb25zdCBlbCA9IGVsZW1lbnQuY2hpbGRFbGVtID8/IGVsZW1lbnQuZWw7XG4gICAgICAgICAgICBpZiAoIWlzVXNpbmdSZWZlcmVuY2VFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgZWxlbWVudC52aWV3LnVpLmFkZChlbCwgZWxlbWVudC5wb3NpdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodmlld1JlZikge1xuICAgICAgICAgICAgd2FpdEZvclZpZXdIYW5kbGVyKHZpZXdSZWYsIGVsZW1lbnQsIGlzVXNpbmdSZWZlcmVuY2VFbGVtZW50KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgY29uc3Qgdmlld1JlZiA9IGVsZW1lbnQuZWwuY2xvc2VzdChcImFyY2dpcy1tYXBcIikgPz8gZWxlbWVudC5lbC5jbG9zZXN0KFwiYXJjZ2lzLXNjZW5lXCIpO1xuICAgICAgICBpZiAodmlld1JlZj8udmlldykge1xuICAgICAgICAgICAgZWxlbWVudC52aWV3ID0gdmlld1JlZi52aWV3O1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHZpZXdSZWYpIHtcbiAgICAgICAgICAgIGNvbnN0IGhhbmRsZXIgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdmlld1JlZi5yZW1vdmVFdmVudExpc3RlbmVyKFwiYXJjZ2lzVmlld1JlYWR5Q2hhbmdlXCIsIGhhbmRsZXIsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICBlbGVtZW50LnZpZXcgPSB2aWV3UmVmLnZpZXc7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdmlld1JlZi5hZGRFdmVudExpc3RlbmVyKFwiYXJjZ2lzVmlld1JlYWR5Q2hhbmdlXCIsIGhhbmRsZXIsIGZhbHNlKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbmZ1bmN0aW9uIGlzTnVsbE9yRW1wdHlTdHJpbmcodmFsdWUpIHtcbiAgICByZXR1cm4gdmFsdWUgPT09IHVuZGVmaW5lZCB8fCB2YWx1ZSA9PT0gbnVsbCB8fCB2YWx1ZSA9PT0gXCJcIjtcbn1cbmZ1bmN0aW9uIGlzVmFsaWRJbnRlZ2VyKHZhbHVlKSB7XG4gICAgcmV0dXJuIHZhbHVlICE9IG51bGwgJiYgdmFsdWUgJSAxID09PSAwO1xufVxuZnVuY3Rpb24gaXNOb3RTYW1lQ2FtZXJhKGNhbWVyYSwgY2FtZXJhMikge1xuICAgIHJldHVybiAoY2FtZXJhMiA9PT0gdW5kZWZpbmVkIHx8XG4gICAgICAgIGNhbWVyYS5wb3NpdGlvbiAhPT0gY2FtZXJhMi5wb3NpdGlvbiB8fFxuICAgICAgICBjYW1lcmEuaGVhZGluZyAhPT0gY2FtZXJhMi5oZWFkaW5nIHx8XG4gICAgICAgIGNhbWVyYS50aWx0ICE9PSBjYW1lcmEyLnRpbHQpO1xufVxuZnVuY3Rpb24gaXNOb3RTYW1lRW52aXJvbm1lbnQoZW52aXJvbm1lbnQsIGVudmlyb25tZW50Mikge1xuICAgIHJldHVybiAoZW52aXJvbm1lbnQyID09PSB1bmRlZmluZWQgfHxcbiAgICAgICAgZW52aXJvbm1lbnQyLmF0bW9zcGhlcmVFbmFibGVkICE9PSBlbnZpcm9ubWVudC5hdG1vc3BoZXJlRW5hYmxlZCB8fFxuICAgICAgICBlbnZpcm9ubWVudDIubGlnaHRpbmcuZGF0ZSAhPT0gZW52aXJvbm1lbnQubGlnaHRpbmcuZGF0ZSB8fFxuICAgICAgICBlbnZpcm9ubWVudDIubGlnaHRpbmcuZGlyZWN0U2hhZG93c0VuYWJsZWQgIT09XG4gICAgICAgICAgICBlbnZpcm9ubWVudC5saWdodGluZy5kaXJlY3RTaGFkb3dzRW5hYmxlZCB8fFxuICAgICAgICBlbnZpcm9ubWVudDIubGlnaHRpbmcuY2FtZXJhVHJhY2tpbmdFbmFibGVkICE9PVxuICAgICAgICAgICAgZW52aXJvbm1lbnQubGlnaHRpbmcuY2FtZXJhVHJhY2tpbmdFbmFibGVkIHx8XG4gICAgICAgIGVudmlyb25tZW50Mi5saWdodGluZy5kYXRlICE9PSBlbnZpcm9ubWVudC5saWdodGluZy5kYXRlIHx8XG4gICAgICAgIGVudmlyb25tZW50Mi5saWdodGluZy5kaXNwbGF5VVRDT2Zmc2V0ICE9PVxuICAgICAgICAgICAgZW52aXJvbm1lbnQubGlnaHRpbmcuZGlzcGxheVVUQ09mZnNldCk7XG59XG5mdW5jdGlvbiBpc05vdFNhbWVWaWV3cG9pbnQodmlld3BvaW50LCB2aWV3cG9pbnQyKSB7XG4gICAgcmV0dXJuICh2aWV3cG9pbnQyID09PSB1bmRlZmluZWQgfHxcbiAgICAgICAgdmlld3BvaW50LnRhcmdldEdlb21ldHJ5ICE9PSB2aWV3cG9pbnQyLnRhcmdldEdlb21ldHJ5IHx8XG4gICAgICAgIHZpZXdwb2ludC5yb3RhdGlvbiAhPT0gdmlld3BvaW50Mi5yb3RhdGlvbiB8fFxuICAgICAgICB2aWV3cG9pbnQuc2NhbGUgIT09IHZpZXdwb2ludDIuc2NhbGUpO1xufVxuYXN5bmMgZnVuY3Rpb24gdXBkYXRlRm9yVmlldyh2aWV3U3RyKSB7XG4gICAgY29uc3Qgdmlld1JlZiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Iodmlld1N0cik7XG4gICAgcmV0dXJuIGF3YWl0IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgICAgIGlmICh2aWV3UmVmPy52aWV3ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJlc29sdmUodmlld1JlZi52aWV3KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh2aWV3UmVmKSB7XG4gICAgICAgICAgICBjb25zdCBoYW5kbGVyID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgIHZpZXdSZWYucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImFyY2dpc1ZpZXdSZWFkeUNoYW5nZVwiLCBoYW5kbGVyLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZSh2aWV3UmVmLnZpZXcpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZpZXdSZWYuYWRkRXZlbnRMaXN0ZW5lcihcImFyY2dpc1ZpZXdSZWFkeUNoYW5nZVwiLCBoYW5kbGVyLCBmYWxzZSk7XG4gICAgICAgIH1cbiAgICB9KTtcbn1cbmFzeW5jIGZ1bmN0aW9uIHJlZmVyZW5jZUVsZW1lbnRIZWxwZXIoZWxlbWVudCwgcmVmRWxlbWVudCkge1xuICAgIGlmIChyZWZFbGVtZW50ID09PSB1bmRlZmluZWQpXG4gICAgICAgIHJldHVybjtcbiAgICBlbHNlIGlmICh0eXBlb2YgcmVmRWxlbWVudCA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICBlbGVtZW50LnZpZXcgPSBhd2FpdCB1cGRhdGVGb3JWaWV3KHJlZkVsZW1lbnQpO1xuICAgIH1cbiAgICBlbHNlIGlmIChlbGVtZW50LndpZGdldCkge1xuICAgICAgICBlbGVtZW50LnZpZXcgPSByZWZFbGVtZW50LnZpZXc7XG4gICAgfVxufVxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy9cbi8vICBQcml2YXRlIE1ldGhvZHNcbi8vXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5mdW5jdGlvbiB3YWl0Rm9yVmlld0hhbmRsZXIodmlld1JlZiwgZWxlbWVudCwgaXNVc2luZ1JlZmVybmNlRWxlbWVudCkge1xuICAgIGNvbnN0IGhhbmRsZXIgPSAoKSA9PiB7XG4gICAgICAgIHZpZXdSZWYucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImFyY2dpc1ZpZXdSZWFkeUNoYW5nZVwiLCBoYW5kbGVyLCBmYWxzZSk7XG4gICAgICAgIGVsZW1lbnQudmlldyA9IHZpZXdSZWYudmlldztcbiAgICAgICAgaWYgKCFpc1VzaW5nUmVmZXJuY2VFbGVtZW50KSB7XG4gICAgICAgICAgICBlbGVtZW50LnZpZXcudWkuYWRkKGVsZW1lbnQuY2hpbGRFbGVtID8/IGVsZW1lbnQuZWwsIGVsZW1lbnQucG9zaXRpb24pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICB2aWV3UmVmLmFkZEV2ZW50TGlzdGVuZXIoXCJhcmNnaXNWaWV3UmVhZHlDaGFuZ2VcIiwgaGFuZGxlciwgZmFsc2UpO1xufVxuXG5leHBvcnQgeyBhZGRIYW5kbGVzIGFzIGEsIGlzTm90U2FtZVZpZXdwb2ludCBhcyBiLCBjaGVja0ZvclZpZXcgYXMgYywgY2hlY2tGb3JFeHBhbmQgYXMgZCwgaXNOb3RTYW1lQ2FtZXJhIGFzIGUsIGlzTm90U2FtZUVudmlyb25tZW50IGFzIGYsIGlzVmFsaWRJbnRlZ2VyIGFzIGcsIGlzTnVsbE9yRW1wdHlTdHJpbmcgYXMgaSwgcmVmZXJlbmNlRWxlbWVudEhlbHBlciBhcyByIH07XG4iLCIvKiFcbiAqIEFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRXNyaSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG4gKiBTZWUgaHR0cHM6Ly9qcy5hcmNnaXMuY29tLzQuMzAvZXNyaS9jb3B5cmlnaHQudHh0IGZvciBkZXRhaWxzLlxuICogdjQuMzAuMC1uZXh0LjM3XG4gKi9cbmZ1bmN0aW9uIG9uRGlzY29ubmVjdGVkSGVscGVyKGVsZW1lbnQpIHtcbiAgICBpZiAoZWxlbWVudC5jaGlsZEVsZW0pIHtcbiAgICAgICAgaWYgKCFlbGVtZW50LmVsLmlzQ29ubmVjdGVkKSB7XG4gICAgICAgICAgICBpZiAoZWxlbWVudC52aWV3KSB7XG4gICAgICAgICAgICAgICAgZWxlbWVudC52aWV3LnVpLnJlbW92ZShlbGVtZW50LmNoaWxkRWxlbSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChlbGVtZW50LndpZGdldD8udmlldykge1xuICAgICAgICAgICAgICAgIGVsZW1lbnQud2lkZ2V0LnZpZXcudWkucmVtb3ZlKGVsZW1lbnQuY2hpbGRFbGVtKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChlbGVtZW50Ll93YXRjaEhhbmRsZXMpIHtcbiAgICAgICAgICAgICAgICBlbGVtZW50Ll93YXRjaEhhbmRsZXMuZm9yRWFjaCgoaGFuZGxlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGhhbmRsZS5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsZW1lbnQuX3dhdGNoSGFuZGxlcyA9IFtdO1xuICAgICAgICAgICAgZWxlbWVudC53aWRnZXQ/LmRlc3Ryb3koKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICBpZiAoIWVsZW1lbnQuZWwuaXNDb25uZWN0ZWQpIHtcbiAgICAgICAgICAgICAgICBpZiAoZWxlbWVudC52aWV3KSB7XG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQudmlldy51aS5yZW1vdmUoZWxlbWVudC5lbCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGVsZW1lbnQud2lkZ2V0Py52aWV3KSB7XG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQud2lkZ2V0LnZpZXcudWkucmVtb3ZlKGVsZW1lbnQuZWwpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoZWxlbWVudC5fd2F0Y2hIYW5kbGVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuX3dhdGNoSGFuZGxlcy5mb3JFYWNoKChoYW5kbGUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZS5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsZW1lbnQuX3dhdGNoSGFuZGxlcyA9IFtdO1xuICAgICAgICAgICAgICAgIGVsZW1lbnQud2lkZ2V0Py5kZXN0cm95KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIDEwMDApO1xuICAgIH1cbn1cblxuZXhwb3J0IHsgb25EaXNjb25uZWN0ZWRIZWxwZXIgYXMgbyB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9